{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to Transformer Thermal Model","text":""},{"location":"#welcome-to-transformer-thermal-model","title":"Welcome to Transformer Thermal Model","text":"<p><code>transformer-thermal-model</code> is a library for modelling the transformer top-oil and hot-spot temperature based on the transformer specifications, a load profile and an ambient temperature profile. The model is an implementation according to the standard IEC 60076-7, also known as de Loading Guide.</p>"},{"location":"#features","title":"Features","text":"<p>The Transformer Thermal model is designed to model the heat generation in transformers using a simple Python API. In short, it has the following features:</p> <ul> <li>Creating a power or distribution transformer based on user specifications or IEC prescribed specifications;</li> <li>model the heat generation based on a static or dynamic load profile and ambient temperature profile;</li> <li>calculate the aging based on the hot-spot temperature;</li> <li>perform hot-spot factor, being one of the transformer specifications, calibration;</li> <li>calculate the relative component capacities.</li> </ul>"},{"location":"#example-of-a-model-of-a-power-transformer","title":"Example of a model of a power transformer","text":"<p>This example demonstrates how the heat generation in a power transformer is calculated.</p> <p>The required information is:</p> <ul> <li>The load: For example the load [A] during a week.</li> <li>The ambient temperature: The temperature during the same period as the load.</li> <li>The transformer specifications: The minimal required specifications are the cooling type, the load losses, the nominal current at the secondary side, and the temperature surcharge to compensate for building the transformer might be placed in.</li> </ul> <p>Now we will calculate transformer temperatures using <code>transformer_thermal_model.model</code> and some simulated ambient temperature and loads.</p> <pre><code>import pandas as pd\n\nfrom transformer_thermal_model.model import Model\nfrom transformer_thermal_model.cooler import CoolerType\nfrom transformer_thermal_model.schemas import UserTransformerSpecifications, InputProfile\nfrom transformer_thermal_model.transformer import PowerTransformer\n\n# In this example the model is used to calculate the transformer temperature based on a load and ambient\n# profile with a period of one week. Any duration can be chosen preferably with timestamps with an interval of\n# 15 minute or lower. Larger timesteps will result in incorrect results but it *is* possible to calculate with them.\none_week = 4*24*7\ndatetime_index = pd.date_range(\"2020-01-01\", periods=one_week, freq=\"15min\")\n\n# For the load (in A) and ambient temperature (in C) arbitrary constants profiles are chosen.\n# It is also possible to use a realistic profile.\nnominal_load = 100\nload_points = pd.Series([nominal_load] * one_week, index=datetime_index)\nambient_temp = 21\ntemperature_points = pd.Series([ambient_temp] * one_week, index=datetime_index)\n\n# Create an input object with the profiles\nprofile_input = InputProfile.create(\n   datetime_index = datetime_index,\n   load_profile = load_points,\n   ambient_temperature_profile = temperature_points\n)\n\n# Initialise a power transformer with cooling type ONAF and, besides the mandatory user specifications, default values.\ntr_specs = UserTransformerSpecifications(\n   load_loss=1000,  # Transformer load loss [W]\n   nom_load_sec_side=1500,  # Transformer nominal current secondary side [A]\n   no_load_loss=200,  # Transformer no-load loss [W]\n   amb_temp_surcharge=20,  # Ambient temperature surcharge [K]\n)\ntransformer = PowerTransformer(user_specs=tr_specs, cooling_type=CoolerType.ONAF)\nmodel = Model(\n   temperature_profile = profile_input,\n   transformer = transformer\n)\n\nresults = model.run()\n\n# Get the results as pd.Series, with the same datetime_index as your input.\ntop_oil_temp_profile = results.top_oil_temp_profile\nhot_spot_temp_profile = results.hot_spot_temp_profile\n</code></pre> <pre><code>&gt;&gt;&gt; top_oil_temp_profile.head(3)\n2020-01-01 00:00:00    41.000000\n2020-01-01 00:15:00    43.639919\n2020-01-01 00:30:00    45.801302\n\n&gt;&gt;&gt; hot_spot_temp_profile.head(3)\n2020-01-01 00:00:00    41.000000\n2020-01-01 00:15:00    44.381177\n2020-01-01 00:30:00    46.740013\n</code></pre>"},{"location":"#who-is-using-the-transformer-thermal-model","title":"Who is using the Transformer Thermal Model?","text":"<p>The Transformer Thermal Model is designed with three major cases in mind:</p> <ul> <li>Modelling the top-oil temperature: to elevate our understanding on how to take maximal use of a transformer,    we want to know if we can increase the load without damaging the asset with higher temperatures. If a transformer    is not equipped with a top-oil sensor already, adding one to an operational transformer is not straightforward,    so a model providing us with an estimate of this value is highly appreciated.</li> <li>Modelling the hot-spot temperature: the hot-spot measurement has proven to be even more interesting in    measuring the state of a transformer under load and this information required to estimate the aging.    Some transformers are equipped with an hot-spot temperature sensor. But if this is not the case, one can use    this model to calculate an estimate of this temperature from the top-oil measurements.</li> <li>Creating awareness within the company: all these values together we use to combine into one important metric:   the aging of the transformer. We want our transformers to stay in the field for as long as we estimated when   purchasing it. If we start increasing the load on these transformers, we do not want them defecting sooner than   expected. To show that we can confidently increase the load on certain transformers, we use the Transformer Thermal   Model together with measurements from the field to empower our decisions to comfortably increase the load on specific   assets.</li> </ul>"},{"location":"#license","title":"License","text":"<p>This project is licensed under the Mozilla Public License, version 2.0 - see LICENSE for details.</p>"},{"location":"#licenses-third-party-libraries","title":"Licenses third-party libraries","text":"<p>This project includes third-party libraries, which are licensed under their own respective Open-Source licenses. SPDX-License-Identifier headers are used to show which license is applicable.</p> <p>The concerning license files can be found in the LICENSES directory.</p>"},{"location":"#contributing","title":"Contributing","text":"<p>Please read CODE_OF_CONDUCT, CONTRIBUTING and PROJECT GOVERNANCE for details on the process for submitting pull requests to us.</p>"},{"location":"#contact","title":"Contact","text":"<p>Please read SUPPORT for how to connect and get into contact with the Transformer Thermal Model project.</p>"},{"location":"api_reference/aging/","title":"Aging","text":""},{"location":"api_reference/aging/#aging","title":"Aging","text":"<p>The aging of the transformer under a certain load (described by the hot-spot temperature(s)) can be calculated with the following functions.</p>"},{"location":"api_reference/aging/#transformer_thermal_model.aging.aging.aging_rate_profile","title":"aging_rate_profile","text":"<pre><code>aging_rate_profile(\n    hot_spot_profile: Series,\n    insulation_type: PaperInsulationType,\n) -&gt; Series\n</code></pre> <p>The aging rate profile of the provided paper insulation material.</p> <p>Given a hot-spot temperature profile, calculate the days aged for each time step in the profile.</p> <p>Parameters:</p> Name Type Description Default <code>hot_spot_profile</code> <code>Series</code> <p>The hot-spot temperature profile of the transformer.</p> required <code>insulation_type</code> <code>PaperInsulationType</code> <p>The type of paper insulation material.</p> required Calculating the aging rate profile for a hot-spot temperature profile. <pre><code>&gt;&gt;&gt; import pandas as pd\n&gt;&gt;&gt; from transformer_thermal_model.aging import aging_rate_profile\n&gt;&gt;&gt; from transformer_thermal_model.transformer import PaperInsulationType\n\n&gt;&gt;&gt; datetime_index = pd.date_range(\"2020-01-01\", periods=10, freq=\"15min\", tz=\"UTC\")\n&gt;&gt;&gt; hot_spot_profile = pd.Series([100] * 10, index=datetime_index)\n&gt;&gt;&gt; profile = aging_rate_profile(hot_spot_profile, PaperInsulationType.NORMAL)\n&gt;&gt;&gt; print(profile)\n2020-01-01 00:00:00+00:00    1.259921\n2020-01-01 00:15:00+00:00    1.259921\n2020-01-01 00:30:00+00:00    1.259921\n2020-01-01 00:45:00+00:00    1.259921\n2020-01-01 01:00:00+00:00    1.259921\n2020-01-01 01:15:00+00:00    1.259921\n2020-01-01 01:30:00+00:00    1.259921\n2020-01-01 01:45:00+00:00    1.259921\n2020-01-01 02:00:00+00:00    1.259921\n2020-01-01 02:15:00+00:00    1.259921\nFreq: 15min, dtype: float64\n</code></pre> <p>Returns:</p> Type Description <code>Series</code> <p>pd.Series: Aging in day/day over time.</p> Source code in <code>transformer_thermal_model/aging/aging.py</code> <pre><code>def aging_rate_profile(hot_spot_profile: pd.Series, insulation_type: PaperInsulationType) -&gt; pd.Series:\n    \"\"\"The aging rate profile of the provided paper insulation material.\n\n    Given a hot-spot temperature profile, calculate the days aged for each time step in the profile.\n\n    Args:\n        hot_spot_profile (pd.Series): The hot-spot temperature profile of the transformer.\n        insulation_type (PaperInsulationType): The type of paper insulation material.\n\n    Example: Calculating the aging rate profile for a hot-spot temperature profile.\n        ```python\n        &gt;&gt;&gt; import pandas as pd\n        &gt;&gt;&gt; from transformer_thermal_model.aging import aging_rate_profile\n        &gt;&gt;&gt; from transformer_thermal_model.transformer import PaperInsulationType\n\n        &gt;&gt;&gt; datetime_index = pd.date_range(\"2020-01-01\", periods=10, freq=\"15min\", tz=\"UTC\")\n        &gt;&gt;&gt; hot_spot_profile = pd.Series([100] * 10, index=datetime_index)\n        &gt;&gt;&gt; profile = aging_rate_profile(hot_spot_profile, PaperInsulationType.NORMAL)\n        &gt;&gt;&gt; print(profile)\n        2020-01-01 00:00:00+00:00    1.259921\n        2020-01-01 00:15:00+00:00    1.259921\n        2020-01-01 00:30:00+00:00    1.259921\n        2020-01-01 00:45:00+00:00    1.259921\n        2020-01-01 01:00:00+00:00    1.259921\n        2020-01-01 01:15:00+00:00    1.259921\n        2020-01-01 01:30:00+00:00    1.259921\n        2020-01-01 01:45:00+00:00    1.259921\n        2020-01-01 02:00:00+00:00    1.259921\n        2020-01-01 02:15:00+00:00    1.259921\n        Freq: 15min, dtype: float64\n\n        ```\n\n    Returns:\n        pd.Series: Aging in day/day over time.\n    \"\"\"\n    return hot_spot_profile.apply(_aging_rate_method(insulation_type))\n</code></pre>"},{"location":"api_reference/aging/#transformer_thermal_model.aging.aging.days_aged","title":"days_aged","text":"<pre><code>days_aged(\n    hot_spot_profile: Series,\n    insulation_type: PaperInsulationType,\n) -&gt; float\n</code></pre> <p>Number of days the insulation material inside the transformer has aged.</p> <p>Calculates the number of days the provided insulation material has aged given the hot-spot temperature profile. For a more accurate representation of the number of days aged per timestep of the provided hot-spot temperature profile, see :func:<code>aging_rate_profile</code>.</p> <p>Parameters:</p> Name Type Description Default <code>hot_spot_profile</code> <code>Series</code> <p>The hot-spot temperature profile of the transformer.</p> required <code>insulation_type</code> <code>PaperInsulationType</code> <p>The type of paper insulation material.</p> required Calculating the number of days aged across the entire profile. <pre><code>&gt;&gt;&gt; import pandas as pd\n&gt;&gt;&gt; from transformer_thermal_model.aging import days_aged\n&gt;&gt;&gt; from transformer_thermal_model.transformer import PaperInsulationType\n\n&gt;&gt;&gt; one_day = 24 * 4 + 1\n&gt;&gt;&gt; datetime_index = pd.date_range(\"2020-01-01\", periods=one_day, freq=\"15min\", tz=\"UTC\")\n&gt;&gt;&gt; hotspot_profile = pd.Series(100, index=datetime_index)\n&gt;&gt;&gt; total_aging = days_aged(hotspot_profile, PaperInsulationType.NORMAL)\n&gt;&gt;&gt; print(total_aging)\n1.26\n</code></pre> <p>Returns:</p> Name Type Description <code>float</code> <code>float</code> <p>The total aging in days for the period of the given temperature profile.</p> Source code in <code>transformer_thermal_model/aging/aging.py</code> <pre><code>def days_aged(hot_spot_profile: pd.Series, insulation_type: PaperInsulationType) -&gt; float:\n    \"\"\"Number of days the insulation material inside the transformer has aged.\n\n    Calculates the number of days the provided insulation material has aged\n    given the hot-spot temperature profile. For a more accurate representation\n    of the number of days aged per timestep of the provided hot-spot temperature\n    profile, see :func:`aging_rate_profile`.\n\n    Args:\n        hot_spot_profile (pd.Series): The hot-spot temperature profile of the transformer.\n        insulation_type (PaperInsulationType): The type of paper insulation material.\n\n    Example: Calculating the number of days aged across the entire profile.\n        ```python\n        &gt;&gt;&gt; import pandas as pd\n        &gt;&gt;&gt; from transformer_thermal_model.aging import days_aged\n        &gt;&gt;&gt; from transformer_thermal_model.transformer import PaperInsulationType\n\n        &gt;&gt;&gt; one_day = 24 * 4 + 1\n        &gt;&gt;&gt; datetime_index = pd.date_range(\"2020-01-01\", periods=one_day, freq=\"15min\", tz=\"UTC\")\n        &gt;&gt;&gt; hotspot_profile = pd.Series(100, index=datetime_index)\n        &gt;&gt;&gt; total_aging = days_aged(hotspot_profile, PaperInsulationType.NORMAL)\n        &gt;&gt;&gt; print(total_aging)\n        1.26\n\n        ```\n\n    Returns:\n        float: The total aging in days for the period of the given temperature profile.\n    \"\"\"\n    aging_profile = hot_spot_profile.apply(_aging_rate_method(insulation_type))\n    seconds_aged = aging_profile.index.to_series().diff().dt.total_seconds().fillna(0)\n    total_seconds_aged = (aging_profile * seconds_aged).sum()\n    total_days_aged = total_seconds_aged / (60 * 60 * 24)  # convert seconds to days\n\n    logger.info(f\"Total aging: {total_days_aged} days\")\n    return total_days_aged\n</code></pre>"},{"location":"api_reference/architecture/","title":"Architecture","text":""},{"location":"api_reference/architecture/#the-architecture-of-transformer-thermal-model","title":"The architecture of Transformer Thermal Model","text":""},{"location":"api_reference/architecture/#container-diagram","title":"Container diagram","text":"<pre><code>C4Container\n    title C2: Containers of the Transformer Thermal Model\n\n    Person_Ext(scientist, \"Scientist\", \"Someone that reports on or analyses thermals of transformers.\")\n    System_Ext(cyclops, \"Cyclic Optimiser\", \"Finds a thermal limit of a transformer by repeatedly calculating the thermals and scaling a load profile.\")\n\n\n\n    Boundary(b0, \"Transformer Thermal Model\") {\n\n        Boundary(b1, \"Extra features\") {\n            Container(docs, \"Docs\", \"HTML module\", \"Module with markdown files linking to existing code and extra added context around it.\")\n            Container(toolbox, \"Toolbox\", \"Python module\", \"Provides extra utility functions that are not necessary to run the model, but can be handy for a large group of our users.\")\n            Container(aging, \"Aging\", \"Python module\", \"Determine the aging rate profile for a specific type of insulated paper for a given hot spot profile.\")\n        }\n\n        Boundary(b2, \"Core Container\"){\n            System(thermal_modeling, \"Thermal Modeling\", \"Calculate thermals of a transformer.\")\n        }\n\n        Boundary(b3, \"Imported packages\"){\n            System_Ext(numpy, \"Numpy\", \"The fundamental package for scientific computing with Python\")\n        }\n    }\n\n    Rel(scientist, toolbox, \"Easily transforms pandas input into TTM-valid input with\")\n    Rel(scientist, aging, \"Estimates the aging of a transformer using\")\n    Rel(scientist, docs, \"Understands the workings of TTM via the\")\n    Rel(scientist, thermal_modeling, \"Calculates thermal values of a transformer using\")\n\n    Rel(cyclops, thermal_modeling, \"Calculates thermal transformer limits using\")\n\n    Rel(thermal_modeling, toolbox, \"Provides input schemas for\")\n    Rel(thermal_modeling, aging, \"Provides possible insulator types for\")\n\n    Rel(aging, numpy, \"Represents, organizes and structures data with\")\n    Rel(thermal_modeling, numpy, \"Represents, organizes and structures data with\")\n\n    UpdateLayoutConfig($c4BoundaryInRow=\"2\", $c4ShapeInRow=\"2\")\n</code></pre>"},{"location":"api_reference/architecture/#component-diagrams","title":"Component diagrams","text":""},{"location":"api_reference/architecture/#thermal-modeling","title":"Thermal Modeling","text":"<pre><code>C4Component\n    title C3: Thermal Modeling\n\n    Person_Ext(scientist, \"Scientist\", \"Someone that reports on or analyses thermals of transformers.\")\n    System_Ext(cyclops, \"Cyclic Optimiser\", \"Finds a thermal limit of a transformer by repeatedly calculating the thermals and scaling a load profile.\")\n\n    Boundary(b0, \"Transformer Thermal Model\"){\n        System_Boundary(s0, \"Thermal Modeling\"){\n            Container(hs_calibration, \"Hot-spot calibration\", \"Python module\", \"Calibrates hot spot factor as a replacement if this value is unknown to the user.\")\n            Container(model, \"Model\", \"Python module\", \"Calculate transformer temperatures under specified load and ambient temperature profiles.\")\n            Container(transformer, \"Transformer\", \"Python module\", \"Data class (containing logic) with specifications and calculated properties of a transformer. Can build a PowerTransformer, DistributionTransformer and ThreeWindingTransformer.\")\n        }\n\n        System_Boundary(s1, \"Imported packages\"){\n            System_Ext(numpy, \"Numpy\", \"The fundamental package for scientific computing with Python\")\n        }\n    }\n    Rel(scientist, transformer, \"Provides asset specifications to build a\")\n    Rel(scientist, hs_calibration, \"Calibrates hot-spot factor (when unknown) with\")\n    Rel(cyclops, model, \"Finds thermal limits of Transformer using\")\n    Rel(scientist, model, \"Finds thermal values of a Transformer using\")\n    Rel(model, transformer, \"Simulates thermal values of the provided\")\n\n    Rel(model, numpy, \"Represents data with\")\n    Rel(transformer, numpy, \"Represents data with\")\n    Rel(hs_calibration, numpy, \"Represents data with\")\n\n    UpdateLayoutConfig($c4BoundaryInRow=\"3\", $c4ShapeInRow=\"1\")\n</code></pre>"},{"location":"api_reference/architecture/#toolbox-components","title":"Toolbox components","text":"<pre><code>C4Component\n    title C3: Toolbox Components\n\n    Person_Ext(scientist, \"Scientist\", \"Someone that reports on or analyses thermals of transformers.\")\n    Boundary(b0, \"Transformer Thermal Model\"){\n\n        System_Boundary(b1, \"Toolbox\"){\n            System(toolbox, \"Toolbox\", \"Provides extra utility functions that are not necessary to run the model, but can be handy for a large group of our users.\")\n            System_Ext(pandas, \"Pandas\", \"A fast, powerful, flexible and easy to use open source data analysis and manipulation tool, built on top of the Python programming language.\")\n            Rel(toolbox, pandas, \"Formats pandas DataFrames to numpy with\")\n        }\n        System(thermal_model, \"Thermal Modeling\")\n    }\n\n    Rel(scientist, toolbox, \"Translates their pandas DataFrames to TTM inputs using\")\n    Rel(toolbox, thermal_model, \"Reads methods for generating user input from\")\n\n    UpdateLayoutConfig($c4BoundaryInRow=\"2\", $c4ShapeInRow=\"1\")\n</code></pre>"},{"location":"api_reference/architecture/#docs","title":"Docs","text":"<pre><code>C4Component\n    title C3: Docs Components\n\n    Person_Ext(scientist, \"Scientist\", \"Someone that reports on or analyses thermals of transformers.\")\n    Boundary(ttm, \"Transformer Thermal Model\"){\n        Boundary(b0, \"Extra features\") {\n            Container_Boundary(b01, \"other features\"){\n                System(other_features, \"Other features\", \"The other extra features, e.g. the Toolbox and Aging.\")\n            }\n            Container_Boundary(b02, \"Docs\"){\n                System(docs, \"Docs\", \"HTML files building the documentation page\")\n                System_Ext(mkdocs, \"MkDocs\", \"MkDocs is a fast, simple and downright gorgeous static site generator that's geared towards building project documentation.\")\n                Person(developer, \"Developer\", \"Someone that contributes to the TTM.\")\n                Rel(developer, mkdocs, \"Builds the documentation by running\")\n            }\n        }\n\n        Boundary(b1, \"Core Container\"){\n            System(thermal_modeling, \"Thermal Modeling\", \"Calculate thermals of a transformer.\")\n        }\n\n    }\n\n    Rel(scientist, docs, \"Understands the inner workings of the TTM via\")\n\n    Rel(mkdocs, thermal_modeling, \"Retrieves documentation from\")\n    Rel(mkdocs, other_features, \"Retrieves documentation from\")\n    Rel(docs, mkdocs, \"Builds the HTML files with\")\n\n    UpdateLayoutConfig($c4BoundaryInRow=\"1\", $c4ShapeInRow=\"3\")\n\n\n</code></pre>"},{"location":"api_reference/components/","title":"Components","text":""},{"location":"api_reference/components/#components","title":"Components","text":"<p>Some components need to be specified in the <code>PowerTransformer</code>. This page lists the various components.</p>"},{"location":"api_reference/components/#transformer_thermal_model.components.bushing_config.BushingConfig","title":"BushingConfig","text":"<p>               Bases: <code>StrEnum</code></p> <p>The bushing configuration of a transformer.</p> <p>Each bushing configuration has a different capacity calculation method that is used in the <code>PowerTransformer</code> class. The configuration can be provided using the <code>ComponentSpecifications</code> class when initializing a <code>PowerTransformer</code>.</p> <p>Attributes:</p> Name Type Description <code>SINGLE_BUSHING</code> <code>str</code> <p>A single bushing configuration.</p> <code>DOUBLE_BUSHING</code> <code>str</code> <p>A double bushing configuration.</p> <code>TRIANGLE_INSIDE</code> <code>str</code> <p>A triangle inside configuration.</p>"},{"location":"api_reference/components/#transformer_thermal_model.components.transformer_side.TransformerSide","title":"TransformerSide","text":"<p>               Bases: <code>StrEnum</code></p> <p>The possible side a component can be connected to in a transformer.</p> <p>A transformer has two sides, the primary and secondary side. The primary side is the side where the transformer is connected to the power source, while the secondary side is the side where the transformer is connected to the load.</p> <p>Attributes:</p> Name Type Description <code>PRIMARY</code> <code>str</code> <p>The primary side of the transformer.</p> <code>SECONDARY</code> <code>str</code> <p>The secondary side of the transformer.</p>"},{"location":"api_reference/components/#transformer_thermal_model.components.vector_config.VectorConfig","title":"VectorConfig","text":"<p>               Bases: <code>StrEnum</code></p> <p>Vector configuration of a transformer.</p> <p>Attributes:</p> Name Type Description <code>STAR</code> <code>str</code> <p>Star configuration.</p> <code>TRIANGLE_INSIDE</code> <code>str</code> <p>Triangle inside configuration.</p> <code>TRIANGLE_OUTSIDE</code> <code>str</code> <p>Triangle outside configuration.</p>"},{"location":"api_reference/cooler/","title":"Cooler","text":""},{"location":"api_reference/cooler/#cooler","title":"Cooler","text":"<p>               Bases: <code>StrEnum</code></p> <p>Cooler setup of a transformer.</p> <p>There are two types of cooling methods for this model.  - ONAN: Oil Natural Air Natural, meaning that the oil is cooled by natural     convection and the air is cooled by natural convection.  - ONAF: which is Oil Natural Air Forced, meaning that the oil is cooled by natural     convection and the air is cooled by forced convection.</p> <p>Attributes:</p> Name Type Description <code>ONAN</code> <code>str</code> <p>Oil Natural Air Natural.</p> <code>ONAF</code> <code>str</code> <p>Oil Natural Air Forced.</p>"},{"location":"api_reference/cooling_switch_controller/","title":"ONAN/ONAF Switch","text":""},{"location":"api_reference/cooling_switch_controller/#cooling-switch-controller","title":"Cooling switch controller","text":""},{"location":"api_reference/cooling_switch_controller/#transformer_thermal_model.transformer.cooling_switch_controller.CoolingSwitchController","title":"CoolingSwitchController","text":"<pre><code>CoolingSwitchController(\n    onaf_switch: CoolingSwitchBase,\n    specs: BaseTransformerSpecifications,\n)\n</code></pre> <p>Encapsulates ONAN/ONAF cooling switch logic for transformers.</p> <p>This class manages the automatic switching between ONAN (Oil Natural Air Natural) and ONAF (Oil Natural Air Forced) cooling modes based on either: - A predefined fan status schedule (list of boolean values) - Temperature thresholds (activation and deactivation temperatures)</p> <p>The controller is used internally by transformer classes and handles the logic for determining when to switch cooling modes and what specifications to apply for each mode.</p> Using CoolingSwitchController with temperature-based switching <pre><code>&gt;&gt;&gt; import numpy as np\n&gt;&gt;&gt; from transformer_thermal_model.transformer import PowerTransformer\n&gt;&gt;&gt; from transformer_thermal_model.schemas import UserTransformerSpecifications\n&gt;&gt;&gt; from transformer_thermal_model.schemas.thermal_model import (\n...     CoolingSwitchSettings,\n...     CoolingSwitchConfig,\n...     ONANParameters,\n... )\n&gt;&gt;&gt; from transformer_thermal_model.cooler import CoolerType\n\n&gt;&gt;&gt; # Define the transformer specifications for ONAF mode\n&gt;&gt;&gt; user_specs = UserTransformerSpecifications(\n...     load_loss=1000,\n...     nom_load_sec_side=1500,\n...     no_load_loss=200,\n...     amb_temp_surcharge=20,\n... )\n&gt;&gt;&gt; # Define ONAN parameters (for when fans are off)\n&gt;&gt;&gt; onan_params = ONANParameters(\n...     nom_load_sec_side=1200,\n...     top_oil_temp_rise=65,\n...     winding_oil_gradient=20,\n...     hot_spot_fac=1.3,\n...     time_const_oil=210,\n...     time_const_windings=10,\n...     load_loss=800,\n... )\n&gt;&gt;&gt; # Create switch configuration with temperature thresholds\n&gt;&gt;&gt; # Fans activate at 70\u00b0C, deactivate at 60\u00b0C\n&gt;&gt;&gt; onaf_switch = CoolingSwitchSettings(\n...     temperature_threshold=CoolingSwitchConfig(activation_temp=70, deactivation_temp=60),\n...     onan_parameters=onan_params\n... )\n&gt;&gt;&gt; # Create transformer with automatic switching capability\n&gt;&gt;&gt; transformer = PowerTransformer(\n...     user_specs=user_specs,\n...     cooling_type=CoolerType.ONAF,\n...     cooling_switch_settings=onaf_switch\n... )\n&gt;&gt;&gt; # The CoolingSwitchController is now managing the cooling mode switches automatically\n</code></pre> Using CoolingSwitchController with predefined fan status <pre><code>&gt;&gt;&gt; from transformer_thermal_model.transformer import PowerTransformer\n&gt;&gt;&gt; from transformer_thermal_model.schemas.thermal_model import CoolingSwitchSettings, ONANParameters\n\n&gt;&gt;&gt; # Create a fan status schedule: True = ONAF (fans on), False = ONAN (fans off)\n&gt;&gt;&gt; # This represents 5 time steps with fans on, then off, then on again\n&gt;&gt;&gt; fan_schedule = np.array([True, True, True, True, True, False, False, False, True, True])\n&gt;&gt;&gt; # Define ONAN parameters for when fans are off\n&gt;&gt;&gt; onan_params = ONANParameters(\n...     nom_load_sec_side=1200,\n...     top_oil_temp_rise=65,\n...     winding_oil_gradient=20,\n...     hot_spot_fac=1.3,\n...     time_const_oil=210,\n...     time_const_windings=10,\n...     load_loss=800,\n... )\n&gt;&gt;&gt; onaf_switch = CoolingSwitchSettings(\n...     fan_on=fan_schedule,\n...     onan_parameters=onan_params\n... )\n&gt;&gt;&gt; transformer = PowerTransformer(\n...     user_specs=user_specs,\n...     cooling_type=CoolerType.ONAF,\n...     cooling_switch_settings=onaf_switch\n... )\n&gt;&gt;&gt; # The controller will switch modes according to the predefined schedule\n</code></pre> <p>Attributes:</p> Name Type Description <code>onaf_switch</code> <code>CoolingSwitchSettings | ThreeWindingCoolingSwitchSettings</code> <p>The switch configuration containing either fan status schedule or temperature thresholds, plus ONAN parameters.</p> <code>original_onaf_specs</code> <code>BaseTransformerSpecifications</code> <p>Deep copy of the original ONAF specifications, used as reference when switching back to ONAF mode.</p> Source code in <code>transformer_thermal_model/transformer/cooling_switch_controller.py</code> <pre><code>def __init__(\n    self,\n    onaf_switch: CoolingSwitchBase,\n    specs: BaseTransformerSpecifications,\n):\n    \"\"\"Initialize the controller with the given ONAF switch settings and transformer specifications.\"\"\"\n    self.onaf_switch = onaf_switch\n    self.original_onaf_specs = specs.model_copy(deep=True)\n</code></pre>"},{"location":"api_reference/cooling_switch_controller/#transformer_thermal_model.transformer.cooling_switch_controller.CoolingSwitchController.determine_initial_specifications","title":"determine_initial_specifications","text":"<pre><code>determine_initial_specifications(\n    initial_top_oil_temperature: float,\n) -&gt; BaseTransformerSpecifications\n</code></pre> <p>Get the initial specifications based on the ONAF switch settings.</p> <p>If the fans are off at the start or if a temperature threshold is set, the transformer starts with ONAN specifications. Otherwise, it starts with ONAF specifications.</p> Source code in <code>transformer_thermal_model/transformer/cooling_switch_controller.py</code> <pre><code>def determine_initial_specifications(\n    self,\n    initial_top_oil_temperature: float,\n) -&gt; BaseTransformerSpecifications:\n    \"\"\"Get the initial specifications based on the ONAF switch settings.\n\n    If the fans are off at the start or if a temperature threshold is set,\n    the transformer starts with ONAN specifications. Otherwise, it starts with ONAF specifications.\n    \"\"\"\n    if self.onaf_switch.fan_on is not None:\n        if not self.onaf_switch.fan_on[0]:\n            return self.create_onan_specifications()\n    elif (\n        self.onaf_switch.temperature_threshold is not None\n        and initial_top_oil_temperature &lt; self.onaf_switch.temperature_threshold.activation_temp\n    ):\n        return self.create_onan_specifications()\n    return self.original_onaf_specs\n</code></pre>"},{"location":"api_reference/cooling_switch_controller/#transformer_thermal_model.transformer.cooling_switch_controller.CoolingSwitchController.create_onan_specifications","title":"create_onan_specifications","text":"<pre><code>create_onan_specifications() -&gt; (\n    BaseTransformerSpecifications\n)\n</code></pre> <p>Create ONAN specifications by merging ONAN parameters into the original ONAF specifications.</p> <p>This method returns a deep copy of the original ONAF specifications with fields overridden by the ONAN parameters provided in the switch configuration. Only fields present in the ONAN parameters are updated; all other fields remain unchanged. The method automatically selects the correct specification type (standard or three-winding) based on the input objects.</p> Source code in <code>transformer_thermal_model/transformer/cooling_switch_controller.py</code> <pre><code>def create_onan_specifications(self) -&gt; BaseTransformerSpecifications:\n    \"\"\"Create ONAN specifications by merging ONAN parameters into the original ONAF specifications.\n\n    This method returns a deep copy of the original ONAF specifications with fields overridden by the\n    ONAN parameters provided in the switch configuration. Only fields present in the ONAN parameters\n    are updated; all other fields remain unchanged. The method automatically selects the correct\n    specification type (standard or three-winding) based on the input objects.\n    \"\"\"\n    transformer_specs = self.original_onaf_specs.model_copy(deep=True)\n\n    if isinstance(transformer_specs, TransformerSpecifications) and isinstance(\n        self.onaf_switch, CoolingSwitchSettings\n    ):\n        specs_dict = transformer_specs.model_dump()\n        specs_dict.update(self.onaf_switch.onan_parameters.model_dump(exclude_none=True))\n        transformer_specs = TransformerSpecifications(**specs_dict)\n\n    elif isinstance(transformer_specs, ThreeWindingTransformerSpecifications) and isinstance(\n        self.onaf_switch, ThreeWindingCoolingSwitchSettings\n    ):\n        specs_dict = transformer_specs.model_dump()\n        specs_dict.update(self.onaf_switch.onan_parameters.model_dump(exclude_none=True))\n        transformer_specs = ThreeWindingTransformerSpecifications(**specs_dict)\n\n    return transformer_specs\n</code></pre>"},{"location":"api_reference/cooling_switch_controller/#transformer_thermal_model.transformer.cooling_switch_controller.CoolingSwitchController.get_new_specs","title":"get_new_specs","text":"<pre><code>get_new_specs(\n    top_oil_temp: float,\n    previous_top_oil_temp: float,\n    index: int,\n) -&gt; BaseTransformerSpecifications | None\n</code></pre> <p>Check and handle the ONAF/ONAN switch based on the top-oil temperature and the switch settings.</p> <p>This method evaluates the current and previous top-oil temperatures, along with the fan status and temperature thresholds, to determine the appropriate transformer specifications to use.</p> <p>Parameters:</p> Name Type Description Default <code>top_oil_temp</code> <code>float</code> <p>Current top-oil temperature.</p> required <code>previous_top_oil_temp</code> <code>float</code> <p>Previous top-oil temperature.</p> required <code>index</code> <code>int</code> <p>Index for fan status or threshold evaluation.</p> required Source code in <code>transformer_thermal_model/transformer/cooling_switch_controller.py</code> <pre><code>def get_new_specs(\n    self, top_oil_temp: float, previous_top_oil_temp: float, index: int\n) -&gt; BaseTransformerSpecifications | None:\n    \"\"\"Check and handle the ONAF/ONAN switch based on the top-oil temperature and the switch settings.\n\n    This method evaluates the current and previous top-oil temperatures, along with the fan status\n    and temperature thresholds, to determine the appropriate transformer specifications to use.\n\n    Args:\n        top_oil_temp (float): Current top-oil temperature.\n        previous_top_oil_temp (float): Previous top-oil temperature.\n        index (int): Index for fan status or threshold evaluation.\n    \"\"\"\n    fan_on = self.onaf_switch.fan_on\n    temp_threshold = self.onaf_switch.temperature_threshold\n\n    if fan_on is not None and index &lt; len(fan_on) - 1:\n        return self._handle_fan_status_switch(fan_on, index)\n    elif temp_threshold is not None:\n        return self._handle_temp_threshold_switch(temp_threshold, top_oil_temp, previous_top_oil_temp)\n    return None\n</code></pre>"},{"location":"api_reference/hot-spot_calibration/","title":"Hot-spot factor calibration","text":""},{"location":"api_reference/hot-spot_calibration/#hot-spot-factor-calibration","title":"Hot-spot factor calibration","text":""},{"location":"api_reference/hot-spot_calibration/#transformer_thermal_model.hot_spot_calibration.calibrate_hotspot_factor.calibrate_hotspot_factor","title":"calibrate_hotspot_factor","text":"<pre><code>calibrate_hotspot_factor(\n    uncalibrated_transformer: PowerTransformer\n    | ThreeWindingTransformer,\n    hot_spot_limit: float,\n    ambient_temp: float,\n    hot_spot_factor_min: float,\n    hot_spot_factor_max: float,\n) -&gt; PowerTransformer | ThreeWindingTransformer\n</code></pre> <p>Calibrate a hot-spot factor for given power transformer.</p> <p>Based on a continuous nominal load with a duration of one week, a specified constant ambient temperature, and a hot-spot temperature limit, the hot-spot factor is calibrated to get as close as possible to 100% nominal load while staying within the 'hot_spot_factor_min' and 'hot_spot_factor_max' bounds.</p> <p>Parameters:</p> Name Type Description Default <code>uncalibrated_transformer</code> <code>PowerTransformer | ThreeWindingTransformer</code> <p>A transformer without a specified</p> required <code>hot_spot_limit</code> <code>float</code> <p>temperature limit for the transformer hot-spot.</p> required <code>ambient_temp</code> <code>float</code> <p>constant ambient temperature in degrees Celsius used for the temperature calculations.</p> required <code>hot_spot_factor_min</code> <code>float</code> <p>minimum allowed value for the hot-spot factor.</p> required <code>hot_spot_factor_max</code> <code>float</code> <p>maximum allowed value for the hot-spot factor.</p> required <p>Returns:</p> Name Type Description <code>PowerTransformer</code> <code>PowerTransformer | ThreeWindingTransformer</code> <p>A calibrated power transformer, where the hot-spot factor is now specified.</p> Source code in <code>transformer_thermal_model/hot_spot_calibration/calibrate_hotspot_factor.py</code> <pre><code>def calibrate_hotspot_factor(\n    uncalibrated_transformer: PowerTransformer | ThreeWindingTransformer,\n    hot_spot_limit: float,\n    ambient_temp: float,\n    hot_spot_factor_min: float,\n    hot_spot_factor_max: float,\n) -&gt; PowerTransformer | ThreeWindingTransformer:\n    \"\"\"Calibrate a hot-spot factor for given power transformer.\n\n    Based on a continuous nominal load with a duration of one week, a specified constant ambient temperature,\n    and a hot-spot temperature limit, the hot-spot factor is calibrated to get as close as\n    possible to 100% nominal load while staying within the 'hot_spot_factor_min' and 'hot_spot_factor_max' bounds.\n\n    Args:\n        uncalibrated_transformer (PowerTransformer | ThreeWindingTransformer): A transformer without a specified\n        hot-spot factor.\n        hot_spot_limit (float): temperature limit for the transformer hot-spot.\n        ambient_temp (float): constant ambient temperature in degrees Celsius used for the temperature calculations.\n        hot_spot_factor_min (float): minimum allowed value for the hot-spot factor.\n        hot_spot_factor_max (float): maximum allowed value for the hot-spot factor.\n\n    Returns:\n        PowerTransformer: A calibrated power transformer, where the hot-spot factor is now specified.\n\n    \"\"\"\n    if hot_spot_factor_min &gt; hot_spot_factor_max:\n        raise ValueError(\"The upper bound cannot be smaller than the lower bound of the hot-spot factor limits.\")\n\n    one_week_steps = 4 * 24 * 7\n    datetime_index = pd.date_range(\"2020-01-01\", periods=one_week_steps, freq=\"15min\")\n    ambient_temp_profile = np.ones(one_week_steps, dtype=float) * ambient_temp\n    calibrated_transformer = copy.deepcopy(uncalibrated_transformer)\n    # Because the transformer should be calibrated to have a max hot-spot temperature at a constant\n    # ambient temperature (generally 20 degrees celsius), the transformer.temp_verh should not be used\n    # during calibration.\n    calibrated_transformer.specs.amb_temp_surcharge = 0.0\n\n    if isinstance(uncalibrated_transformer, PowerTransformer):\n        logger.info(\n            \"Calibrating the hot-spot factor of the transformer. The current hot-spot factor equals\"\n            + f\"{uncalibrated_transformer.specs.hot_spot_fac}.\"\n        )\n        continuous_load = np.ones(one_week_steps, dtype=float) * uncalibrated_transformer.specs.nom_load_sec_side\n\n        model_input = InputProfile.create(\n            datetime_index=datetime_index,\n            load_profile=continuous_load,\n            ambient_temperature_profile=ambient_temp_profile,\n        )\n    elif isinstance(uncalibrated_transformer, ThreeWindingTransformer):\n        continuous_load_lv = np.ones(one_week_steps, dtype=float) * uncalibrated_transformer.specs.lv_winding.nom_load\n        continuous_load_mv = np.ones(one_week_steps, dtype=float) * uncalibrated_transformer.specs.mv_winding.nom_load\n        continuous_load_hv = np.ones(one_week_steps, dtype=float) * uncalibrated_transformer.specs.hv_winding.nom_load\n\n        model_input = ThreeWindingInputProfile.create(  # type: ignore\n            datetime_index=datetime_index,\n            ambient_temperature_profile=ambient_temp_profile,\n            load_profile_high_voltage_side=continuous_load_hv,\n            load_profile_middle_voltage_side=continuous_load_mv,\n            load_profile_low_voltage_side=continuous_load_lv,\n        )\n    else:\n        raise ValueError(\n            \"Incorrect Transformer Type: Hot-spot calibration is only implemented for transformers \"\n            \"of type PowerTransformer or ThreeWindingTransformer\"\n        )\n    # Initiate the difference, one of the termination criteria, to a positive number.\n    difference = 100.0\n    # Initiate the new_hot_spot_factor with the upper limit. This is the starting point for the search algorithm\n    # which iteratively lowers the new_hot_spot_factor until a valid value is found.\n    new_hot_spot_factor = hot_spot_factor_max\n    calibrated_transformer._set_hs_fac(new_hot_spot_factor)\n\n    while difference &gt; 0 and new_hot_spot_factor &gt;= hot_spot_factor_min - 0.01:\n        old_hot_spot_factor = new_hot_spot_factor\n        model = Model(temperature_profile=model_input, transformer=calibrated_transformer)\n        results = model.run()\n        hot_spot_max = _get_max_hot_spot_temperature(results)\n        # Calculate the difference which is used as a termination criterion in the while loop:\n        # the maximum temperature of the hot-spot should be below the hot-spot temperature limit.\n        difference = hot_spot_max - hot_spot_limit\n        new_hot_spot_factor = old_hot_spot_factor - 0.01\n        calibrated_transformer._set_hs_fac(new_hot_spot_factor)\n\n    calibrated_hot_spot_factor = np.clip(old_hot_spot_factor, a_min=hot_spot_factor_min, a_max=hot_spot_factor_max)\n    calibrated_transformer._set_hs_fac(calibrated_hot_spot_factor)\n    # During calibration the amb_temp_surcharge was set to zero. To return a transformer with correct specs,\n    # the amb_temp_surcharge is set to the correct value again.\n    calibrated_transformer.specs.amb_temp_surcharge = uncalibrated_transformer.specs.amb_temp_surcharge\n\n    logger.info(\n        \"The hot-spot factor of the transformer is calibrated. The new hot-spot factor equals\"\n        + f\"{calibrated_hot_spot_factor}.\"\n    )\n    return calibrated_transformer\n</code></pre>"},{"location":"api_reference/model/","title":"Model","text":""},{"location":"api_reference/model/#model","title":"Model","text":"<p>A thermal model to calculate transformer temperatures under specified load and ambient temperature profiles.</p> Initialising a transformer model with a temperature simulation profile <pre><code>&gt;&gt;&gt; from datetime import datetime\n&gt;&gt;&gt; from transformer_thermal_model.cooler import CoolerType\n&gt;&gt;&gt; from transformer_thermal_model.schemas import InputProfile, UserTransformerSpecifications\n&gt;&gt;&gt; from transformer_thermal_model.transformer import PowerTransformer\n&gt;&gt;&gt; from transformer_thermal_model.model import Model\n\n&gt;&gt;&gt; # First, we create the input profile\n&gt;&gt;&gt; datetime_index = [\n...     datetime(2023, 1, 1, 0, 0),\n...     datetime(2023, 1, 1, 1, 0),\n...     datetime(2023, 1, 1, 2, 0),\n... ]\n&gt;&gt;&gt; load_profile = [0.8, 0.9, 1.0]\n&gt;&gt;&gt; ambient_temperature_profile = [25.0, 24.5, 24.0]\n&gt;&gt;&gt; input_profile = InputProfile.create(\n...     datetime_index=datetime_index,\n...     load_profile=load_profile,\n...     ambient_temperature_profile=ambient_temperature_profile,\n... )\n&gt;&gt;&gt; # Then, we create the transformer with some basic specifications\n&gt;&gt;&gt; tr_specs = UserTransformerSpecifications(\n...     load_loss=1000,  # Transformer load loss [W]\n...     nom_load_sec_side=1500,  # Transformer nominal current secondary side [A]\n...     no_load_loss=200,  # Transformer no-load loss [W]\n...     amb_temp_surcharge=20,  # Ambient temperature surcharge [K]\n... )\n&gt;&gt;&gt; tr = PowerTransformer(\n...     user_specs=tr_specs,\n...     cooling_type=CoolerType.ONAN\n... )\n&gt;&gt;&gt; # Finally, we can use the input profile in the transformer model\n&gt;&gt;&gt; model = Model(temperature_profile=input_profile, transformer=tr)\n</code></pre> <p>Attributes:</p> Name Type Description <code>transformer</code> <code>Transformer</code> <p>The transformer that the model will use to calculate the temperatures.</p> <code>data</code> <code>BaseInputProfile</code> <p>The input profile that the model will use to calculate temperatures.</p> <code>top_oil_temp_profile</code> <code>Series</code> <p>The modeled top-oil temperature profile.</p> <code>initial_condition</code> <code>InitialState</code> <p>The initial condition for the model.</p> <p>Parameters:</p> Name Type Description Default <code>temperature_profile</code> <code>BaseInputProfile</code> <p>The temperature profile for the model.</p> required <code>transformer</code> <code>Transformer</code> <p>The transformer object.</p> required <code>initial_condition</code> <code>InitialState | None</code> <p>The initial condition for the model.</p> <code>None</code> Source code in <code>transformer_thermal_model/model/thermal_model.py</code> <pre><code>def __init__(\n    self,\n    temperature_profile: BaseInputProfile,\n    transformer: Transformer,\n    initial_condition: InitialState | None = None,\n) -&gt; None:\n    \"\"\"Initialize the thermal model.\n\n    Args:\n        temperature_profile (BaseInputProfile): The temperature profile for the model.\n        transformer (Transformer): The transformer object.\n        initial_condition (InitialState | None): The initial condition for the model.\n    \"\"\"\n    logger.info(\"Initializing the thermal model.\")\n    logger.info(f\"First timestamp: {temperature_profile.datetime_index[0]}\")\n    logger.info(f\"Last timestamp: {temperature_profile.datetime_index[-1]}\")\n    logger.info(f\"Amount of data points: {len(temperature_profile)}\")\n    logger.info(f\"Max load: {np.max(temperature_profile.load_profile_array)}\")\n    self.transformer = transformer\n    self.data = temperature_profile\n\n    self.initial_condition = initial_condition or ColdStart()\n\n    self.check_config()\n</code></pre>"},{"location":"api_reference/model/#transformer_thermal_model.model.thermal_model.Model.check_config","title":"check_config","text":"<pre><code>check_config() -&gt; None\n</code></pre> <p>Check if the combination of the transformer and input profile are valid.</p> Source code in <code>transformer_thermal_model/model/thermal_model.py</code> <pre><code>def check_config(self) -&gt; None:\n    \"\"\"Check if the combination of the transformer and input profile are valid.\"\"\"\n    if isinstance(self.transformer, ThreeWindingTransformer) and not isinstance(\n        self.data, ThreeWindingInputProfile\n    ):\n        raise ValueError(\"A ThreeWindingTransformer requires a ThreeWindingInputProfile.\")\n    elif isinstance(self.transformer, PowerTransformer) and not isinstance(self.data, InputProfile):\n        raise ValueError(\"A PowerTransformer requires an InputProfile.\")\n    elif isinstance(self.transformer, DistributionTransformer) and not isinstance(self.data, InputProfile):\n        raise ValueError(\"A DistributionTransformer requires an InputProfile.\")\n    if (\n        self.transformer.cooling_controller\n        and self.transformer.cooling_controller.onaf_switch.fan_on is not None\n        and len(self.transformer.cooling_controller.onaf_switch.fan_on) != len(self.data)\n    ):\n        raise ValueError(\n            \"The length of the fan_on list in the cooling_switch_settings must be equal to the length of the \"\n            \"temperature profile.\"\n        )\n</code></pre>"},{"location":"api_reference/model/#transformer_thermal_model.model.thermal_model.Model.get_initial_top_oil_temp","title":"get_initial_top_oil_temp","text":"<pre><code>get_initial_top_oil_temp(\n    first_surrounding_temp: float,\n) -&gt; float\n</code></pre> <p>Function that returns the top oil temp for the first timestep.</p> Source code in <code>transformer_thermal_model/model/thermal_model.py</code> <pre><code>def get_initial_top_oil_temp(self, first_surrounding_temp: float) -&gt; float:\n    \"\"\"Function that returns the top oil temp for the first timestep.\"\"\"\n    match self.initial_condition:\n        case InitialTopOilTemp():\n            return self.initial_condition.initial_top_oil_temp\n        case InitialLoad():\n            top_k = self.transformer._end_temperature_top_oil(load=np.array([self.initial_condition.initial_load]))\n\n            return top_k + first_surrounding_temp\n        case ColdStart():\n            return first_surrounding_temp\n        case _:\n            raise TypeError(f\"Unsupported type: {type(self.initial_condition)}\")\n</code></pre>"},{"location":"api_reference/model/#transformer_thermal_model.model.thermal_model.Model.get_initial_hot_spot_increase","title":"get_initial_hot_spot_increase","text":"<pre><code>get_initial_hot_spot_increase() -&gt; float\n</code></pre> <p>Function that returns the hot spot temp for the first timestep.</p> Source code in <code>transformer_thermal_model/model/thermal_model.py</code> <pre><code>def get_initial_hot_spot_increase(self) -&gt; float:\n    \"\"\"Function that returns the hot spot temp for the first timestep.\"\"\"\n    match self.initial_condition:\n        case InitialLoad():\n            static_hot_spot_incr = self._calculate_static_hot_spot_increase(\n                np.array([self.initial_condition.initial_load])\n            )[0]\n            return static_hot_spot_incr\n        case _:\n            return 0.0\n</code></pre>"},{"location":"api_reference/model/#transformer_thermal_model.model.thermal_model.Model.run","title":"run","text":"<pre><code>run(\n    force_use_ambient_temperature: bool = False,\n) -&gt; OutputProfile\n</code></pre> <p>Calculate the top-oil and hot-spot temperatures for the provided Transformer object.</p> <p>This method prepares the calculation inputs, calculates intermediate factors, and computes the top-oil and hot-spot temperature profiles for the transformer based on the provided load and internal parameters. If the top oil temperature is provided in the <code>temperature_profile</code> it gets priority over the ambient temperature. The ambient temperature is then ignored. You can change this behaviour using the <code>force_use_ambient_temperature</code> parameter.</p> <p>Parameters:</p> Name Type Description Default <code>force_use_ambient_temperature</code> <code>bool</code> <p>Use the ambient temperature to perform the calculation, even if the top oil temperature is given (optional, False by default)</p> <code>False</code> <p>Returns:</p> Name Type Description <code>OutputProfile</code> <code>OutputProfile</code> <p>Object containing the top-oil and hot-spot temperature profiles.</p> Source code in <code>transformer_thermal_model/model/thermal_model.py</code> <pre><code>def run(self, force_use_ambient_temperature: bool = False) -&gt; OutputProfile:\n    \"\"\"Calculate the top-oil and hot-spot temperatures for the provided Transformer object.\n\n    This method prepares the calculation inputs, calculates intermediate factors, and computes\n    the top-oil and hot-spot temperature profiles for the transformer based on the provided\n    load and internal parameters. If the top oil temperature is provided in the `temperature_profile` it gets\n    priority over the ambient temperature. The ambient temperature is then ignored. You can change this behaviour\n    using the `force_use_ambient_temperature` parameter.\n\n    Args:\n        force_use_ambient_temperature:\n            Use the ambient temperature to perform the calculation,\n            even if the top oil temperature is given (optional, False by default)\n\n    Returns:\n        OutputProfile: Object containing the top-oil and hot-spot temperature profiles.\n\n    \"\"\"\n    logger.info(\"Running the thermal model.\")\n\n    # decide if we use the top oil or ambient temperature as input and perform basic validation\n    use_top_oil = not force_use_ambient_temperature and self.data.top_oil_temperature_profile is not None\n\n    dt = self.data.time_step\n    load = self.data.load_profile_array\n    t_internal = self._get_internal_temp()\n\n    # Check if top oil temperature profile is provided and use it if available\n    # If not, calculate it\n    if use_top_oil and self.data.top_oil_temperature_profile is not None:\n        top_oil_temp_profile = self.data.top_oil_temperature_profile\n    else:\n        top_oil_temp_profile = self._calculate_top_oil_temp_profile(t_internal, dt, load)\n\n    # Calculate hot-spot temperature profile\n    hot_spot_temp_profile = self._calculate_hot_spot_temp_profile(load, top_oil_temp_profile, dt)\n    logger.info(\"The calculation with the Thermal model is completed.\")\n    logger.info(f\"Max top-oil temperature: {np.max(top_oil_temp_profile)}\")\n    logger.info(f\"Max hot-spot temperature: {np.max(hot_spot_temp_profile)}\")\n\n    if isinstance(self.transformer, ThreeWindingTransformer):\n        return OutputProfile(\n            top_oil_temp_profile=pd.Series(top_oil_temp_profile, index=self.data.datetime_index),\n            hot_spot_temp_profile=pd.DataFrame(\n                hot_spot_temp_profile.transpose(),\n                columns=[\"low_voltage_side\", \"middle_voltage_side\", \"high_voltage_side\"],\n                index=self.data.datetime_index,\n            ),\n        )\n    else:\n        # For a two winding transformer, hot_spot_temp_profile is a Series\n        return OutputProfile(\n            top_oil_temp_profile=pd.Series(top_oil_temp_profile, index=self.data.datetime_index),\n            hot_spot_temp_profile=pd.Series(hot_spot_temp_profile, index=self.data.datetime_index),\n        )\n</code></pre>"},{"location":"api_reference/model_input_output/","title":"Model input and output","text":""},{"location":"api_reference/model_input_output/#model-input-and-output-schemas","title":"Model input and output schemas","text":"<p>Modules:</p> Name Description <code>initial_state</code> <code>input_profile</code> <code>onaf_switch</code> <code>output_profile</code> <p>Classes:</p> Name Description <code>InputProfile</code> <p>Class containing the temperature and load profiles of two winding transformers for the thermal model <code>Model()</code>.</p> <code>ThreeWindingInputProfile</code> <p>Class for three-winding transformer input profiles.</p> <code>CoolingSwitchBase</code> <p>Class representing the ONAF (Oil Natural Air Forced) cooling switch status.</p> <code>CoolingSwitchConfig</code> <p>Class representing the fan switch configuration for ONAF cooling.</p> <code>CoolingSwitchSettings</code> <p>Class representing the ONAF (Oil Natural Air Forced) cooling switch settings.</p> <code>ONANParameters</code> <p>Class representing ONAN (Oil Natural Air Natural) cooling parameters.</p> <code>ThreeWindingCoolingSwitchSettings</code> <p>Class representing the ONAF (Oil Natural Air Forced) cooling switch settings for three-winding transformers.</p> <code>ThreeWindingONANParameters</code> <p>Class representing ONAN (Oil Natural Air Natural) cooling parameters for three-winding transformers.</p> <code>OutputProfile</code> <p>Class containing the output data for the hot-spot and top-oil temperature calculations.</p>"},{"location":"api_reference/model_input_output/#transformer_thermal_model.schemas.thermal_model.InputProfile","title":"InputProfile","text":"<p>               Bases: <code>BaseInputProfile</code></p> <p>Class containing the temperature and load profiles of two winding transformers for the thermal model <code>Model()</code>.</p> <p>This class is also capable of converting the results to a single dataframe with the timestamp as the index for convenience.</p> <p>Attributes:</p> Name Type Description <code>datetime_index</code> <code>NDArray[datetime64]</code> <p>A 1d array with the datetime index for the profiles.</p> <code>load_profile</code> <code>NDArray[float64]</code> <p>A 1d array with the load profile for the transformer.</p> <code>ambient_temperature_profile</code> <code>NDArray[float64]</code> <p>A 1d array with the ambient temperature profile for the transformer.</p> <p>Methods:</p> Name Description <code>create</code> <p>Create an InputProfile.</p> <code>from_dataframe</code> <p>Create an InputProfile from a dataframe.</p>"},{"location":"api_reference/model_input_output/#transformer_thermal_model.schemas.thermal_model.InputProfile.load_profile_array","title":"load_profile_array  <code>property</code>","text":"<pre><code>load_profile_array: NDArray[float64]\n</code></pre> <p>Return the single load profile for the transformer.</p>"},{"location":"api_reference/model_input_output/#transformer_thermal_model.schemas.thermal_model.InputProfile.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    datetime_index: Collection[datetime],\n    load_profile: Collection[float],\n    ambient_temperature_profile: Collection[float],\n    top_oil_temperature_profile: Collection[float]\n    | None = None,\n) -&gt; Self\n</code></pre> <p>Create an InputProfile.</p> <p>Parameters:</p> Name Type Description Default <code>datetime_index</code> <code>Collection[datetime]</code> <p>The datetime index for the profiles.</p> required <code>load_profile</code> <code>Collection[float]</code> <p>The load profile for the transformer.</p> required <code>ambient_temperature_profile</code> <code>Collection[float]</code> <p>The ambient temperature profile for the transformer.</p> required <code>top_oil_temperature_profile</code> <code>Collection[float] | None</code> <p>The top oil temperature profile for the transformer (optional).</p> <code>None</code> <p>Returns:</p> Type Description <code>Self</code> <p>An InputProfile object.</p> Creating an InputProfile from collections. <pre><code>&gt;&gt;&gt; from datetime import datetime\n&gt;&gt;&gt; from transformer_thermal_model.schemas import InputProfile\n\n&gt;&gt;&gt; datetime_index = [\n...     datetime(2023, 1, 1, 0, 0),\n...     datetime(2023, 1, 1, 1, 0),\n...     datetime(2023, 1, 1, 2, 0),\n... ]\n&gt;&gt;&gt; load_profile = [0.8, 0.9, 1.0]\n&gt;&gt;&gt; ambient_temperature_profile = [25.0, 24.5, 24.0]\n&gt;&gt;&gt; input_profile = InputProfile.create(\n...     datetime_index=datetime_index,\n...     load_profile=load_profile,\n...     ambient_temperature_profile=ambient_temperature_profile,\n... )\n&gt;&gt;&gt; input_profile\nInputProfile(datetime_index=array(['2023-01-01T00:00:00.000000',\n'2023-01-01T01:00:00.000000', '2023-01-01T02:00:00.000000'],\ndtype='datetime64[us]'), ambient_temperature_profile=array([25. , 24.5, 24. ]),\ntop_oil_temperature_profile=None, load_profile=array([0.8, 0.9, 1. ]))\n</code></pre> <p>Example: Directly creating an InputProfile object using numpy arrays.     <pre><code>&gt;&gt;&gt; import numpy as np\n&gt;&gt;&gt; from datetime import datetime\n&gt;&gt;&gt; from transformer_thermal_model.schemas import InputProfile\n\n&gt;&gt;&gt; input_profile = InputProfile(\n...     datetime_index=np.array(\n...         [\n...             datetime(2023, 1, 1, 0, 0),\n...             datetime(2023, 1, 1, 1, 0),\n...             datetime(2023, 1, 1, 2, 0)\n...         ],\n...         dtype=np.datetime64,\n...     ),\n...     load_profile=np.array([0.8, 0.9, 1.0], dtype=float),\n...     ambient_temperature_profile=np.array([25.0, 24.5, 24.0], dtype=float)\n... )\n&gt;&gt;&gt; input_profile\nInputProfile(datetime_index=array(['2023-01-01T00:00:00.000000',\n'2023-01-01T01:00:00.000000', '2023-01-01T02:00:00.000000'],\ndtype='datetime64[us]'), ambient_temperature_profile=array([25. , 24.5, 24. ]),\ntop_oil_temperature_profile=None, load_profile=array([0.8, 0.9, 1. ]))\n</code></pre> Example: Creating an InputProfile including the top oil temperature.     <pre><code>&gt;&gt;&gt; from datetime import datetime\n&gt;&gt;&gt; from transformer_thermal_model.schemas import InputProfile\n\n&gt;&gt;&gt; datetime_index = [\n...     datetime(2023, 1, 1, 0, 0),\n...     datetime(2023, 1, 1, 1, 0),\n...     datetime(2023, 1, 1, 2, 0),\n... ]\n&gt;&gt;&gt; load_profile = [0.8, 0.9, 1.0]\n&gt;&gt;&gt; ambient_temperature_profile = [25.0, 24.5, 24.0]\n&gt;&gt;&gt; top_oil_temperature = [37.0, 36.5, 36.0]\n&gt;&gt;&gt; input_profile = InputProfile.create(\n...     datetime_index=datetime_index,\n...     load_profile=load_profile,\n...     ambient_temperature_profile=ambient_temperature_profile,\n...     top_oil_temperature_profile=top_oil_temperature,\n... )\n&gt;&gt;&gt; input_profile\nInputProfile(datetime_index=array(['2023-01-01T00:00:00.000000', '2023-01-01T01:00:00.000000',\n'2023-01-01T02:00:00.000000'], dtype='datetime64[us]'),\nambient_temperature_profile=array([25. , 24.5, 24. ]),\ntop_oil_temperature_profile=array([37. , 36.5, 36. ]), load_profile=array([0.8, 0.9, 1. ]))\n</code></pre></p> Source code in <code>transformer_thermal_model/schemas/thermal_model/input_profile.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    datetime_index: Collection[datetime],\n    load_profile: Collection[float],\n    ambient_temperature_profile: Collection[float],\n    top_oil_temperature_profile: Collection[float] | None = None,\n) -&gt; Self:\n    \"\"\"Create an InputProfile.\n\n    Args:\n        datetime_index: The datetime index for the profiles.\n        load_profile: The load profile for the transformer.\n        ambient_temperature_profile: The ambient temperature profile for the transformer.\n        top_oil_temperature_profile: The top oil temperature profile for the transformer (optional).\n\n    Returns:\n        An InputProfile object.\n\n    Example: Creating an InputProfile from collections.\n        ```python\n        &gt;&gt;&gt; from datetime import datetime\n        &gt;&gt;&gt; from transformer_thermal_model.schemas import InputProfile\n\n        &gt;&gt;&gt; datetime_index = [\n        ...     datetime(2023, 1, 1, 0, 0),\n        ...     datetime(2023, 1, 1, 1, 0),\n        ...     datetime(2023, 1, 1, 2, 0),\n        ... ]\n        &gt;&gt;&gt; load_profile = [0.8, 0.9, 1.0]\n        &gt;&gt;&gt; ambient_temperature_profile = [25.0, 24.5, 24.0]\n        &gt;&gt;&gt; input_profile = InputProfile.create(\n        ...     datetime_index=datetime_index,\n        ...     load_profile=load_profile,\n        ...     ambient_temperature_profile=ambient_temperature_profile,\n        ... )\n        &gt;&gt;&gt; input_profile\n        InputProfile(datetime_index=array(['2023-01-01T00:00:00.000000',\n        '2023-01-01T01:00:00.000000', '2023-01-01T02:00:00.000000'],\n        dtype='datetime64[us]'), ambient_temperature_profile=array([25. , 24.5, 24. ]),\n        top_oil_temperature_profile=None, load_profile=array([0.8, 0.9, 1. ]))\n\n        ```\n    Example: Directly creating an InputProfile object using numpy arrays.\n        ```python\n        &gt;&gt;&gt; import numpy as np\n        &gt;&gt;&gt; from datetime import datetime\n        &gt;&gt;&gt; from transformer_thermal_model.schemas import InputProfile\n\n        &gt;&gt;&gt; input_profile = InputProfile(\n        ...     datetime_index=np.array(\n        ...         [\n        ...             datetime(2023, 1, 1, 0, 0),\n        ...             datetime(2023, 1, 1, 1, 0),\n        ...             datetime(2023, 1, 1, 2, 0)\n        ...         ],\n        ...         dtype=np.datetime64,\n        ...     ),\n        ...     load_profile=np.array([0.8, 0.9, 1.0], dtype=float),\n        ...     ambient_temperature_profile=np.array([25.0, 24.5, 24.0], dtype=float)\n        ... )\n        &gt;&gt;&gt; input_profile\n        InputProfile(datetime_index=array(['2023-01-01T00:00:00.000000',\n        '2023-01-01T01:00:00.000000', '2023-01-01T02:00:00.000000'],\n        dtype='datetime64[us]'), ambient_temperature_profile=array([25. , 24.5, 24. ]),\n        top_oil_temperature_profile=None, load_profile=array([0.8, 0.9, 1. ]))\n\n        ```\n    Example: Creating an InputProfile including the top oil temperature.\n        ```python\n        &gt;&gt;&gt; from datetime import datetime\n        &gt;&gt;&gt; from transformer_thermal_model.schemas import InputProfile\n\n        &gt;&gt;&gt; datetime_index = [\n        ...     datetime(2023, 1, 1, 0, 0),\n        ...     datetime(2023, 1, 1, 1, 0),\n        ...     datetime(2023, 1, 1, 2, 0),\n        ... ]\n        &gt;&gt;&gt; load_profile = [0.8, 0.9, 1.0]\n        &gt;&gt;&gt; ambient_temperature_profile = [25.0, 24.5, 24.0]\n        &gt;&gt;&gt; top_oil_temperature = [37.0, 36.5, 36.0]\n        &gt;&gt;&gt; input_profile = InputProfile.create(\n        ...     datetime_index=datetime_index,\n        ...     load_profile=load_profile,\n        ...     ambient_temperature_profile=ambient_temperature_profile,\n        ...     top_oil_temperature_profile=top_oil_temperature,\n        ... )\n        &gt;&gt;&gt; input_profile\n        InputProfile(datetime_index=array(['2023-01-01T00:00:00.000000', '2023-01-01T01:00:00.000000',\n        '2023-01-01T02:00:00.000000'], dtype='datetime64[us]'),\n        ambient_temperature_profile=array([25. , 24.5, 24. ]),\n        top_oil_temperature_profile=array([37. , 36.5, 36. ]), load_profile=array([0.8, 0.9, 1. ]))\n\n        ```\n    \"\"\"\n    return cls(\n        datetime_index=np.array(datetime_index, dtype=np.datetime64),\n        load_profile=np.array(load_profile, dtype=float),\n        ambient_temperature_profile=np.array(ambient_temperature_profile, dtype=float),\n        top_oil_temperature_profile=(\n            np.array(top_oil_temperature_profile, dtype=float) if top_oil_temperature_profile is not None else None\n        ),\n    )\n</code></pre>"},{"location":"api_reference/model_input_output/#transformer_thermal_model.schemas.thermal_model.InputProfile.from_dataframe","title":"from_dataframe  <code>classmethod</code>","text":"<pre><code>from_dataframe(df: DataFrame) -&gt; Self\n</code></pre> <p>Create an InputProfile from a dataframe.</p> <p>Parameters:</p> Name Type Description Default <code>df</code> <code>DataFrame</code> <p>The dataframe containing the profiles. The dataframe should have a datetime index and three columns: - 'datetime_index': The datetime index for the profiles. - 'load_profile': The load profile for the transformer. - 'ambient_temperature_profile': The ambient temperature profile for the transformer.</p> required <p>Returns:</p> Type Description <code>Self</code> <p>An InputProfile object.</p> Source code in <code>transformer_thermal_model/schemas/thermal_model/input_profile.py</code> <pre><code>@classmethod\ndef from_dataframe(cls, df: pd.DataFrame) -&gt; Self:\n    \"\"\"Create an InputProfile from a dataframe.\n\n    Args:\n        df: The dataframe containing the profiles. The dataframe should have a datetime index and three columns:\n            - 'datetime_index': The datetime index for the profiles.\n            - 'load_profile': The load profile for the transformer.\n            - 'ambient_temperature_profile': The ambient temperature profile for the transformer.\n\n    Returns:\n        An InputProfile object.\n\n    \"\"\"\n    required_columns = {\"datetime_index\", \"load_profile\", \"ambient_temperature_profile\"}\n    missing_columns = required_columns - set(df.columns)\n    if missing_columns:\n        raise ValueError(f\"The dataframe is missing the following required columns: {', '.join(missing_columns)}\")\n\n    return cls(\n        datetime_index=df[\"datetime_index\"].to_numpy(),\n        load_profile=df[\"load_profile\"].to_numpy(),\n        ambient_temperature_profile=df[\"ambient_temperature_profile\"].to_numpy(),\n        top_oil_temperature_profile=df[\"top_oil_temperature_profile\"].to_numpy()\n        if \"top_oil_temperature_profile\" in df.columns\n        else None,\n    )\n</code></pre>"},{"location":"api_reference/model_input_output/#transformer_thermal_model.schemas.thermal_model.ThreeWindingInputProfile","title":"ThreeWindingInputProfile","text":"<p>               Bases: <code>BaseInputProfile</code></p> <p>Class for three-winding transformer input profiles.</p> <p>This class extends InputProfile to include three load profiles for three-winding transformers. It ensures that all three load profiles are provided and have the same length as the ambient temperature profile.</p> <p>Methods:</p> Name Description <code>create</code> <p>Create a ThreeWindingInputProfile from datetime index, ambient temperature profile, and three load profiles.</p> <p>Attributes:</p> Name Type Description <code>load_profile_array</code> <code>NDArray[float64]</code> <p>Return an array with shape (3,n) of the three load profiles (high, middle, low voltage sides).</p>"},{"location":"api_reference/model_input_output/#transformer_thermal_model.schemas.thermal_model.ThreeWindingInputProfile.load_profile_array","title":"load_profile_array  <code>property</code>","text":"<pre><code>load_profile_array: NDArray[float64]\n</code></pre> <p>Return an array with shape (3,n) of the three load profiles (high, middle, low voltage sides).</p>"},{"location":"api_reference/model_input_output/#transformer_thermal_model.schemas.thermal_model.ThreeWindingInputProfile.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    datetime_index: Collection[datetime],\n    ambient_temperature_profile: Collection[float],\n    load_profile_high_voltage_side: Collection[float],\n    load_profile_middle_voltage_side: Collection[float],\n    load_profile_low_voltage_side: Collection[float],\n    top_oil_temperature_profile: Collection[float]\n    | None = None,\n) -&gt; Self\n</code></pre> <p>Create a ThreeWindingInputProfile from datetime index, ambient temperature profile, and three load profiles.</p> <p>Parameters:</p> Name Type Description Default <code>datetime_index</code> <code>Collection[datetime]</code> <p>The datetime index for the profiles.</p> required <code>ambient_temperature_profile</code> <code>Collection[float]</code> <p>The ambient temperature profile for the transformer.</p> required <code>load_profile_high_voltage_side</code> <code>Collection[float]</code> <p>Load profile for the high voltage side.</p> required <code>load_profile_middle_voltage_side</code> <code>Collection[float]</code> <p>Load profile for the middle voltage side.</p> required <code>load_profile_low_voltage_side</code> <code>Collection[float]</code> <p>Load profile for the low voltage side.</p> required <code>top_oil_temperature_profile</code> <code>Collection[float] | None</code> <p>The top oil temperature profile for the transformer (optional).</p> <code>None</code> <p>Returns:</p> Type Description <code>Self</code> <p>A ThreeWindingInputProfile object.</p> Creating a ThreeWindingInputProfile from collections. <pre><code>&gt;&gt;&gt; import numpy as np\n&gt;&gt;&gt; from datetime import datetime\n&gt;&gt;&gt; from transformer_thermal_model.schemas import ThreeWindingInputProfile\n\n&gt;&gt;&gt; input_profile = ThreeWindingInputProfile.create(\n...     datetime_index=np.array(\n...         [\n...             datetime(2023, 1, 1, 0, 0),\n...             datetime(2023, 1, 1, 1, 0),\n...             datetime(2023, 1, 1, 2, 0)\n...         ],\n...         dtype=np.datetime64,\n...     ),\n...     load_profile_high_voltage_side=np.array([0.8, 0.9, 1.0], dtype=float),\n...     load_profile_middle_voltage_side=np.array([0.7, 0.8, 0.9], dtype=float),\n...     load_profile_low_voltage_side=np.array([0.6, 0.7, 0.8], dtype=float),\n...     ambient_temperature_profile=np.array([25.0, 24.5, 24.0], dtype=float)\n... )\n&gt;&gt;&gt; input_profile\nThreeWindingInputProfile(datetime_index=array(['2023-01-01T00:00:00.000000', '2023-01-01T01:00:00.000000',\n'2023-01-01T02:00:00.000000'], dtype='datetime64[us]'),\nambient_temperature_profile=array([25. , 24.5, 24. ]),\ntop_oil_temperature_profile=None,\nload_profile_high_voltage_side=array([0.8, 0.9, 1. ]),\nload_profile_middle_voltage_side=array([0.7, 0.8, 0.9]),\nload_profile_low_voltage_side=array([0.6, 0.7, 0.8]))\n</code></pre> Source code in <code>transformer_thermal_model/schemas/thermal_model/input_profile.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    datetime_index: Collection[datetime],\n    ambient_temperature_profile: Collection[float],\n    load_profile_high_voltage_side: Collection[float],\n    load_profile_middle_voltage_side: Collection[float],\n    load_profile_low_voltage_side: Collection[float],\n    top_oil_temperature_profile: Collection[float] | None = None,\n) -&gt; Self:\n    \"\"\"Create a ThreeWindingInputProfile from datetime index, ambient temperature profile, and three load profiles.\n\n    Args:\n        datetime_index: The datetime index for the profiles.\n        ambient_temperature_profile: The ambient temperature profile for the transformer.\n        load_profile_high_voltage_side: Load profile for the high voltage side.\n        load_profile_middle_voltage_side: Load profile for the middle voltage side.\n        load_profile_low_voltage_side: Load profile for the low voltage side.\n        top_oil_temperature_profile: The top oil temperature profile for the transformer (optional).\n\n    Returns:\n        A ThreeWindingInputProfile object.\n\n    Example: Creating a ThreeWindingInputProfile from collections.\n        ```python\n        &gt;&gt;&gt; import numpy as np\n        &gt;&gt;&gt; from datetime import datetime\n        &gt;&gt;&gt; from transformer_thermal_model.schemas import ThreeWindingInputProfile\n\n        &gt;&gt;&gt; input_profile = ThreeWindingInputProfile.create(\n        ...     datetime_index=np.array(\n        ...         [\n        ...             datetime(2023, 1, 1, 0, 0),\n        ...             datetime(2023, 1, 1, 1, 0),\n        ...             datetime(2023, 1, 1, 2, 0)\n        ...         ],\n        ...         dtype=np.datetime64,\n        ...     ),\n        ...     load_profile_high_voltage_side=np.array([0.8, 0.9, 1.0], dtype=float),\n        ...     load_profile_middle_voltage_side=np.array([0.7, 0.8, 0.9], dtype=float),\n        ...     load_profile_low_voltage_side=np.array([0.6, 0.7, 0.8], dtype=float),\n        ...     ambient_temperature_profile=np.array([25.0, 24.5, 24.0], dtype=float)\n        ... )\n        &gt;&gt;&gt; input_profile\n        ThreeWindingInputProfile(datetime_index=array(['2023-01-01T00:00:00.000000', '2023-01-01T01:00:00.000000',\n        '2023-01-01T02:00:00.000000'], dtype='datetime64[us]'),\n        ambient_temperature_profile=array([25. , 24.5, 24. ]),\n        top_oil_temperature_profile=None,\n        load_profile_high_voltage_side=array([0.8, 0.9, 1. ]),\n        load_profile_middle_voltage_side=array([0.7, 0.8, 0.9]),\n        load_profile_low_voltage_side=array([0.6, 0.7, 0.8]))\n\n        ```\n    \"\"\"\n    return cls(\n        datetime_index=np.array(datetime_index, dtype=np.datetime64),\n        ambient_temperature_profile=np.array(ambient_temperature_profile, dtype=float),\n        load_profile_high_voltage_side=np.array(load_profile_high_voltage_side, dtype=float),\n        load_profile_middle_voltage_side=np.array(load_profile_middle_voltage_side, dtype=float),\n        load_profile_low_voltage_side=np.array(load_profile_low_voltage_side, dtype=float),\n        top_oil_temperature_profile=np.array(top_oil_temperature_profile, dtype=float)\n        if top_oil_temperature_profile is not None\n        else None,\n    )\n</code></pre>"},{"location":"api_reference/model_input_output/#transformer_thermal_model.schemas.thermal_model.CoolingSwitchBase","title":"CoolingSwitchBase","text":"<p>               Bases: <code>BaseModel</code></p> <p>Class representing the ONAF (Oil Natural Air Forced) cooling switch status.</p> <p>Methods:</p> Name Description <code>check_consistency</code> <p>Check that either fan_on or temperature_threshold is provided, but not both.</p>"},{"location":"api_reference/model_input_output/#transformer_thermal_model.schemas.thermal_model.CoolingSwitchBase.check_consistency","title":"check_consistency","text":"<pre><code>check_consistency() -&gt; Self\n</code></pre> <p>Check that either fan_on or temperature_threshold is provided, but not both.</p> There are two ways to model a switch between ON and OFF for the ONAF cooling <ol> <li>Provide a list of booleans indicating whether the switch is ON (True) or OFF (False) at each time step.</li> <li>Provide a temperature threshold, where the switch turns ON when the hot-spot temperature exceeds this threshold.</li> </ol> Source code in <code>transformer_thermal_model/schemas/thermal_model/onaf_switch.py</code> <pre><code>@model_validator(mode=\"after\")\ndef check_consistency(self) -&gt; Self:\n    \"\"\"Check that either fan_on or temperature_threshold is provided, but not both.\n\n    There are two ways to model a switch between ON and OFF for the ONAF cooling:\n        1. Provide a list of booleans indicating whether the switch is ON (True) or OFF (False) at each time step.\n        2. Provide a temperature threshold, where the switch turns ON when the hot-spot temperature\n        exceeds this threshold.\n    \"\"\"\n    if self.fan_on is not None and self.temperature_threshold is not None:\n        raise ValueError(\"Provide either 'fan_on' or 'temperature_threshold', not both.\")\n    if self.fan_on is None and self.temperature_threshold is None:\n        raise ValueError(\"Either 'fan_on' or 'temperature_threshold' must be provided.\")\n    return self\n</code></pre>"},{"location":"api_reference/model_input_output/#transformer_thermal_model.schemas.thermal_model.CoolingSwitchConfig","title":"CoolingSwitchConfig","text":"<p>               Bases: <code>BaseModel</code></p> <p>Class representing the fan switch configuration for ONAF cooling.</p> <p>Methods:</p> Name Description <code>check_temperatures</code> <p>Check that the activation temperature is higher than the deactivation temperature.</p>"},{"location":"api_reference/model_input_output/#transformer_thermal_model.schemas.thermal_model.CoolingSwitchConfig.check_temperatures","title":"check_temperatures","text":"<pre><code>check_temperatures() -&gt; Self\n</code></pre> <p>Check that the activation temperature is higher than the deactivation temperature.</p> Source code in <code>transformer_thermal_model/schemas/thermal_model/onaf_switch.py</code> <pre><code>@model_validator(mode=\"after\")\ndef check_temperatures(self) -&gt; Self:\n    \"\"\"Check that the activation temperature is higher than the deactivation temperature.\"\"\"\n    if self.activation_temp &lt;= self.deactivation_temp:\n        raise ValueError(\"Activation temperature must be higher than deactivation temperature.\")\n    return self\n</code></pre>"},{"location":"api_reference/model_input_output/#transformer_thermal_model.schemas.thermal_model.CoolingSwitchSettings","title":"CoolingSwitchSettings","text":"<p>               Bases: <code>CoolingSwitchBase</code></p> <p>Class representing the ONAF (Oil Natural Air Forced) cooling switch settings.</p> <p>This class includes the ONAN parameters to be used when the transformer switches to ONAN cooling.</p>"},{"location":"api_reference/model_input_output/#transformer_thermal_model.schemas.thermal_model.ONANParameters","title":"ONANParameters","text":"<p>               Bases: <code>BaseONANParameters</code></p> <p>Class representing ONAN (Oil Natural Air Natural) cooling parameters.</p>"},{"location":"api_reference/model_input_output/#transformer_thermal_model.schemas.thermal_model.ThreeWindingCoolingSwitchSettings","title":"ThreeWindingCoolingSwitchSettings","text":"<p>               Bases: <code>CoolingSwitchBase</code></p> <p>Class representing the ONAF (Oil Natural Air Forced) cooling switch settings for three-winding transformers.</p> <p>This class includes the ONAN parameters to be used when the transformer switches to ONAN cooling.</p>"},{"location":"api_reference/model_input_output/#transformer_thermal_model.schemas.thermal_model.ThreeWindingONANParameters","title":"ThreeWindingONANParameters","text":"<p>               Bases: <code>BaseONANParameters</code></p> <p>Class representing ONAN (Oil Natural Air Natural) cooling parameters for three-winding transformers.</p>"},{"location":"api_reference/model_input_output/#transformer_thermal_model.schemas.thermal_model.OutputProfile","title":"OutputProfile","text":"<p>               Bases: <code>BaseModel</code></p> <p>Class containing the output data for the hot-spot and top-oil temperature calculations.</p> <p>The class consists of the top-oil and hot-spot temperature profiles. These have the datetime index as the timestamp that link both of these series together.</p> <p>Additionally, this class has a helper function to convert the output to a single dataframe for convenience.</p> <p>Methods:</p> Name Description <code>convert_to_dataframe</code> <p>Process the two pandas Series and convert them to a single dataframe, linked by the timestamp.</p>"},{"location":"api_reference/model_input_output/#transformer_thermal_model.schemas.thermal_model.OutputProfile.convert_to_dataframe","title":"convert_to_dataframe","text":"<pre><code>convert_to_dataframe() -&gt; DataFrame\n</code></pre> <p>Process the two pandas Series and convert them to a single dataframe, linked by the timestamp.</p> Source code in <code>transformer_thermal_model/schemas/thermal_model/output_profile.py</code> <pre><code>def convert_to_dataframe(self) -&gt; pd.DataFrame:\n    \"\"\"Process the two pandas Series and convert them to a single dataframe, linked by the timestamp.\"\"\"\n    df = pd.DataFrame(\n        {\n            \"timestamp\": self.top_oil_temp_profile.index,\n            \"top_oil_temperature\": self.top_oil_temp_profile,\n            \"hot_spot_temperature\": self.hot_spot_temp_profile,\n        }\n    )\n    return df\n</code></pre>"},{"location":"api_reference/specifications/","title":"Specifications","text":""},{"location":"api_reference/specifications/#specifications","title":"Specifications","text":""},{"location":"api_reference/specifications/#transformer-specifications","title":"Transformer specifications","text":"<p>A transformer object in our package needs to be initiated using a set of specifications. A user will typically only interact with <code>UserTransformerSpecifications</code>. The <code>DefaultTransformerSpecifications</code> are used to set the <code>Transformer.defaults</code> values. The <code>TransformerSpecifications</code> is created to make sure the <code>UserTransformerSpecifications</code> and the <code>DefaultTransformerSpecifications</code> are neatly combined.</p> <p>Classes:</p> Name Description <code>DefaultWindingSpecifications</code> <p>The default specifications for a single winding of a transformer.</p> <code>WindingSpecifications</code> <p>The specifications for a single winding of a transformer.</p> <code>BaseUserTransformerSpecifications</code> <p>The base transformer specifications that the user must and can provide.</p> <code>UserTransformerSpecifications</code> <p>An extended version of the base transformer specifications for power and distribution transformers.</p> <code>UserThreeWindingTransformerSpecifications</code> <p>An extended version of the base transformer specifications for three-winding transformers.</p> <code>BaseDefaultTransformerSpecifications</code> <p>The default transformer specifications that will be defined when the user does not provide them.</p> <code>DefaultTransformerSpecifications</code> <p>The default specifications that are specific to a power or distribution transformer.</p> <code>ThreeWindingTransformerDefaultSpecifications</code> <p>The default specifications that are specific to a three-winding transformer.</p> <code>BaseTransformerSpecifications</code> <p>Base Class containing transformer specifications.</p> <code>TransformerSpecifications</code> <p>Class containing transformer specifications.</p> <code>ThreeWindingTransformerSpecifications</code> <p>The transformer specifications that are specific to a three-winding transformer.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.DefaultWindingSpecifications","title":"DefaultWindingSpecifications","text":"<p>               Bases: <code>BaseModel</code></p> <p>The default specifications for a single winding of a transformer.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.WindingSpecifications","title":"WindingSpecifications","text":"<p>               Bases: <code>DefaultWindingSpecifications</code></p> <p>The specifications for a single winding of a transformer.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.BaseUserTransformerSpecifications","title":"BaseUserTransformerSpecifications","text":"<p>               Bases: <code>BaseModel</code></p> <p>The base transformer specifications that the user must and can provide.</p> <p>If any of the optional values are provided, they will overwrite the <code>defaults</code> that are set in the respective <code>Transformer</code> class.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.UserTransformerSpecifications","title":"UserTransformerSpecifications","text":"<p>               Bases: <code>BaseUserTransformerSpecifications</code></p> <p>An extended version of the base transformer specifications for power and distribution transformers.</p> <p>If any of the optional values are provided, they will overwrite the <code>defaults</code> that are set in the respective <code>Transformer</code> class.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.UserThreeWindingTransformerSpecifications","title":"UserThreeWindingTransformerSpecifications","text":"<p>               Bases: <code>BaseUserTransformerSpecifications</code></p> <p>An extended version of the base transformer specifications for three-winding transformers.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.BaseDefaultTransformerSpecifications","title":"BaseDefaultTransformerSpecifications","text":"<p>               Bases: <code>BaseModel</code></p> <p>The default transformer specifications that will be defined when the user does not provide them.</p> <p>Each <code>Transformer</code> object has a class variable <code>defaults</code> that contains the default transformer specifications.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.DefaultTransformerSpecifications","title":"DefaultTransformerSpecifications","text":"<p>               Bases: <code>BaseDefaultTransformerSpecifications</code></p> <p>The default specifications that are specific to a power or distribution transformer.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.ThreeWindingTransformerDefaultSpecifications","title":"ThreeWindingTransformerDefaultSpecifications","text":"<p>               Bases: <code>BaseDefaultTransformerSpecifications</code></p> <p>The default specifications that are specific to a three-winding transformer.</p> <p>For now this contains no additional elements, this is for future expansion.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.BaseTransformerSpecifications","title":"BaseTransformerSpecifications","text":"<p>               Bases: <code>BaseModel</code></p> <p>Base Class containing transformer specifications.</p> <p>Attributes:</p> Name Type Description <code>nominal_load_array</code> <code>ndarray</code> <p>Return the nominal loads as a numpy array.</p> <code>winding_oil_gradient_array</code> <code>ndarray</code> <p>Return the winding oil gradient as a numpy array.</p> <code>time_const_windings_array</code> <code>ndarray</code> <p>Return the winding time constant as a numpy array.</p> <code>hot_spot_fac_array</code> <code>ndarray</code> <p>Return the hotspot factor as a numpy array.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.BaseTransformerSpecifications.nominal_load_array","title":"nominal_load_array  <code>property</code>","text":"<pre><code>nominal_load_array: ndarray\n</code></pre> <p>Return the nominal loads as a numpy array.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.BaseTransformerSpecifications.winding_oil_gradient_array","title":"winding_oil_gradient_array  <code>property</code>","text":"<pre><code>winding_oil_gradient_array: ndarray\n</code></pre> <p>Return the winding oil gradient as a numpy array.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.BaseTransformerSpecifications.time_const_windings_array","title":"time_const_windings_array  <code>property</code>","text":"<pre><code>time_const_windings_array: ndarray\n</code></pre> <p>Return the winding time constant as a numpy array.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.BaseTransformerSpecifications.hot_spot_fac_array","title":"hot_spot_fac_array  <code>property</code>","text":"<pre><code>hot_spot_fac_array: ndarray\n</code></pre> <p>Return the hotspot factor as a numpy array.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.TransformerSpecifications","title":"TransformerSpecifications","text":"<p>               Bases: <code>BaseTransformerSpecifications</code></p> <p>Class containing transformer specifications.</p> <p>This class is a combination of the mandatory user-provided specifications and the default transformer specifications. Should the user provide any of the optional specifications, they will override the default specifications, via the <code>create</code> class method.</p> <p>Methods:</p> Name Description <code>create</code> <p>Create the transformer specifications from the defaults and the user specifications.</p> <p>Attributes:</p> Name Type Description <code>nominal_load_array</code> <code>ndarray</code> <p>Return the nominal loads as a numpy array.</p> <code>winding_oil_gradient_array</code> <code>ndarray</code> <p>Return the winding oil gradient as a numpy array.</p> <code>time_const_windings_array</code> <code>ndarray</code> <p>Return the winding time constant as a numpy array.</p> <code>hot_spot_fac_array</code> <code>ndarray</code> <p>Return the hotspot factor as a numpy array.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.TransformerSpecifications.nominal_load_array","title":"nominal_load_array  <code>property</code>","text":"<pre><code>nominal_load_array: ndarray\n</code></pre> <p>Return the nominal loads as a numpy array.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.TransformerSpecifications.winding_oil_gradient_array","title":"winding_oil_gradient_array  <code>property</code>","text":"<pre><code>winding_oil_gradient_array: ndarray\n</code></pre> <p>Return the winding oil gradient as a numpy array.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.TransformerSpecifications.time_const_windings_array","title":"time_const_windings_array  <code>property</code>","text":"<pre><code>time_const_windings_array: ndarray\n</code></pre> <p>Return the winding time constant as a numpy array.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.TransformerSpecifications.hot_spot_fac_array","title":"hot_spot_fac_array  <code>property</code>","text":"<pre><code>hot_spot_fac_array: ndarray\n</code></pre> <p>Return the hotspot factor as a numpy array.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.TransformerSpecifications.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    defaults: DefaultTransformerSpecifications,\n    user: UserTransformerSpecifications,\n) -&gt; TransformerSpecifications\n</code></pre> <p>Create the transformer specifications from the defaults and the user specifications.</p> Source code in <code>transformer_thermal_model/schemas/specifications/transformer.py</code> <pre><code>@classmethod\ndef create(\n    cls, defaults: DefaultTransformerSpecifications, user: UserTransformerSpecifications\n) -&gt; \"TransformerSpecifications\":\n    \"\"\"Create the transformer specifications from the defaults and the user specifications.\"\"\"\n    data = defaults.model_dump()\n    data.update(user.model_dump(exclude_none=True))\n    logger.info(\"Complete transformer specifications: %s\", data)\n    return cls(**data)\n</code></pre>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.ThreeWindingTransformerSpecifications","title":"ThreeWindingTransformerSpecifications","text":"<p>               Bases: <code>BaseTransformerSpecifications</code></p> <p>The transformer specifications that are specific to a three-winding transformer.</p> <p>For all three windings the specs should be provided. Note that we use the following abbreviations: *  Low voltage: lv *  Medium voltage: mv *  High voltage: hv</p> <p>Methods:</p> Name Description <code>create</code> <p>Create a ThreeWindingTransformerSpecifications instance by merging defaults with user specifications.</p> <p>Attributes:</p> Name Type Description <code>load_loss_total</code> <code>float</code> <p>Calculate the total load loss for the three-winding transformer.</p> <code>nominal_load_array</code> <code>ndarray</code> <p>Return the nominal loads as a numpy array.</p> <code>winding_oil_gradient_array</code> <code>ndarray</code> <p>Return the winding oil gradient as a numpy array.</p> <code>time_const_windings_array</code> <code>ndarray</code> <p>Return the winding oil gradient as a numpy array.</p> <code>hot_spot_fac_array</code> <code>ndarray</code> <p>Return the winding oil gradient as a numpy array.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.ThreeWindingTransformerSpecifications.load_loss_total","title":"load_loss_total  <code>property</code>","text":"<pre><code>load_loss_total: float\n</code></pre> <p>Calculate the total load loss for the three-winding transformer.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.ThreeWindingTransformerSpecifications.nominal_load_array","title":"nominal_load_array  <code>property</code>","text":"<pre><code>nominal_load_array: ndarray\n</code></pre> <p>Return the nominal loads as a numpy array.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.ThreeWindingTransformerSpecifications.winding_oil_gradient_array","title":"winding_oil_gradient_array  <code>property</code>","text":"<pre><code>winding_oil_gradient_array: ndarray\n</code></pre> <p>Return the winding oil gradient as a numpy array.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.ThreeWindingTransformerSpecifications.time_const_windings_array","title":"time_const_windings_array  <code>property</code>","text":"<pre><code>time_const_windings_array: ndarray\n</code></pre> <p>Return the winding oil gradient as a numpy array.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.ThreeWindingTransformerSpecifications.hot_spot_fac_array","title":"hot_spot_fac_array  <code>property</code>","text":"<pre><code>hot_spot_fac_array: ndarray\n</code></pre> <p>Return the winding oil gradient as a numpy array.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer.ThreeWindingTransformerSpecifications.create","title":"create  <code>classmethod</code>","text":"<pre><code>create(\n    defaults: ThreeWindingTransformerDefaultSpecifications,\n    user: UserThreeWindingTransformerSpecifications,\n) -&gt; Self\n</code></pre> <p>Create a ThreeWindingTransformerSpecifications instance by merging defaults with user specifications.</p> <p>This method performs a merge of the <code>defaults</code> and <code>user</code> specifications. The merge behavior is as follows: - For top-level keys, values from <code>user</code> will overwrite those in <code>defaults</code>. - For nested dictionaries (e.g., <code>WindingSpecifications</code>), the merge is shallow:     - Keys in the nested dictionary from <code>user</code> will overwrite or add to the corresponding keys in <code>defaults</code>.     - Deeper levels of nesting are not recursively merged. Entire nested values are replaced.</p> <p>This implementation assumes that only two levels of nesting are required. If deeper recursive merging is needed, the logic will need to be updated.</p> <p>Parameters:</p> Name Type Description Default <code>defaults</code> <code>ThreeWindingTransformerDefaultSpecifications</code> <p>The default transformer specifications.</p> required <code>user</code> <code>UserThreeWindingTransformerSpecifications</code> <p>The user-provided transformer specifications.</p> required <p>Returns:</p> Name Type Description <code>ThreeWindingTransformerSpecifications</code> <code>Self</code> <p>A new instance with merged specifications.</p> Source code in <code>transformer_thermal_model/schemas/specifications/transformer.py</code> <pre><code>@classmethod\ndef create(\n    cls, defaults: ThreeWindingTransformerDefaultSpecifications, user: UserThreeWindingTransformerSpecifications\n) -&gt; Self:\n    \"\"\"Create a ThreeWindingTransformerSpecifications instance by merging defaults with user specifications.\n\n    This method performs a merge of the `defaults` and `user` specifications. The merge behavior is as follows:\n    - For top-level keys, values from `user` will overwrite those in `defaults`.\n    - For nested dictionaries (e.g., `WindingSpecifications`), the merge is shallow:\n        - Keys in the nested dictionary from `user` will overwrite or add to the corresponding keys in `defaults`.\n        - Deeper levels of nesting are not recursively merged. Entire nested values are replaced.\n\n    This implementation assumes that only two levels of nesting are required. If deeper recursive merging is needed,\n    the logic will need to be updated.\n\n    Args:\n        defaults (ThreeWindingTransformerDefaultSpecifications): The default transformer specifications.\n        user (UserThreeWindingTransformerSpecifications): The user-provided transformer specifications.\n\n    Returns:\n        ThreeWindingTransformerSpecifications: A new instance with merged specifications.\n    \"\"\"\n    # Perform a shallow merge of defaults and user specifications (up to two levels)\n    data = deepcopy(defaults.model_dump())\n    user_specs = user.model_dump(exclude_none=True)\n    for key, value in user_specs.items():\n        # Check for nested dictionaries (e.g., WindingSpecifications)\n        if key in data and isinstance(data[key], dict) and isinstance(value, dict):\n            # Perform a shallow merge at the second level\n            for sub_key, sub_value in value.items():\n                data[key][sub_key] = sub_value\n        else:\n            # Overwrite or add top-level keys\n            data[key] = value\n\n    logger.info(\"Complete three-winding transformer specifications: %s\", data)\n\n    # Add load_loss_total_user if provided in user specifications\n    data[\"load_loss_total_user\"] = user.load_loss_total if user.load_loss_total is not None else None\n    return cls(**data)\n</code></pre>"},{"location":"api_reference/specifications/#transformer-component-specifications","title":"Transformer component specifications","text":"<p>Classes:</p> Name Description <code>TransformerComponentSpecifications</code> <p>Component specifications for internal components of the power transformer.</p>"},{"location":"api_reference/specifications/#transformer_thermal_model.schemas.specifications.transformer_component.TransformerComponentSpecifications","title":"TransformerComponentSpecifications","text":"<p>               Bases: <code>BaseModel</code></p> <p>Component specifications for internal components of the power transformer.</p> <p>These specifications are used to calculate the limiting component in a <code>PowerTransformer</code>, which is optional entirely. It is used to define the components in the <code>PowerTransformer</code>, to then determine the limiting component.</p> <p>Attributes:</p> Name Type Description <code>nom_load_prim_side</code> <code>float</code> <p>Nominal current on the primary side of the transformer [A].</p> <code>tap_chang_capacity</code> <code>float | None</code> <p>Tap changer nominal current [A].</p> <code>tap_chang_conf</code> <code>VectorConfig | None</code> <p>Tap Changer configuration.</p> <code>tap_chang_side</code> <code>TransformerSide | None</code> <p>Tap changer side.</p> <code>prim_bush_capacity</code> <code>float | None</code> <p>Primary bushing nominal current [A].</p> <code>prim_bush_conf</code> <code>BushingConfig | None</code> <p>Primary bushing configuration.</p> <code>sec_bush_capacity</code> <code>float | None</code> <p>Secondary bushing nominal current [A].</p> <code>sec_bush_conf</code> <code>BushingConfig | None</code> <p>Secondary bushing configuration.</p> <code>cur_trans_capacity</code> <code>float | None</code> <p>Current transformer nominal current [A].</p> <code>cur_trans_conf</code> <code>VectorConfig | None</code> <p>Current transformer configuration.</p> <code>cur_trans_side</code> <code>TransformerSide | None</code> <p>Current transformer side.</p> Initialising a power transformer with component specifications. <pre><code>&gt;&gt;&gt; from transformer_thermal_model.cooler import CoolerType\n&gt;&gt;&gt; from transformer_thermal_model.components import VectorConfig, TransformerSide\n&gt;&gt;&gt; from transformer_thermal_model.schemas import (\n...     TransformerComponentSpecifications,\n...     UserTransformerSpecifications\n... )\n&gt;&gt;&gt; from transformer_thermal_model.transformer import PowerTransformer\n\n&gt;&gt;&gt; tr_specs = UserTransformerSpecifications(\n...         load_loss=1000,  # Transformer load loss [W]\n...         nom_load_sec_side=1500,  # Transformer nominal current secondary side [A]\n...         no_load_loss=200,  # Transformer no-load loss [W]\n...         amb_temp_surcharge=20,  # Ambient temperature surcharge [K]\n... )\n&gt;&gt;&gt; comp_specs = TransformerComponentSpecifications(\n...     tap_chang_capacity=600,\n...     nom_load_prim_side=550,\n...     tap_chang_conf=VectorConfig.STAR,\n...     tap_chang_side=TransformerSide.PRIMARY\n... )\n&gt;&gt;&gt; tr = PowerTransformer(\n...     user_specs=tr_specs,\n...     cooling_type=CoolerType.ONAF,\n...     internal_component_specs=comp_specs\n... )\n&gt;&gt;&gt; tr.component_capacities\n{'tap_changer': 1.0909090909090908, 'primary_bushings': None,\n'secondary_bushings': None, 'current_transformer': None}\n</code></pre>"},{"location":"api_reference/toolbox/","title":"Toolbox","text":""},{"location":"api_reference/toolbox/#toolbox","title":"Toolbox","text":"<p>This module contains a function that can be useful when working with the Transformer Thermal Model.a</p> <p>Modules:</p> Name Description <code>temp_sim_profile_tools</code> <p>Functions:</p> Name Description <code>create_temp_sim_profile_from_df</code> <p>Create an InputProfile from a dataframe.</p>"},{"location":"api_reference/toolbox/#transformer_thermal_model.toolbox.create_temp_sim_profile_from_df","title":"create_temp_sim_profile_from_df","text":"<pre><code>create_temp_sim_profile_from_df(\n    profile_as_dataframe: DataFrame,\n) -&gt; InputProfile\n</code></pre> <p>Create an InputProfile from a dataframe.</p> <p>This function is added as support for the transformer thermal model. It is handy if you have a dataframe with the temperature simulation profile and you want to use it in the transformer thermal model. Be mindful of the names of the columns, since these are directly called in the function.</p> <p>If you do not want to change column names, consider using the InputProfile.create method directly.</p> The dataframe should contain the following columns <ul> <li>timestamp: The timestamp of the profile.</li> <li>load: The load profile.</li> <li>ambient_temperature: The ambient temperature profile.</li> <li>top_oil_temperature: The top oil temperature profile (optional column).</li> </ul> Creating an input profile from a dataframe. <pre><code>&gt;&gt;&gt; import pandas as pd\n\n&gt;&gt;&gt; profile = pd.DataFrame(\n...     {\n...         \"timestamp\": pd.to_datetime([\"2021-01-01 00:00:00\", \"2021-01-01 01:00:00\", \"2021-01-01 02:00:00\"]),\n...         \"load\": [0, 0, 0],\n...         \"ambient_temperature\": [5, 5, 5],\n...     }\n... )\n&gt;&gt;&gt; input_profile = create_temp_sim_profile_from_df(profile)\n</code></pre> <p>Parameters:</p> Name Type Description Default <code>profile_as_dataframe</code> <code>DataFrame</code> <p>The dataframe containing the profile data.</p> required <p>Returns:</p> Name Type Description <code>InputProfile</code> <code>InputProfile</code> <p>The temperature simulation profile.</p> Source code in <code>transformer_thermal_model/toolbox/temp_sim_profile_tools.py</code> <pre><code>def create_temp_sim_profile_from_df(profile_as_dataframe: pd.DataFrame) -&gt; InputProfile:\n    \"\"\"Create an InputProfile from a dataframe.\n\n    This function is added as support for the transformer thermal model. It is\n    handy if you have a dataframe with the temperature simulation profile and\n    you want to use it in the transformer thermal model. Be mindful of the\n    names of the columns, since these are directly called in the function.\n\n    If you do not want to change column names, consider using the\n    [InputProfile.create][transformer_thermal_model.schemas.thermal_model.input_profile.InputProfile.create]\n    method directly.\n\n    The dataframe should contain the following columns:\n        - timestamp: The timestamp of the profile.\n        - load: The load profile.\n        - ambient_temperature: The ambient temperature profile.\n        - top_oil_temperature: The top oil temperature profile (optional column).\n\n\n    Example: Creating an input profile from a dataframe.\n        ```python\n        &gt;&gt;&gt; import pandas as pd\n\n        &gt;&gt;&gt; profile = pd.DataFrame(\n        ...     {\n        ...         \"timestamp\": pd.to_datetime([\"2021-01-01 00:00:00\", \"2021-01-01 01:00:00\", \"2021-01-01 02:00:00\"]),\n        ...         \"load\": [0, 0, 0],\n        ...         \"ambient_temperature\": [5, 5, 5],\n        ...     }\n        ... )\n        &gt;&gt;&gt; input_profile = create_temp_sim_profile_from_df(profile)\n\n        ```\n\n    Args:\n        profile_as_dataframe (pd.DataFrame): The dataframe containing the profile data.\n\n    Returns:\n        InputProfile: The temperature simulation profile.\n\n    \"\"\"\n    return InputProfile.create(\n        datetime_index=profile_as_dataframe[\"timestamp\"],\n        load_profile=profile_as_dataframe[\"load\"],\n        ambient_temperature_profile=profile_as_dataframe[\"ambient_temperature\"],\n        top_oil_temperature_profile=profile_as_dataframe.get(\"top_oil_temperature_profile\"),\n    )\n</code></pre>"},{"location":"api_reference/transformer/","title":"Transformer","text":""},{"location":"api_reference/transformer/#transformer","title":"Transformer","text":"<p>The Transformer is the main object that needs to be defined to work with our thermal model.</p>"},{"location":"api_reference/transformer/#transformer_thermal_model.transformer.Transformer","title":"Transformer","text":"<pre><code>Transformer(\n    cooling_type: CoolerType,\n    cooling_controller: CoolingSwitchController\n    | None = None,\n)\n</code></pre> <p>               Bases: <code>ABC</code></p> <p>Abstract class to define the transformer object.</p> <p>Depending on the type of transformer (either PowerTransformer or DistributionTransformer), the transformer attains certain default attributes. These attributes can be overwritten by using the TR_Specs dictionary.</p> <p>Attributes:</p> Name Type Description <code>cooling_type</code> <code>CoolerType</code> <p>The cooling type. Can be CoolerType.ONAN or CoolerType.ONAF.</p> <p>(TransformerSpecifications): The transformer specifications that you need to     provide to build the transformer. Any optional specifications not provided     will be taken from the default specifications.</p> <p>Parameters:</p> Name Type Description Default <code>cooling_type</code> <code>CoolerType</code> <p>The cooling type. Can be ONAN, ONAF.</p> required <code>cooling_controller</code> <code>CoolingSwitchController | None</code> <p>The cooling controller that handles the ONAN/ONAF switching logic.</p> <code>None</code> Source code in <code>transformer_thermal_model/transformer/base.py</code> <pre><code>def __init__(self, cooling_type: CoolerType, cooling_controller: CoolingSwitchController | None = None):\n    \"\"\"Initialize the Transformer object.\n\n    Args:\n        cooling_type (CoolerType): The cooling type. Can be ONAN, ONAF.\n        cooling_controller (CoolingSwitchController | None): The cooling controller that handles the ONAN/ONAF\n            switching logic.\n    \"\"\"\n    self.cooling_type: CoolerType = cooling_type\n    if cooling_type == CoolerType.ONAN and cooling_controller is not None:\n        raise ValueError(\"ONAF switch only works when the cooling type is ONAF.\")\n    self.cooling_controller = cooling_controller\n</code></pre>"},{"location":"api_reference/transformer/#transformer_thermal_model.transformer.Transformer.defaults","title":"defaults  <code>abstractmethod</code> <code>property</code>","text":"<pre><code>defaults: BaseDefaultTransformerSpecifications\n</code></pre> <p>The default transformer specifications.</p>"},{"location":"api_reference/transformer/#transformer_thermal_model.transformer.Transformer.set_ONAN_ONAF_first_timestamp","title":"set_ONAN_ONAF_first_timestamp","text":"<pre><code>set_ONAN_ONAF_first_timestamp(\n    init_top_oil_temp: float,\n) -&gt; None\n</code></pre> <p>Delegate initial cooling type logic to CoolingSwitchController.</p> Source code in <code>transformer_thermal_model/transformer/base.py</code> <pre><code>def set_ONAN_ONAF_first_timestamp(self, init_top_oil_temp: float) -&gt; None:\n    \"\"\"Delegate initial cooling type logic to CoolingSwitchController.\"\"\"\n    if self.cooling_controller:\n        self.specs = self.cooling_controller.determine_initial_specifications(\n            initial_top_oil_temperature=init_top_oil_temp\n        )\n</code></pre>"},{"location":"api_reference/transformer/#transformer_thermal_model.transformer.Transformer.set_cooling_switch_controller_specs","title":"set_cooling_switch_controller_specs","text":"<pre><code>set_cooling_switch_controller_specs(\n    top_oil_temp: float,\n    previous_top_oil_temp: float,\n    index: int,\n) -&gt; BaseTransformerSpecifications | None\n</code></pre> <p>Delegate ONAN/ONAF switch logic to CoolingSwitchController.</p> Source code in <code>transformer_thermal_model/transformer/base.py</code> <pre><code>def set_cooling_switch_controller_specs(\n    self, top_oil_temp: float, previous_top_oil_temp: float, index: int\n) -&gt; BaseTransformerSpecifications | None:\n    \"\"\"Delegate ONAN/ONAF switch logic to CoolingSwitchController.\"\"\"\n    if self.cooling_controller:\n        return self.cooling_controller.get_new_specs(top_oil_temp, previous_top_oil_temp, index)\n    return None\n</code></pre>"},{"location":"api_reference/transformer/#transformer_thermal_model.transformer.PowerTransformer","title":"PowerTransformer","text":"<pre><code>PowerTransformer(\n    user_specs: UserTransformerSpecifications,\n    cooling_type: CoolerType,\n    internal_component_specs: TransformerComponentSpecifications\n    | None = None,\n    cooling_switch_settings: CoolingSwitchSettings\n    | None = None,\n)\n</code></pre> <p>               Bases: <code>Transformer</code></p> <p>A power transformer.</p> <p>This class represents a power transformer. This class inherits from the Transformer class.</p> <p>Example: initialise a power transformer: <pre><code>&gt;&gt;&gt; from transformer_thermal_model.schemas import UserTransformerSpecifications\n&gt;&gt;&gt; from transformer_thermal_model.cooler import CoolerType\n&gt;&gt;&gt; from transformer_thermal_model.transformer import PowerTransformer\n\n&gt;&gt;&gt; user_specs = UserTransformerSpecifications(\n...     load_loss=1000,\n...     nom_load_sec_side=1500,\n...     no_load_loss=200,\n... )\n&gt;&gt;&gt; cooling_type = CoolerType.ONAN\n&gt;&gt;&gt; transformer = PowerTransformer(\n...     user_specs=user_specs,\n...     cooling_type=cooling_type\n... )\n</code></pre></p> <p>Parameters:</p> Name Type Description Default <code>user_specs</code> <code>UserTransformerSpecifications</code> <p>The transformer specifications that you need to provide to build the transformer. Any optional specifications not provided will be taken from the default specifications.</p> required <code>cooling_type</code> <code>CoolerType</code> <p>The cooling type. Can be ONAN or ONAF.</p> required <code>internal_component_specs</code> <code>TransformerComponentSpecifications</code> <p>The internal component specifications, which are used to calculate the limiting component. Defaults to None.</p> <code>None</code> <code>cooling_switch_settings</code> <code>CoolingSwitchSettings</code> <p>The ONAF switch settings. Only used when the cooling type is ONAF.</p> <code>None</code> Source code in <code>transformer_thermal_model/transformer/power.py</code> <pre><code>def __init__(\n    self,\n    user_specs: UserTransformerSpecifications,\n    cooling_type: CoolerType,\n    internal_component_specs: TransformerComponentSpecifications | None = None,\n    cooling_switch_settings: CoolingSwitchSettings | None = None,\n):\n    \"\"\"Initialize the transformer object.\n\n    Args:\n        user_specs (UserTransformerSpecifications): The transformer specifications that you need to\n            provide to build the transformer. Any optional specifications not provided will be taken from the\n            default specifications.\n        cooling_type (CoolerType): The cooling type. Can be ONAN or ONAF.\n        internal_component_specs (TransformerComponentSpecifications, optional): The internal component\n            specifications, which are used to calculate the limiting component. Defaults to None.\n        cooling_switch_settings (CoolingSwitchSettings, optional): The ONAF switch settings.\n            Only used when the cooling type is ONAF.\n\n    \"\"\"\n    logger.info(\"Creating a power transformer object.\")\n    logger.info(\"User transformer specifications: %s\", user_specs)\n    logger.info(\"Cooling type: %s\", cooling_type)\n\n    self.cooling_type: CoolerType = cooling_type\n\n    if internal_component_specs is not None:\n        logger.info(\"Internal component specifications: %s\", internal_component_specs)\n        warnings.warn(\n            \"PowerTransformerComponents was deprecated in version v0.4.0 and will be removed in v1.0.0.\",\n            category=DeprecationWarning,\n            stacklevel=3,\n        )\n        self.internal_component_specs = internal_component_specs\n\n    self.specs = TransformerSpecifications.create(self.defaults, user_specs)\n\n    # Use CoolingSwitchController if cooling_switch_settings is provided\n    self.cooling_controller = (\n        CoolingSwitchController(onaf_switch=cooling_switch_settings, specs=self.specs)\n        if cooling_switch_settings\n        else None\n    )\n\n    super().__init__(cooling_type=cooling_type, cooling_controller=self.cooling_controller)\n</code></pre>"},{"location":"api_reference/transformer/#transformer_thermal_model.transformer.PowerTransformer.defaults","title":"defaults  <code>property</code>","text":"<pre><code>defaults: DefaultTransformerSpecifications\n</code></pre> <p>The ClassVar for default TransformerSpecifications.</p> <p>If PowerTransformer is not initialised, uses the ONAF specifications.</p>"},{"location":"api_reference/transformer/#transformer_thermal_model.transformer.PowerTransformer.tap_changer_capacity_ratio","title":"tap_changer_capacity_ratio  <code>property</code>","text":"<pre><code>tap_changer_capacity_ratio: float | None\n</code></pre> <p>The ratio between the tap changer capacity and the nominal load of the transformer.</p>"},{"location":"api_reference/transformer/#transformer_thermal_model.transformer.PowerTransformer.primary_bushing_capacity_ratio","title":"primary_bushing_capacity_ratio  <code>property</code>","text":"<pre><code>primary_bushing_capacity_ratio: float | None\n</code></pre> <p>The ratio between the primary bushing capacity and the nominal load of the transformer.</p>"},{"location":"api_reference/transformer/#transformer_thermal_model.transformer.PowerTransformer.secondary_bushing_capacity_ratio","title":"secondary_bushing_capacity_ratio  <code>property</code>","text":"<pre><code>secondary_bushing_capacity_ratio: float | None\n</code></pre> <p>The ratio between the secondary bushing capacity and the nominal load of the transformer.</p>"},{"location":"api_reference/transformer/#transformer_thermal_model.transformer.PowerTransformer.int_cur_trans_capacity_ratio","title":"int_cur_trans_capacity_ratio  <code>property</code>","text":"<pre><code>int_cur_trans_capacity_ratio: float | None\n</code></pre> <p>The ratio between the internal current transformer capacity and the nominal load of the transformer.</p>"},{"location":"api_reference/transformer/#transformer_thermal_model.transformer.PowerTransformer.component_capacities","title":"component_capacities  <code>property</code>","text":"<pre><code>component_capacities: dict\n</code></pre> <p>Puts the limits of all transformer components in a single dictionary.</p>"},{"location":"api_reference/transformer/#transformer_thermal_model.transformer.DistributionTransformer","title":"DistributionTransformer","text":"<pre><code>DistributionTransformer(\n    user_specs: UserTransformerSpecifications,\n)\n</code></pre> <p>               Bases: <code>Transformer</code></p> <p>A distribution transformer.</p> <p>The DistributionTransformer class represents a distribution transformer. This class inherits from the Transformer class. This transformer can only be used with ONAN (Oil Natural Air Natural) cooling type.</p> Initialising a distribution transformer. <pre><code>&gt;&gt;&gt; from transformer_thermal_model.schemas import UserTransformerSpecifications\n&gt;&gt;&gt; from transformer_thermal_model.transformer import DistributionTransformer\n\n&gt;&gt;&gt; transformer_specifications = UserTransformerSpecifications(\n...     load_loss=5200,  # Transformer load loss [W]\n...     nom_load_sec_side=900,  # Transformer nominal current secondary side [A]\n...     no_load_loss=800,  # Transformer no-load loss [W]\n... )\n&gt;&gt;&gt; # note that no cooling type can be specified here, as this is a distribution transformer\n&gt;&gt;&gt; my_transformer = DistributionTransformer(user_specs=transformer_specifications)\n&gt;&gt;&gt; # the default specifications that will be used when not provided\n&gt;&gt;&gt; print(my_transformer.defaults)\ntime_const_oil=180.0 top_oil_temp_rise=60.0 oil_const_k11=1.0\nwinding_const_k21=1 winding_const_k22=2 oil_exp_x=0.8 winding_exp_y=1.6 end_temp_reduction=0.0\namb_temp_surcharge=10.0 time_const_windings=4.0 winding_oil_gradient=23.0 hot_spot_fac=1.2\n&gt;&gt;&gt; # the combination of the user specifications and the default specifications\n&gt;&gt;&gt; print(my_transformer.specs)\nno_load_loss=800.0 amb_temp_surcharge=10.0 time_const_oil=180.0 top_oil_temp_rise=60.0\noil_const_k11=1.0 winding_const_k21=1 winding_const_k22=2\noil_exp_x=0.8 winding_exp_y=1.6 end_temp_reduction=0.0 load_loss=5200.0\nnom_load_sec_side=900.0 winding_oil_gradient=23.0 time_const_windings=4.0 hot_spot_fac=1.2\n</code></pre> <p>Parameters:</p> Name Type Description Default <code>user_specs</code> <code>UserTransformerSpecifications</code> <p>The transformer specifications that you need to provide to build the transformer. Any optional specifications not provided will be taken from the default specifications.</p> required Source code in <code>transformer_thermal_model/transformer/distribution.py</code> <pre><code>def __init__(\n    self,\n    user_specs: UserTransformerSpecifications,\n):\n    \"\"\"Initialize the transformer object.\n\n    Args:\n        user_specs (UserTransformerSpecifications): The transformer specifications that you need to\n            provide to build the transformer. Any optional specifications not provided will be taken from the\n            default specifications.\n\n    \"\"\"\n    logger.info(\"Creating a distribution transformer object.\")\n    logger.info(\"User transformer specifications: %s\", user_specs)\n\n    super().__init__(\n        cooling_type=CoolerType.ONAN,\n        cooling_controller=None,\n    )\n    self.specs = TransformerSpecifications.create(self.defaults, user_specs)\n</code></pre>"},{"location":"api_reference/transformer/#transformer_thermal_model.transformer.DistributionTransformer.defaults","title":"defaults  <code>property</code>","text":"<pre><code>defaults: DefaultTransformerSpecifications\n</code></pre> <p>Return the default transformer specifications.</p>"},{"location":"api_reference/transformer/#transformer_thermal_model.transformer.ThreeWindingTransformer","title":"ThreeWindingTransformer","text":"<pre><code>ThreeWindingTransformer(\n    user_specs: UserThreeWindingTransformerSpecifications,\n    cooling_type: CoolerType,\n    cooling_switch_settings: ThreeWindingCoolingSwitchSettings\n    | None = None,\n)\n</code></pre> <p>               Bases: <code>Transformer</code></p> <p>A three-winding transformer.</p> <p>This class represents a Three winding transformer. This class inherits from the Transformer class.</p> <p>Example: initialise a three winding transformer: <pre><code>&gt;&gt;&gt; from transformer_thermal_model.schemas import UserThreeWindingTransformerSpecifications, WindingSpecifications\n&gt;&gt;&gt; from transformer_thermal_model.transformer import ThreeWindingTransformer\n\n&gt;&gt;&gt; user_specs = UserThreeWindingTransformerSpecifications(\n...     no_load_loss=20,\n...     amb_temp_surcharge=10,\n...     lv_winding=WindingSpecifications(nom_load=1000, winding_oil_gradient=20, hot_spot_fac=1.2,\n...                                      time_const_winding=1, nom_power=1000),\n...     mv_winding=WindingSpecifications(nom_load=1000, winding_oil_gradient=20, hot_spot_fac=1.2,\n...                                      time_const_winding=1, nom_power=1000),\n...     hv_winding=WindingSpecifications(nom_load=1000, winding_oil_gradient=20, hot_spot_fac=1.2,\n...                                      time_const_winding=1000000, nom_power=1000),\n...     load_loss_hv_lv=100,\n...     load_loss_hv_mv=100,\n...     load_loss_mv_lv=100,\n... )\n&gt;&gt;&gt; transformer = ThreeWindingTransformer(user_specs=user_specs, cooling_type=CoolerType.ONAN)\n&gt;&gt;&gt; # the combination of the user specifications and the default specifications\n&gt;&gt;&gt; print(transformer.specs)\nno_load_loss=20.0 amb_temp_surcharge=10.0 time_const_oil=210.0 top_oil_temp_rise=60.0\noil_const_k11=0.5 winding_const_k21=2 winding_const_k22=2 oil_exp_x=0.8 winding_exp_y=1.3\nend_temp_reduction=0.0\nlv_winding=WindingSpecifications(winding_oil_gradient=20.0, time_const_winding=1.0, hot_spot_fac=1.2,\n  nom_load=1000.0, nom_power=1000.0)\nmv_winding=WindingSpecifications(winding_oil_gradient=20.0, time_const_winding=1.0, hot_spot_fac=1.2,\n  nom_load=1000.0, nom_power=1000.0)\nhv_winding=WindingSpecifications(winding_oil_gradient=20.0, time_const_winding=1000000.0, hot_spot_fac=1.2,\n  nom_load=1000.0, nom_power=1000.0)\nload_loss_hv_lv=100.0 load_loss_hv_mv=100.0 load_loss_mv_lv=100.0 load_loss_total_user=None\n</code></pre></p> Source code in <code>transformer_thermal_model/transformer/threewinding.py</code> <pre><code>def __init__(\n    self,\n    user_specs: UserThreeWindingTransformerSpecifications,\n    cooling_type: CoolerType,\n    cooling_switch_settings: ThreeWindingCoolingSwitchSettings | None = None,\n):\n    \"\"\"Initialize the ThreeWindingTransformer object.\"\"\"\n    logger.debug(\"Initialized ThreeWindingTransformer with specifications: %s\", user_specs)\n\n    self.cooling_type: CoolerType = cooling_type\n    self.specs = ThreeWindingTransformerSpecifications.create(self.defaults, user_specs)\n\n    # Use CoolingSwitchController if onaf_switch is provided\n    self.cooling_controller = (\n        CoolingSwitchController(onaf_switch=cooling_switch_settings, specs=self.specs)\n        if cooling_switch_settings\n        else None\n    )\n\n    super().__init__(\n        cooling_type=cooling_type,\n        cooling_controller=self.cooling_controller,\n    )\n</code></pre>"},{"location":"api_reference/transformer/#transformer_thermal_model.transformer.ThreeWindingTransformer.defaults","title":"defaults  <code>property</code>","text":"<pre><code>defaults: ThreeWindingTransformerDefaultSpecifications\n</code></pre> <p>The ClassVar for default TransformerSpecifications.</p>"},{"location":"examples/example_ONAN_ONAF_switch/","title":"Switch between ONAN and ONAF","text":"In\u00a0[12]: Copied! <pre>import matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\n\nfrom transformer_thermal_model.cooler import CoolerType\nfrom transformer_thermal_model.model import Model\nfrom transformer_thermal_model.schemas import (\n    InputProfile,\n    ThreeWindingInputProfile,\n    UserThreeWindingTransformerSpecifications,\n    UserTransformerSpecifications,\n    WindingSpecifications,\n)\nfrom transformer_thermal_model.schemas.thermal_model import CoolingSwitchConfig, CoolingSwitchSettings, ONANParameters\nfrom transformer_thermal_model.transformer import PowerTransformer, ThreeWindingTransformer\n</pre> import matplotlib.pyplot as plt import numpy as np import pandas as pd  from transformer_thermal_model.cooler import CoolerType from transformer_thermal_model.model import Model from transformer_thermal_model.schemas import (     InputProfile,     ThreeWindingInputProfile,     UserThreeWindingTransformerSpecifications,     UserTransformerSpecifications,     WindingSpecifications, ) from transformer_thermal_model.schemas.thermal_model import CoolingSwitchConfig, CoolingSwitchSettings, ONANParameters from transformer_thermal_model.transformer import PowerTransformer, ThreeWindingTransformer In\u00a0[13]: Copied! <pre>top_oil_label = \"Top-oil temperature\"\nhot_spot_label = \"Hot-spot temperature\"\nambient_temp_label = \"Ambient temperature\"\ntemperature_label = \"Temperature [\u00b0C]\"\nfan_switch_label = \"Fan switch\"\n</pre> top_oil_label = \"Top-oil temperature\" hot_spot_label = \"Hot-spot temperature\" ambient_temp_label = \"Ambient temperature\" temperature_label = \"Temperature [\u00b0C]\" fan_switch_label = \"Fan switch\" <p>We create an input profile similar to a regular simulation:</p> In\u00a0[14]: Copied! <pre>datetime_index = [pd.to_datetime(\"2025-01-01 00:00:00\") + pd.Timedelta(minutes=15 * i) for i in np.arange(0, 288)]\n\nload_series = pd.Series(data=np.sin(np.arange(0, 288) * 900 * 2 * np.pi * 1 / 43200) * 500 + 1200, index=datetime_index)\nambient_series = pd.Series(data=20, index=datetime_index)\n\n# Create an input object with the profiles\nmy_profile_input = InputProfile.create(\n    datetime_index=datetime_index, load_profile=load_series, ambient_temperature_profile=ambient_series\n)\n</pre> datetime_index = [pd.to_datetime(\"2025-01-01 00:00:00\") + pd.Timedelta(minutes=15 * i) for i in np.arange(0, 288)]  load_series = pd.Series(data=np.sin(np.arange(0, 288) * 900 * 2 * np.pi * 1 / 43200) * 500 + 1200, index=datetime_index) ambient_series = pd.Series(data=20, index=datetime_index)  # Create an input object with the profiles my_profile_input = InputProfile.create(     datetime_index=datetime_index, load_profile=load_series, ambient_temperature_profile=ambient_series ) In\u00a0[15]: Copied! <pre>my_transformer_specifications = UserTransformerSpecifications(\n    load_loss=160000,  # Transformer load loss [W]\n    nom_load_sec_side=3000,  # Transformer nominal current secondary side [A]\n    no_load_loss=70000,  # Transformer no-load loss [W]\n    amb_temp_surcharge=10,  # Ambient temperature surcharge [K]\n    time_const_oil=150,  # Time constant oil [min]\n    time_const_windings=7,  # Time constant windings [min]\n    top_oil_temp_rise=50.5,  # Top-oil temperature rise [K]\n    winding_oil_gradient=23,  # Winding oil gradient (worst case) [K]\n    end_temp_reduction=0,  # Lowering of the end temperature with respect to the current specification [K]\n    hot_spot_fac=1.2,  # Hot-spot factor [-]\n    oil_const_k11=0.5,  # Oil constant k11 [-]\n    winding_const_k21=2.0,  # Winding constant k21 [-]\n    winding_const_k22=2.0,  # Winding constant k22 [-]\n    oil_exp_x=0.8,  # Oil exponent x [-]\n    winding_exp_y=1.3,  # Winding exponent x [-]\n)\n\nonan_specs = ONANParameters(\n    top_oil_temp_rise=50.5,\n    time_const_oil=150,\n    time_const_windings=7,\n    load_loss=160000,\n    nom_load_sec_side=1600,  # Lower nominal current for ONAN mode\n    winding_oil_gradient=23,\n    hot_spot_fac=1.2,\n)\n\n# Create a fan schedule where the fans are off for the first half of the time and on for the second half\nis_on = [False] * len(datetime_index)\nfor i in range(len(is_on) // 2, len(is_on)):\n    is_on[i] = True\n\nonaf_switch = CoolingSwitchSettings(fan_on=np.array(is_on), onan_parameters=onan_specs)\n</pre> my_transformer_specifications = UserTransformerSpecifications(     load_loss=160000,  # Transformer load loss [W]     nom_load_sec_side=3000,  # Transformer nominal current secondary side [A]     no_load_loss=70000,  # Transformer no-load loss [W]     amb_temp_surcharge=10,  # Ambient temperature surcharge [K]     time_const_oil=150,  # Time constant oil [min]     time_const_windings=7,  # Time constant windings [min]     top_oil_temp_rise=50.5,  # Top-oil temperature rise [K]     winding_oil_gradient=23,  # Winding oil gradient (worst case) [K]     end_temp_reduction=0,  # Lowering of the end temperature with respect to the current specification [K]     hot_spot_fac=1.2,  # Hot-spot factor [-]     oil_const_k11=0.5,  # Oil constant k11 [-]     winding_const_k21=2.0,  # Winding constant k21 [-]     winding_const_k22=2.0,  # Winding constant k22 [-]     oil_exp_x=0.8,  # Oil exponent x [-]     winding_exp_y=1.3,  # Winding exponent x [-] )  onan_specs = ONANParameters(     top_oil_temp_rise=50.5,     time_const_oil=150,     time_const_windings=7,     load_loss=160000,     nom_load_sec_side=1600,  # Lower nominal current for ONAN mode     winding_oil_gradient=23,     hot_spot_fac=1.2, )  # Create a fan schedule where the fans are off for the first half of the time and on for the second half is_on = [False] * len(datetime_index) for i in range(len(is_on) // 2, len(is_on)):     is_on[i] = True  onaf_switch = CoolingSwitchSettings(fan_on=np.array(is_on), onan_parameters=onan_specs) <p>We then define a PowerTransformer with the additional parameter <code>onaf_switch</code>:</p> In\u00a0[16]: Copied! <pre>my_transformer = PowerTransformer(\n    user_specs=my_transformer_specifications, cooling_type=CoolerType.ONAF, cooling_switch_settings=onaf_switch\n)\nmy_model = Model(temperature_profile=my_profile_input, transformer=my_transformer)\nresults = my_model.run()\n</pre> my_transformer = PowerTransformer(     user_specs=my_transformer_specifications, cooling_type=CoolerType.ONAF, cooling_switch_settings=onaf_switch ) my_model = Model(temperature_profile=my_profile_input, transformer=my_transformer) results = my_model.run() <p>You can clearly see that both the hotspot and topoil temperature drop when the fans turn on:</p> In\u00a0[17]: Copied! <pre>start_time = datetime_index[0] + pd.Timedelta(my_transformer.specs.time_const_oil * 5, \"m\")\nfig = plt.figure()\nax = results.top_oil_temp_profile.loc[start_time::].plot(label=top_oil_label, color=\"green\")\nresults.hot_spot_temp_profile.loc[start_time::].plot(label=hot_spot_label, color=\"blue\")\nambient_series.loc[start_time::].plot(label=ambient_temp_label, color=\"red\")\nax.set_ylabel(temperature_label)\nax.hlines(120, datetime_index[0], datetime_index[-1], linestyles=\"dashed\", label=\"Hot-spot limit\", color=\"blue\")\nax.hlines(105, datetime_index[0], datetime_index[-1], linestyles=\"dashed\", label=\"Top-oil limit\", color=\"green\")\nax.legend(loc=\"lower left\")\nplt.show()\n</pre> start_time = datetime_index[0] + pd.Timedelta(my_transformer.specs.time_const_oil * 5, \"m\") fig = plt.figure() ax = results.top_oil_temp_profile.loc[start_time::].plot(label=top_oil_label, color=\"green\") results.hot_spot_temp_profile.loc[start_time::].plot(label=hot_spot_label, color=\"blue\") ambient_series.loc[start_time::].plot(label=ambient_temp_label, color=\"red\") ax.set_ylabel(temperature_label) ax.hlines(120, datetime_index[0], datetime_index[-1], linestyles=\"dashed\", label=\"Hot-spot limit\", color=\"blue\") ax.hlines(105, datetime_index[0], datetime_index[-1], linestyles=\"dashed\", label=\"Top-oil limit\", color=\"green\") ax.legend(loc=\"lower left\") plt.show() In\u00a0[18]: Copied! <pre>onaf_switch = CoolingSwitchSettings(\n    temperature_threshold=CoolingSwitchConfig(activation_temp=75, deactivation_temp=65),\n    onan_parameters=onan_specs,\n)\nmy_transformer = PowerTransformer(\n    user_specs=my_transformer_specifications, cooling_type=CoolerType.ONAF, cooling_switch_settings=onaf_switch\n)\nmy_model = Model(temperature_profile=my_profile_input, transformer=my_transformer)\nresults = my_model.run()\n</pre> onaf_switch = CoolingSwitchSettings(     temperature_threshold=CoolingSwitchConfig(activation_temp=75, deactivation_temp=65),     onan_parameters=onan_specs, ) my_transformer = PowerTransformer(     user_specs=my_transformer_specifications, cooling_type=CoolerType.ONAF, cooling_switch_settings=onaf_switch ) my_model = Model(temperature_profile=my_profile_input, transformer=my_transformer) results = my_model.run() <p>In the plots we can see that, as soon as the top-oil temperature reaches 75 degrees, the fans turn on and the temperature drops. Note that at a top-oil temperature of 65, the fans turn off again, and the temperature rises again.</p> In\u00a0[19]: Copied! <pre>start_time = datetime_index[0] + pd.Timedelta(my_transformer.specs.time_const_oil * 5, \"m\")\nfig = plt.figure()\nax = results.top_oil_temp_profile.loc[start_time::].plot(label=top_oil_label, color=\"green\")\nresults.hot_spot_temp_profile.loc[start_time::].plot(label=\"Hot-spot temperature\", color=\"blue\")\nambient_series.loc[start_time::].plot(label=\"Ambient temperature\", color=\"red\")\nax.set_ylabel(\"Temperature [C]\")\nax.hlines(120, datetime_index[0], datetime_index[-1], linestyles=\"dashed\", label=\"Hot-spot limit\", color=\"blue\")\nax.hlines(105, datetime_index[0], datetime_index[-1], linestyles=\"dashed\", label=\"Top-oil limit\", color=\"green\")\nax.legend(loc=\"lower left\")\nplt.show()\n</pre> start_time = datetime_index[0] + pd.Timedelta(my_transformer.specs.time_const_oil * 5, \"m\") fig = plt.figure() ax = results.top_oil_temp_profile.loc[start_time::].plot(label=top_oil_label, color=\"green\") results.hot_spot_temp_profile.loc[start_time::].plot(label=\"Hot-spot temperature\", color=\"blue\") ambient_series.loc[start_time::].plot(label=\"Ambient temperature\", color=\"red\") ax.set_ylabel(\"Temperature [C]\") ax.hlines(120, datetime_index[0], datetime_index[-1], linestyles=\"dashed\", label=\"Hot-spot limit\", color=\"blue\") ax.hlines(105, datetime_index[0], datetime_index[-1], linestyles=\"dashed\", label=\"Top-oil limit\", color=\"green\") ax.legend(loc=\"lower left\") plt.show() <p>Create the load and the specs the same way as for a normal ONAF transformer:</p> In\u00a0[20]: Copied! <pre># Define the time range for your simulation\ndatetime_index = [pd.to_datetime(\"2025-07-01 00:00:00\") + pd.Timedelta(minutes=15 * i) for i in np.arange(0, 288)]\n\nload_series_high = pd.Series(\n    data=np.sin(np.arange(0, 288) * 900 * 2 * np.pi * 1 / 43200) * 500 + 500, index=datetime_index\n)\nload_series_middle = pd.Series(\n    data=np.sin(np.arange(0, 288) * 900 * 2 * np.pi * 1 / 43200) * 500 + 500, index=datetime_index\n)\nload_series_low = pd.Series(\n    data=np.sin(np.arange(0, 288) * 900 * 2 * np.pi * 1 / 43200) * 500 + 500, index=datetime_index\n)\n\nambient_series = pd.Series(data=20, index=datetime_index)\n\n# Create the input profile for the three-winding transformer\nprofile_input = ThreeWindingInputProfile.create(\n    datetime_index=datetime_index,\n    ambient_temperature_profile=ambient_series,\n    load_profile_high_voltage_side=load_series_high,\n    load_profile_middle_voltage_side=load_series_middle,\n    load_profile_low_voltage_side=load_series_low,\n)\n\n# Define the transformer specifications for each winding\nuser_specs = UserThreeWindingTransformerSpecifications(\n    no_load_loss=20,\n    amb_temp_surcharge=10,\n    lv_winding=WindingSpecifications(\n        nom_load=1000, winding_oil_gradient=20, hot_spot_fac=1.2, time_const_winding=1, nom_power=1000\n    ),\n    mv_winding=WindingSpecifications(\n        nom_load=1000, winding_oil_gradient=20, hot_spot_fac=1.2, time_const_winding=1, nom_power=1000\n    ),\n    hv_winding=WindingSpecifications(\n        nom_load=2000, winding_oil_gradient=20, hot_spot_fac=1.2, time_const_winding=1, nom_power=2000\n    ),\n    load_loss_hv_lv=100,\n    load_loss_hv_mv=100,\n    load_loss_mv_lv=100,\n)\n</pre> # Define the time range for your simulation datetime_index = [pd.to_datetime(\"2025-07-01 00:00:00\") + pd.Timedelta(minutes=15 * i) for i in np.arange(0, 288)]  load_series_high = pd.Series(     data=np.sin(np.arange(0, 288) * 900 * 2 * np.pi * 1 / 43200) * 500 + 500, index=datetime_index ) load_series_middle = pd.Series(     data=np.sin(np.arange(0, 288) * 900 * 2 * np.pi * 1 / 43200) * 500 + 500, index=datetime_index ) load_series_low = pd.Series(     data=np.sin(np.arange(0, 288) * 900 * 2 * np.pi * 1 / 43200) * 500 + 500, index=datetime_index )  ambient_series = pd.Series(data=20, index=datetime_index)  # Create the input profile for the three-winding transformer profile_input = ThreeWindingInputProfile.create(     datetime_index=datetime_index,     ambient_temperature_profile=ambient_series,     load_profile_high_voltage_side=load_series_high,     load_profile_middle_voltage_side=load_series_middle,     load_profile_low_voltage_side=load_series_low, )  # Define the transformer specifications for each winding user_specs = UserThreeWindingTransformerSpecifications(     no_load_loss=20,     amb_temp_surcharge=10,     lv_winding=WindingSpecifications(         nom_load=1000, winding_oil_gradient=20, hot_spot_fac=1.2, time_const_winding=1, nom_power=1000     ),     mv_winding=WindingSpecifications(         nom_load=1000, winding_oil_gradient=20, hot_spot_fac=1.2, time_const_winding=1, nom_power=1000     ),     hv_winding=WindingSpecifications(         nom_load=2000, winding_oil_gradient=20, hot_spot_fac=1.2, time_const_winding=1, nom_power=2000     ),     load_loss_hv_lv=100,     load_loss_hv_mv=100,     load_loss_mv_lv=100, ) In\u00a0[21]: Copied! <pre>from transformer_thermal_model.schemas.thermal_model.onaf_switch import (\n    ThreeWindingCoolingSwitchSettings,\n    ThreeWindingONANParameters,\n)\n\nonan_parameters = ThreeWindingONANParameters(\n    lv_winding=WindingSpecifications(\n        time_const_winding=1, nom_load=900, winding_oil_gradient=20, hot_spot_fac=1.2, nom_power=1000\n    ),\n    mv_winding=WindingSpecifications(\n        time_const_winding=1, nom_load=900, winding_oil_gradient=20, hot_spot_fac=1.2, nom_power=1000\n    ),\n    hv_winding=WindingSpecifications(\n        time_const_winding=1, nom_load=1800, winding_oil_gradient=20, hot_spot_fac=1.2, nom_power=2000\n    ),\n    top_oil_temp_rise=60,\n    time_const_oil=150,\n    load_loss_mv_lv=100,\n    load_loss_hv_lv=100,\n    load_loss_hv_mv=100,\n)\n\n# split in three parts: off, on, off\npoint_1 = 70\npoint_2 = 70\nis_on = np.array(\n    [False] * point_1 + [True] * (len(profile_input.datetime_index) - point_1 - point_2) + [False] * point_2\n)\n\nonaf_switch = ThreeWindingCoolingSwitchSettings(\n    fan_on=is_on, temperature_threshold=None, onan_parameters=onan_parameters\n)\ntransformer = ThreeWindingTransformer(\n    user_specs=user_specs, cooling_type=CoolerType.ONAF, cooling_switch_settings=onaf_switch\n)\nmodel = Model(transformer=transformer, temperature_profile=profile_input)\nresults = model.run()\n\nfull_onaf_transformer = ThreeWindingTransformer(user_specs=user_specs, cooling_type=CoolerType.ONAF)\nfull_onaf_model = Model(transformer=full_onaf_transformer, temperature_profile=profile_input)\nfull_onaf_results = full_onaf_model.run()\n</pre> from transformer_thermal_model.schemas.thermal_model.onaf_switch import (     ThreeWindingCoolingSwitchSettings,     ThreeWindingONANParameters, )  onan_parameters = ThreeWindingONANParameters(     lv_winding=WindingSpecifications(         time_const_winding=1, nom_load=900, winding_oil_gradient=20, hot_spot_fac=1.2, nom_power=1000     ),     mv_winding=WindingSpecifications(         time_const_winding=1, nom_load=900, winding_oil_gradient=20, hot_spot_fac=1.2, nom_power=1000     ),     hv_winding=WindingSpecifications(         time_const_winding=1, nom_load=1800, winding_oil_gradient=20, hot_spot_fac=1.2, nom_power=2000     ),     top_oil_temp_rise=60,     time_const_oil=150,     load_loss_mv_lv=100,     load_loss_hv_lv=100,     load_loss_hv_mv=100, )  # split in three parts: off, on, off point_1 = 70 point_2 = 70 is_on = np.array(     [False] * point_1 + [True] * (len(profile_input.datetime_index) - point_1 - point_2) + [False] * point_2 )  onaf_switch = ThreeWindingCoolingSwitchSettings(     fan_on=is_on, temperature_threshold=None, onan_parameters=onan_parameters ) transformer = ThreeWindingTransformer(     user_specs=user_specs, cooling_type=CoolerType.ONAF, cooling_switch_settings=onaf_switch ) model = Model(transformer=transformer, temperature_profile=profile_input) results = model.run()  full_onaf_transformer = ThreeWindingTransformer(user_specs=user_specs, cooling_type=CoolerType.ONAF) full_onaf_model = Model(transformer=full_onaf_transformer, temperature_profile=profile_input) full_onaf_results = full_onaf_model.run() In\u00a0[22]: Copied! <pre># Plot the top-oil temperature profile\nfig1, ax1 = plt.subplots()\nresults.top_oil_temp_profile.plot(ax=ax1, label=top_oil_label)\nfull_onaf_results.top_oil_temp_profile.plot(ax=ax1, label=\"Full ONAF top-oil temperature\", linestyle=\"dashed\")\nax1.axvline(profile_input.datetime_index[point_1], color=\"black\", linestyle=\"dotted\", label=fan_switch_label)\nax1.axvline(\n    profile_input.datetime_index[len(profile_input.datetime_index) - point_2],\n    color=\"black\",\n    linestyle=\"dotted\",\n    label=fan_switch_label,\n)\nax1.set_title(top_oil_label)\nax1.set_ylabel(temperature_label)\nax1.legend()\nplt.show()\n\n# Plot the hot-spot temperature profiles\nfig2, ax2 = plt.subplots()\nresults.hot_spot_temp_profile.plot(ax=ax2)\nax2.axvline(profile_input.datetime_index[point_1], color=\"black\", linestyle=\"dotted\", label=fan_switch_label)\nax2.axvline(\n    profile_input.datetime_index[len(profile_input.datetime_index) - point_2],\n    color=\"black\",\n    linestyle=\"dotted\",\n    label=fan_switch_label,\n)\nax2.set_title(\"Hot-spot Temperatures\")\nax2.set_ylabel(temperature_label)\nax2.legend()\nplt.show()\n</pre> # Plot the top-oil temperature profile fig1, ax1 = plt.subplots() results.top_oil_temp_profile.plot(ax=ax1, label=top_oil_label) full_onaf_results.top_oil_temp_profile.plot(ax=ax1, label=\"Full ONAF top-oil temperature\", linestyle=\"dashed\") ax1.axvline(profile_input.datetime_index[point_1], color=\"black\", linestyle=\"dotted\", label=fan_switch_label) ax1.axvline(     profile_input.datetime_index[len(profile_input.datetime_index) - point_2],     color=\"black\",     linestyle=\"dotted\",     label=fan_switch_label, ) ax1.set_title(top_oil_label) ax1.set_ylabel(temperature_label) ax1.legend() plt.show()  # Plot the hot-spot temperature profiles fig2, ax2 = plt.subplots() results.hot_spot_temp_profile.plot(ax=ax2) ax2.axvline(profile_input.datetime_index[point_1], color=\"black\", linestyle=\"dotted\", label=fan_switch_label) ax2.axvline(     profile_input.datetime_index[len(profile_input.datetime_index) - point_2],     color=\"black\",     linestyle=\"dotted\",     label=fan_switch_label, ) ax2.set_title(\"Hot-spot Temperatures\") ax2.set_ylabel(temperature_label) ax2.legend() plt.show() In\u00a0[23]: Copied! <pre># Create ONAF switch configuration with temperature thresholds\n# Fans activate when top-oil temperature reaches 60\u00b0C, deactivate at 50\u00b0C\nonaf_switch = ThreeWindingCoolingSwitchSettings(\n    temperature_threshold=CoolingSwitchConfig(activation_temp=60, deactivation_temp=50), onan_parameters=onan_parameters\n)\n\n# Create transformer with automatic ONAN/ONAF switching capability\n# Starts in ONAF mode but will switch to ONAN if temperature drops below threshold\ntransformer = ThreeWindingTransformer(\n    user_specs=user_specs, cooling_type=CoolerType.ONAF, cooling_switch_settings=onaf_switch\n)\n\n# Run thermal model with automatic cooling mode switching\nmodel = Model(transformer=transformer, temperature_profile=profile_input)\nresults = model.run()\n\n# Create comparison transformer that stays in ONAF mode throughout the simulation\n# This shows the difference between automatic switching and constant ONAF operation\nfull_onaf_transformer = ThreeWindingTransformer(user_specs=user_specs, cooling_type=CoolerType.ONAF)\nfull_onaf_model = Model(transformer=full_onaf_transformer, temperature_profile=profile_input)\nfull_onaf_results = full_onaf_model.run()\n</pre> # Create ONAF switch configuration with temperature thresholds # Fans activate when top-oil temperature reaches 60\u00b0C, deactivate at 50\u00b0C onaf_switch = ThreeWindingCoolingSwitchSettings(     temperature_threshold=CoolingSwitchConfig(activation_temp=60, deactivation_temp=50), onan_parameters=onan_parameters )  # Create transformer with automatic ONAN/ONAF switching capability # Starts in ONAF mode but will switch to ONAN if temperature drops below threshold transformer = ThreeWindingTransformer(     user_specs=user_specs, cooling_type=CoolerType.ONAF, cooling_switch_settings=onaf_switch )  # Run thermal model with automatic cooling mode switching model = Model(transformer=transformer, temperature_profile=profile_input) results = model.run()  # Create comparison transformer that stays in ONAF mode throughout the simulation # This shows the difference between automatic switching and constant ONAF operation full_onaf_transformer = ThreeWindingTransformer(user_specs=user_specs, cooling_type=CoolerType.ONAF) full_onaf_model = Model(transformer=full_onaf_transformer, temperature_profile=profile_input) full_onaf_results = full_onaf_model.run() In\u00a0[24]: Copied! <pre># Plot comparison of top-oil temperatures: automatic switching vs. constant ONAF\nfig1, ax1 = plt.subplots()\n# Transformer with automatic ONAN/ONAF switching based on temperature thresholds\nresults.top_oil_temp_profile.plot(ax=ax1, label=top_oil_label)\n# Reference transformer that stays in ONAF mode throughout simulation\nfull_onaf_results.top_oil_temp_profile.plot(ax=ax1, label=\"Full ONAF top-oil temperature\", linestyle=\"dashed\")\nax1.set_title(top_oil_label)\nax1.set_ylabel(temperature_label)\nax1.legend()\nplt.show()\n\n# Plot hot-spot temperature profiles for all three windings\n# Shows how each winding responds to the automatic cooling mode switching\nfig2, ax2 = plt.subplots()\nresults.hot_spot_temp_profile.plot(ax=ax2)\nax2.set_title(hot_spot_label)\nax2.set_ylabel(temperature_label)\nax2.legend()\nplt.show()\n</pre> # Plot comparison of top-oil temperatures: automatic switching vs. constant ONAF fig1, ax1 = plt.subplots() # Transformer with automatic ONAN/ONAF switching based on temperature thresholds results.top_oil_temp_profile.plot(ax=ax1, label=top_oil_label) # Reference transformer that stays in ONAF mode throughout simulation full_onaf_results.top_oil_temp_profile.plot(ax=ax1, label=\"Full ONAF top-oil temperature\", linestyle=\"dashed\") ax1.set_title(top_oil_label) ax1.set_ylabel(temperature_label) ax1.legend() plt.show()  # Plot hot-spot temperature profiles for all three windings # Shows how each winding responds to the automatic cooling mode switching fig2, ax2 = plt.subplots() results.hot_spot_temp_profile.plot(ax=ax2) ax2.set_title(hot_spot_label) ax2.set_ylabel(temperature_label) ax2.legend() plt.show()"},{"location":"examples/example_ONAN_ONAF_switch/#switch-between-onan-and-onaf","title":"Switch between ONAN and ONAF\u00b6","text":"<p>In this example we show how to use a conditional ONAF transformer that switches between ONAN and ONAF.</p> <p>Warning: The ONAN/ONAF switch feature has been validated only against a single measurement dataset. When running the model, temperatures near the activation or deactivation threshold may cause oscillating switching between cooling modes. This behavior does not necessarily reflect real transformer operation. Therefore, it is advised to not use the results on a timestep basis.</p> <p>Warning: The ONAN/ONAF switch feature has been validated only against a single measurement dataset. When running the model, temperatures near the activation or deactivation threshold may cause oscillating switching between cooling modes. This behavior does not necessarily reflect real transformer operation. Therefore, it is advised to not use the results on a timestep basis.</p>"},{"location":"examples/example_ONAN_ONAF_switch/#create-the-additional-coolingswitchsettings-object","title":"Create the additional CoolingSwitchSettings object\u00b6","text":"<p>To create a transformer with configurable fans, we create a 'normal' ONAF transformer, but with some extra input parameters. There are two ways the ONAN-ONAF switch can be configured:</p> <pre><code>- With an historical profile\n- With a threhshold temperature, at witch the fans turn on and off.</code></pre>"},{"location":"examples/example_ONAN_ONAF_switch/#case-1-with-an-historical-fan-profile","title":"Case 1: With an historical fan profile\u00b6","text":"<p>TO make a transformer with an ONAN/ONAF configuration we create the parameter class \"CoolingSwitchSettings\", this has two parameters:</p> <ul> <li>onan_specs: ONANParameters. Her we pass along all ONAN paramters that are different when the fans are turned off.</li> <li>fan_on: List[bool]. A list with booleans that indicate whether the fans are ON(ONAF) or off(ONAN).</li> </ul>"},{"location":"examples/example_ONAN_ONAF_switch/#case-2-with-a-threshold-temperature","title":"Case 2: With a threshold temperature\u00b6","text":"<p>To use a temperature threshold to turn on and off the fans we use the same <code>CoolingSwitchSettings</code> class, but instead off a fan_on list, we provide a temperature_threshold, which should be contructed with the <code>CoolingSwitchConfig</code> class:</p>"},{"location":"examples/example_ONAN_ONAF_switch/#onan-onaf-for-a-three-winding-transformer","title":"ONAN ONAF for a three winding transformer\u00b6","text":"<p>For three winding transformers, the principle is the same, but since the onan parameters are different, we have to use different schemas.</p>"},{"location":"examples/example_ONAN_ONAF_switch/#three-winding-transformers-with-an-onanonaf-switch-that-uses-threshold-temperature","title":"Three winding transformers with an ONAN/ONAF switch that uses threshold temperature:\u00b6","text":""},{"location":"examples/hot-spot_calibration/","title":"Hot-spot factor calibration","text":"In\u00a0[\u00a0]: Copied! <pre>import pandas as pd\n\nfrom transformer_thermal_model.cooler import CoolerType\nfrom transformer_thermal_model.model import Model\nfrom transformer_thermal_model.schemas import InputProfile, UserTransformerSpecifications\nfrom transformer_thermal_model.transformer import PowerTransformer\n\n# In this example the model is used to calculate the transformer temperature based on a load and ambient\n# profile with a period of one week. Any duration can be chosen preferably with timestamps with an interval of\n# 15 minute or lower. Larger timesteps will result in incorrect results but it *is* possible to calculate with them.\none_week = 4 * 24 * 7\ndatetime_index = pd.date_range(\"2020-01-01\", periods=one_week, freq=\"15min\")\n\n# For the load (in A) and ambient temperature (in C) arbitrary constants profiles are chosen.\n# It is also possible to use a realistic profile.\nnominal_load = 100\nload_points = pd.Series([nominal_load] * one_week, index=datetime_index)\nambient_temp = 21\ntemperature_points = pd.Series([ambient_temp] * one_week, index=datetime_index)\n\n# Create an input object with the profiles\nprofile_input = InputProfile.create(\n    datetime_index=datetime_index, load_profile=load_points, ambient_temperature_profile=temperature_points\n)\n\n# Initialise a power transformer with cooling type ONAF and, besides the mandatory user specifications, default values.\ntr_specs = UserTransformerSpecifications(\n    load_loss=1000,  # Transformer load loss [W]\n    nom_load_sec_side=1500,  # Transformer nominal current secondary side [A]\n    no_load_loss=200,  # Transformer no-load loss [W]\n    amb_temp_surcharge=20,  # Ambient temperature surcharge [K]\n)\ntransformer = PowerTransformer(user_specs=tr_specs, cooling_type=CoolerType.ONAF)\n</pre> import pandas as pd  from transformer_thermal_model.cooler import CoolerType from transformer_thermal_model.model import Model from transformer_thermal_model.schemas import InputProfile, UserTransformerSpecifications from transformer_thermal_model.transformer import PowerTransformer  # In this example the model is used to calculate the transformer temperature based on a load and ambient # profile with a period of one week. Any duration can be chosen preferably with timestamps with an interval of # 15 minute or lower. Larger timesteps will result in incorrect results but it *is* possible to calculate with them. one_week = 4 * 24 * 7 datetime_index = pd.date_range(\"2020-01-01\", periods=one_week, freq=\"15min\")  # For the load (in A) and ambient temperature (in C) arbitrary constants profiles are chosen. # It is also possible to use a realistic profile. nominal_load = 100 load_points = pd.Series([nominal_load] * one_week, index=datetime_index) ambient_temp = 21 temperature_points = pd.Series([ambient_temp] * one_week, index=datetime_index)  # Create an input object with the profiles profile_input = InputProfile.create(     datetime_index=datetime_index, load_profile=load_points, ambient_temperature_profile=temperature_points )  # Initialise a power transformer with cooling type ONAF and, besides the mandatory user specifications, default values. tr_specs = UserTransformerSpecifications(     load_loss=1000,  # Transformer load loss [W]     nom_load_sec_side=1500,  # Transformer nominal current secondary side [A]     no_load_loss=200,  # Transformer no-load loss [W]     amb_temp_surcharge=20,  # Ambient temperature surcharge [K] ) transformer = PowerTransformer(user_specs=tr_specs, cooling_type=CoolerType.ONAF) In\u00a0[2]: Copied! <pre>from transformer_thermal_model.cooler import CoolerType\nfrom transformer_thermal_model.hot_spot_calibration import calibrate_hotspot_factor\nfrom transformer_thermal_model.schemas import UserTransformerSpecifications\nfrom transformer_thermal_model.transformer import PowerTransformer\n\ntr_specs = UserTransformerSpecifications(\n    load_loss=1000,  # Transformer load loss [W]\n    nom_load_sec_side=1500,  # Transformer nominal current secondary side [A]\n    no_load_loss=200,  # Transformer no-load loss [W]\n    amb_temp_surcharge=20,  # Ambient temperature surcharge [K]\n)\nuncalibrated_transformer = PowerTransformer(user_specs=tr_specs, cooling_type=CoolerType.ONAF)\ncalibrated_trafo = calibrate_hotspot_factor(\n    uncalibrated_transformer=uncalibrated_transformer,\n    ambient_temp=20.0,\n    hot_spot_limit=98,  # in most cases a hot-spot temperature limit of 98 can be used\n    hot_spot_factor_min=1.1,\n    hot_spot_factor_max=1.3,\n)\n</pre> from transformer_thermal_model.cooler import CoolerType from transformer_thermal_model.hot_spot_calibration import calibrate_hotspot_factor from transformer_thermal_model.schemas import UserTransformerSpecifications from transformer_thermal_model.transformer import PowerTransformer  tr_specs = UserTransformerSpecifications(     load_loss=1000,  # Transformer load loss [W]     nom_load_sec_side=1500,  # Transformer nominal current secondary side [A]     no_load_loss=200,  # Transformer no-load loss [W]     amb_temp_surcharge=20,  # Ambient temperature surcharge [K] ) uncalibrated_transformer = PowerTransformer(user_specs=tr_specs, cooling_type=CoolerType.ONAF) calibrated_trafo = calibrate_hotspot_factor(     uncalibrated_transformer=uncalibrated_transformer,     ambient_temp=20.0,     hot_spot_limit=98,  # in most cases a hot-spot temperature limit of 98 can be used     hot_spot_factor_min=1.1,     hot_spot_factor_max=1.3, ) <p>The new hot-spot factor is available via <code>calibrated_trafo.specs.hot_spot_fac</code>, and from now on used in the thermal model.</p> In\u00a0[3]: Copied! <pre>print(calibrated_trafo.specs.hot_spot_fac)\n</pre> print(calibrated_trafo.specs.hot_spot_fac) <pre>1.1\n</pre> <p>The calibrated transformer is now ready to be used in the Model</p> In\u00a0[\u00a0]: Copied! <pre>model = Model(temperature_profile=profile_input, transformer=calibrated_trafo)\n\nresults = model.run()\n\n# Get the results as pd.Series, with the same datetime_index as your input.\ntop_oil_temp_profile = results.top_oil_temp_profile\nhot_spot_temp_profile = results.hot_spot_temp_profile\n</pre> model = Model(temperature_profile=profile_input, transformer=calibrated_trafo)  results = model.run()  # Get the results as pd.Series, with the same datetime_index as your input. top_oil_temp_profile = results.top_oil_temp_profile hot_spot_temp_profile = results.hot_spot_temp_profile"},{"location":"examples/hot-spot_calibration/#hot-spot-factor-calibration","title":"Hot-spot factor calibration\u00b6","text":""},{"location":"examples/hot-spot_calibration/#introduction","title":"Introduction\u00b6","text":"<p>In some cases, when modelling a power transformer, the hot-spot factor is not known. Then, hot-spot factor calibration is used to determine it. This is done based on a continuous nominal load with a duration of one week, a specified constant ambient temperature, and a hot-spot temperature limit, the hot-spot factor is calibrated to get as close as possible to 100% nominal load while staying within the 'hot_spot_factor_min' and 'hot_spot_factor_max' bounds.</p> <p>This example shows how to do this for a basic Power transformer.</p>"},{"location":"examples/hot-spot_calibration/#setup-inputprofile-and-transformer","title":"Setup Inputprofile and Transformer\u00b6","text":""},{"location":"examples/hot-spot_calibration/#determining-the-hot-spot-factor","title":"Determining the hot-spot factor\u00b6","text":"<p>The temperature in the model is modelled using the hot-spot factor (link will follow). This is a value between 1.1 and 1.3.</p> <p>When unknown, we have also provided a functionality to calibrate this value for power transformers only. When you have the rest of the specifications of your transformer:</p>"},{"location":"examples/initial_temperature/","title":"Modelling with an initial state","text":"In\u00a0[1]: Copied! <pre>import matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\n\nfrom transformer_thermal_model.model import Model\nfrom transformer_thermal_model.schemas import InputProfile, OutputProfile, UserTransformerSpecifications\nfrom transformer_thermal_model.schemas.thermal_model.initial_state import InitialLoad, InitialTopOilTemp\nfrom transformer_thermal_model.transformer import DistributionTransformer\n</pre> import matplotlib.pyplot as plt import numpy as np import pandas as pd  from transformer_thermal_model.model import Model from transformer_thermal_model.schemas import InputProfile, OutputProfile, UserTransformerSpecifications from transformer_thermal_model.schemas.thermal_model.initial_state import InitialLoad, InitialTopOilTemp from transformer_thermal_model.transformer import DistributionTransformer In\u00a0[2]: Copied! <pre>datetime_index = [pd.to_datetime(\"2025-07-01 00:00:00\") + pd.Timedelta(minutes=5 * i) for i in np.arange(0, 30)]\n\nload_series = pd.Series(data=700, index=datetime_index)\nambient_series = pd.Series(data=20, index=datetime_index)\n\nprofile_input = InputProfile.create(\n    datetime_index=datetime_index, load_profile=load_series, ambient_temperature_profile=ambient_series\n)\n\ntransformer_specifications = UserTransformerSpecifications(\n    load_loss=5200,\n    time_const_oil=10,\n    nom_load_sec_side=900,\n    no_load_loss=800,\n    amb_temp_surcharge=10,\n)\ntransformer = DistributionTransformer(user_specs=transformer_specifications)\n\n\ndef plot_temperature_profiles(results: OutputProfile):\n    \"\"\"Plot the temperature profiles from the model results.\"\"\"\n    plt.figure()\n    ax = results.top_oil_temp_profile.plot(label=\"Top-oil temperature\")\n    results.hot_spot_temp_profile.plot(label=\"Hot-spot temperature\")\n    ambient_series.plot(label=\"Ambient temperature\")\n    ax.set_ylabel(\"Temperature [C]\")\n    ax.legend()\n    plt.show()\n</pre> datetime_index = [pd.to_datetime(\"2025-07-01 00:00:00\") + pd.Timedelta(minutes=5 * i) for i in np.arange(0, 30)]  load_series = pd.Series(data=700, index=datetime_index) ambient_series = pd.Series(data=20, index=datetime_index)  profile_input = InputProfile.create(     datetime_index=datetime_index, load_profile=load_series, ambient_temperature_profile=ambient_series )  transformer_specifications = UserTransformerSpecifications(     load_loss=5200,     time_const_oil=10,     nom_load_sec_side=900,     no_load_loss=800,     amb_temp_surcharge=10, ) transformer = DistributionTransformer(user_specs=transformer_specifications)   def plot_temperature_profiles(results: OutputProfile):     \"\"\"Plot the temperature profiles from the model results.\"\"\"     plt.figure()     ax = results.top_oil_temp_profile.plot(label=\"Top-oil temperature\")     results.hot_spot_temp_profile.plot(label=\"Hot-spot temperature\")     ambient_series.plot(label=\"Ambient temperature\")     ax.set_ylabel(\"Temperature [C]\")     ax.legend()     plt.show() In\u00a0[3]: Copied! <pre>model = Model(\n    temperature_profile=profile_input,\n    transformer=transformer,\n    initial_condition=InitialTopOilTemp(initial_top_oil_temp=50),\n)\nresults = model.run()\nplot_temperature_profiles(results)\n</pre> model = Model(     temperature_profile=profile_input,     transformer=transformer,     initial_condition=InitialTopOilTemp(initial_top_oil_temp=50), ) results = model.run() plot_temperature_profiles(results) In\u00a0[7]: Copied! <pre>model = Model(\n    temperature_profile=profile_input, transformer=transformer, initial_condition=InitialLoad(initial_load=500)\n)\nresults = model.run()\nplot_temperature_profiles(results)\n</pre> model = Model(     temperature_profile=profile_input, transformer=transformer, initial_condition=InitialLoad(initial_load=500) ) results = model.run() plot_temperature_profiles(results) In\u00a0[8]: Copied! <pre>model = Model(temperature_profile=profile_input, transformer=transformer)\nresults = model.run()\nplot_temperature_profiles(results)\n</pre> model = Model(temperature_profile=profile_input, transformer=transformer) results = model.run() plot_temperature_profiles(results)"},{"location":"examples/initial_temperature/#calculate-transformer-temperatures-with-different-initial-conditions","title":"Calculate transformer temperatures with different initial conditions\u00b6","text":"<p>The thermal model requires an initial value for top-oil temperature to begin calculations, since it bases future values on the previous state. Different initialization methods are available depending on the information you have about the transformer's operating state:</p> <ul> <li>Cold start (default): Assumes the transformer begins at rest with no prior load. Both top-oil and hot-spot temperatures start at ambient temperature.</li> <li>Known initial temperature: Use this when you know the top-oil temperature at the first timestamp (from measurements).</li> <li>Stabilized at load: Use this when you know the steady-state load before the profile begins. The temperatures stabilize at the equilibrium values for that load.</li> </ul> <p>This example demonstrates all three approaches using the <code>InitialTopOilTemp</code>, <code>InitialLoad</code>, and default initialization options.</p>"},{"location":"examples/initial_temperature/#initialize-with-a-known-initial-top-oil-temperature","title":"Initialize with a known initial top-oil temperature\u00b6","text":"<p>Use <code>InitialTopOilTemp</code> when you have a direct measurement of the top-oil temperature at the first timestamp. This provides an accurate starting point for the temperature calculation.</p> <p>Note: Since hot-spot temperature cannot be directly determined from top-oil temperature alone, the model assumes the hot-spot temperature also starts at this initial top-oil temperature. Once calculations begin, the hot-spot temperature will diverge based on the losses and thermal dynamics.</p>"},{"location":"examples/initial_temperature/#initialize-by-stabilizing-at-a-known-load","title":"Initialize by stabilizing at a known load\u00b6","text":"<p>Use <code>InitialLoad</code> when you know the transformer has been operating at a steady load before the profile begins. Both top-oil and hot-spot temperatures are calculated as if the transformer reached thermal equilibrium at that load. This provides realistic initial temperatures for the dynamic simulation that follows.</p> <p>In this example, we assume the transformer was operating at 500 MW load, allowing both temperatures to stabilize at their steady-state values before the profile begins.</p>"},{"location":"examples/initial_temperature/#cold-start-no-prior-information-default-behavior","title":"Cold start: No prior information (default behavior)\u00b6","text":"<p>When you have no information about the transformer's previous operating state, or you know it started 'cold', the model performs a \"cold start\" by assuming the transformer begins at rest. Both top-oil and hot-spot temperatures start at the ambient temperature.</p>"},{"location":"examples/power_transformer_example/","title":"Thermal modelling based on a dynamic profile and a power transformer","text":"<p>In this example the following concepts are shown:</p> <ul> <li>modelling a power transformer;</li> <li>setting transformer specifications;</li> <li>modelling with a dynamic load and ambient profile;</li> <li>comparing the results, top-oil and hot-spot temperature with temperature limits;</li> <li>calculating paper aging over time according to IEC 60076-7.</li> </ul> <p>Before we start modelling the transformer, we will first import all the required functions and classes.</p> In\u00a0[1]: Copied! <pre>import matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\n\nfrom transformer_thermal_model.aging import aging_rate_profile, days_aged\nfrom transformer_thermal_model.cooler import CoolerType\nfrom transformer_thermal_model.model import Model\nfrom transformer_thermal_model.schemas import InputProfile, UserTransformerSpecifications\nfrom transformer_thermal_model.transformer import PaperInsulationType, PowerTransformer\n</pre> import matplotlib.pyplot as plt import numpy as np import pandas as pd  from transformer_thermal_model.aging import aging_rate_profile, days_aged from transformer_thermal_model.cooler import CoolerType from transformer_thermal_model.model import Model from transformer_thermal_model.schemas import InputProfile, UserTransformerSpecifications from transformer_thermal_model.transformer import PaperInsulationType, PowerTransformer In\u00a0[2]: Copied! <pre>datetime_index = [pd.to_datetime(\"2025-01-01 00:00:00\") + pd.Timedelta(minutes=15 * i) for i in np.arange(0, 288)]\n\nload_series = pd.Series(data=np.sin(np.arange(0, 288) * 900 * 2 * np.pi * 1 / 43200) * 500 + 500, index=datetime_index)\nambient_series = pd.Series(data=20, index=datetime_index)\n</pre> datetime_index = [pd.to_datetime(\"2025-01-01 00:00:00\") + pd.Timedelta(minutes=15 * i) for i in np.arange(0, 288)]  load_series = pd.Series(data=np.sin(np.arange(0, 288) * 900 * 2 * np.pi * 1 / 43200) * 500 + 500, index=datetime_index) ambient_series = pd.Series(data=20, index=datetime_index) In\u00a0[3]: Copied! <pre># Create an input object with the profiles\nmy_profile_input = InputProfile.create(\n    datetime_index=datetime_index, load_profile=load_series, ambient_temperature_profile=ambient_series\n)\n</pre> # Create an input object with the profiles my_profile_input = InputProfile.create(     datetime_index=datetime_index, load_profile=load_series, ambient_temperature_profile=ambient_series ) In\u00a0[6]: Copied! <pre>my_transformer_specifications = UserTransformerSpecifications(\n    load_loss=160000,  # Transformer load loss [W]\n    nom_load_sec_side=1600,  # Transformer nominal current secondary side [A]\n    no_load_loss=70000,  # Transformer no-load loss [W]\n    amb_temp_surcharge=10,  # Ambient temperature surcharge [K]\n    time_const_oil=150,  # Time constant oil [min]\n    time_const_windings=7,  # Time constant windings [min]\n    top_oil_temp_rise=50.5,  # Top-oil temperature rise [K]\n    winding_oil_gradient=23,  # Winding oil gradient (worst case) [K]\n    end_temp_reduction=0,  # Lowering of the end temperature with respect to the current specification [K]\n    hot_spot_fac=1.2,  # Hot-spot factor [-]\n    oil_const_k11=0.5,  # Oil constant k11 [-]\n    winding_const_k21=2.0,  # Winding constant k21 [-]\n    winding_const_k22=2.0,  # Winding constant k22 [-]\n    oil_exp_x=0.8,  # Oil exponent x [-]\n    winding_exp_y=1.3,  # Winding exponent x [-]\n)\nmy_transformer = PowerTransformer(user_specs=my_transformer_specifications, cooling_type=CoolerType.ONAF)\n</pre> my_transformer_specifications = UserTransformerSpecifications(     load_loss=160000,  # Transformer load loss [W]     nom_load_sec_side=1600,  # Transformer nominal current secondary side [A]     no_load_loss=70000,  # Transformer no-load loss [W]     amb_temp_surcharge=10,  # Ambient temperature surcharge [K]     time_const_oil=150,  # Time constant oil [min]     time_const_windings=7,  # Time constant windings [min]     top_oil_temp_rise=50.5,  # Top-oil temperature rise [K]     winding_oil_gradient=23,  # Winding oil gradient (worst case) [K]     end_temp_reduction=0,  # Lowering of the end temperature with respect to the current specification [K]     hot_spot_fac=1.2,  # Hot-spot factor [-]     oil_const_k11=0.5,  # Oil constant k11 [-]     winding_const_k21=2.0,  # Winding constant k21 [-]     winding_const_k22=2.0,  # Winding constant k22 [-]     oil_exp_x=0.8,  # Oil exponent x [-]     winding_exp_y=1.3,  # Winding exponent x [-] ) my_transformer = PowerTransformer(user_specs=my_transformer_specifications, cooling_type=CoolerType.ONAF) In\u00a0[7]: Copied! <pre>my_model = Model(temperature_profile=my_profile_input, transformer=my_transformer)\n\nresults = my_model.run()\n</pre> my_model = Model(temperature_profile=my_profile_input, transformer=my_transformer)  results = my_model.run() <p>The output, <code>results</code>, contains to output profiles: the top-oil temperature profile and the hot-spot temperature profile. They can be accessed using <code>results.hot_spot_temp_profile</code> and <code>results.top_oil_temp_profile</code>.</p> In\u00a0[13]: Copied! <pre>print(\"The first values of the hot-spot temperature profile are:\")\nprint(results.hot_spot_temp_profile.head())\n\nprint(\"And the first values of the top-oil temperature profile are:\")\nprint(results.top_oil_temp_profile.head())\n</pre> print(\"The first values of the hot-spot temperature profile are:\") print(results.hot_spot_temp_profile.head())  print(\"And the first values of the top-oil temperature profile are:\") print(results.top_oil_temp_profile.head()) <pre>The first values of the hot-spot temperature profile are:\n2025-01-01 00:00:00    30.000000\n2025-01-01 00:15:00    42.410763\n2025-01-01 00:30:00    49.499406\n2025-01-01 00:45:00    54.502872\n2025-01-01 01:00:00    58.550306\ndtype: float64\nAnd the first values of the top-oil temperature profile are:\n2025-01-01 00:00:00    30.000000\n2025-01-01 00:15:00    34.320281\n2025-01-01 00:30:00    38.040463\n2025-01-01 00:45:00    41.279628\n2025-01-01 01:00:00    44.129399\ndtype: float64\n</pre> <p>Because we did not use an initial temperature, the model sets the initial temperature to the ambient plus the temperature surcharge. When we do not know the actual initial temperatures a period should be cut off. Typically a period of 5 times the oil time constant in minutes is used: <code>my_transformer.specs.time_const_oil * 5</code>.  In this period the transformer had enough time to warm up or cool down to match the applied load and ambient temperature.</p> In\u00a0[7]: Copied! <pre>start_time = datetime_index[0] + pd.Timedelta(my_transformer.specs.time_const_oil * 5, \"m\")\n</pre> start_time = datetime_index[0] + pd.Timedelta(my_transformer.specs.time_const_oil * 5, \"m\") <p>Now that we have calculated the correct start time we use this to plot the top-oil and hotspot temperature to see how warm our transformer became.</p> In\u00a0[\u00a0]: Copied! <pre>fig = plt.figure()\nax = results.top_oil_temp_profile.loc[start_time::].plot(label=\"Top-oil temperature\", color=\"green\")\nresults.hot_spot_temp_profile.loc[start_time::].plot(label=\"Hot-spot temperature\", color=\"blue\")\nambient_series.loc[start_time::].plot(label=\"Ambient temperature\", color=\"red\")\nax.set_ylabel(\"Temperature [C]\")\nax.hlines(120, datetime_index[0], datetime_index[-1], linestyles=\"dashed\", label=\"Hot-spot limit\", color=\"blue\")\nax.hlines(105, datetime_index[0], datetime_index[-1], linestyles=\"dashed\", label=\"Top-oil limit\", color=\"green\")\nax.legend(loc=\"lower left\")\n</pre> fig = plt.figure() ax = results.top_oil_temp_profile.loc[start_time::].plot(label=\"Top-oil temperature\", color=\"green\") results.hot_spot_temp_profile.loc[start_time::].plot(label=\"Hot-spot temperature\", color=\"blue\") ambient_series.loc[start_time::].plot(label=\"Ambient temperature\", color=\"red\") ax.set_ylabel(\"Temperature [C]\") ax.hlines(120, datetime_index[0], datetime_index[-1], linestyles=\"dashed\", label=\"Hot-spot limit\", color=\"blue\") ax.hlines(105, datetime_index[0], datetime_index[-1], linestyles=\"dashed\", label=\"Top-oil limit\", color=\"green\") ax.legend(loc=\"lower left\") <p>We added two more lines in the figure: two limits. These limits show how hot we allow the transformer to become to be used safely and without it to age to much. You can see that both calculated profiles are nicely below the limits.</p> In\u00a0[9]: Copied! <pre>aging_profile = aging_rate_profile(\n    hot_spot_profile=results.hot_spot_temp_profile.loc[start_time::],\n    insulation_type=PaperInsulationType.NORMAL,\n)\n</pre> aging_profile = aging_rate_profile(     hot_spot_profile=results.hot_spot_temp_profile.loc[start_time::],     insulation_type=PaperInsulationType.NORMAL, ) In\u00a0[10]: Copied! <pre>total_aging = days_aged(\n    hot_spot_profile=results.hot_spot_temp_profile.loc[start_time::],\n    insulation_type=PaperInsulationType.NORMAL,\n)\n</pre> total_aging = days_aged(     hot_spot_profile=results.hot_spot_temp_profile.loc[start_time::],     insulation_type=PaperInsulationType.NORMAL, ) In\u00a0[\u00a0]: Copied! <pre>fig = plt.figure()\nax = aging_profile.plot(label=\"Aging profile\")\nax.set_ylabel(\"Aging rate in days/day\")\n\nax.legend()\nax.set_title(\n    f\"Aging profile with total aging of {round(total_aging, 2)} days over a\"\n    \" total of {len(set(aging_profile.index.date))} days.\"\n)\n</pre> fig = plt.figure() ax = aging_profile.plot(label=\"Aging profile\") ax.set_ylabel(\"Aging rate in days/day\")  ax.legend() ax.set_title(     f\"Aging profile with total aging of {round(total_aging, 2)} days over a\"     \" total of {len(set(aging_profile.index.date))} days.\" )"},{"location":"examples/power_transformer_example/#thermal-modelling-based-on-a-dynamic-profile-and-a-power-transformer","title":"Thermal modelling based on a dynamic profile and a power transformer\u00b6","text":""},{"location":"examples/power_transformer_example/#input-profiles","title":"Input profiles\u00b6","text":"<p>The data, a load profile and an ambient temperature profile, are generated for this example and cover three days. The load is a simple sine with a wavelength of half a day. The ambient temperature is constant over the given period. In the next step they generated and combined into an <code>InputProfile</code> object.</p> <p>Note that the time series should have the same length and cover the exact same time period.</p> <p>Furthermore, the load and ambient temperature should be formatted as a list, a numpy array or a pandas series.</p>"},{"location":"examples/power_transformer_example/#transformer-object","title":"Transformer object\u00b6","text":"<p>The next step is to create a power transformer object. We will use a combination of default specifications and user defined specifications. The latter are set via <code>UserTransformerSpecifications</code>.</p>"},{"location":"examples/power_transformer_example/#setup-the-thermal-model-and-run","title":"Setup the thermal model and run\u00b6","text":"<p>Now it is time to create a model based on the transformer and the profiles and run the model to create a temperature profile of the top-oil and the hot-spot.</p>"},{"location":"examples/power_transformer_example/#paper-aging","title":"Paper aging\u00b6","text":"<p>Now we have seen that the temperature is not too high. We can also have a look at the aging of the transformer. The aging model used is, like the thermal model, also based the Loading Guide. The aging is calculated based on the type of paper insulation (which can be of type <code>PaperInsulationType.NORMAL</code> or <code>PaperInsulationType.TUP</code>) and the hotspot temperature profile.</p> <p>Again we cut off the heating period based on five times the oil constant.</p>"},{"location":"examples/quickstart/","title":"Quick start","text":"<p>In this quick start you will calculate the temperature progression of a power transformer exposed to a constant load during a summer week.</p> <p>Before we start modelling the transformer, we will first import all the required functions and classes.</p> In\u00a0[\u00a0]: Copied! <pre>import matplotlib.pyplot as plt\nimport pandas as pd\n\nfrom transformer_thermal_model.cooler import CoolerType\nfrom transformer_thermal_model.model import Model\nfrom transformer_thermal_model.schemas import InputProfile, UserTransformerSpecifications\nfrom transformer_thermal_model.transformer import PowerTransformer\n</pre> import matplotlib.pyplot as plt import pandas as pd  from transformer_thermal_model.cooler import CoolerType from transformer_thermal_model.model import Model from transformer_thermal_model.schemas import InputProfile, UserTransformerSpecifications from transformer_thermal_model.transformer import PowerTransformer In\u00a0[2]: Copied! <pre>one_week = 4 * 24 * 7\ndatetime_index = pd.date_range(\"2025-07-01\", periods=one_week, freq=\"15min\")\n\n# The ambient temperature during this week is 20 degrees celsius\nambient_temp = 20\nambient_series = pd.Series([ambient_temp] * one_week, index=datetime_index)\n\n# And the transformer is exposed to a nominal load of 100 Ampere:\nload = 100\nload_series = pd.Series([load] * one_week, index=datetime_index)\n\n# Create an input object with the profiles\nmy_profile_input = InputProfile.create(\n    datetime_index=datetime_index, load_profile=load_series, ambient_temperature_profile=ambient_series\n)\n</pre> one_week = 4 * 24 * 7 datetime_index = pd.date_range(\"2025-07-01\", periods=one_week, freq=\"15min\")  # The ambient temperature during this week is 20 degrees celsius ambient_temp = 20 ambient_series = pd.Series([ambient_temp] * one_week, index=datetime_index)  # And the transformer is exposed to a nominal load of 100 Ampere: load = 100 load_series = pd.Series([load] * one_week, index=datetime_index)  # Create an input object with the profiles my_profile_input = InputProfile.create(     datetime_index=datetime_index, load_profile=load_series, ambient_temperature_profile=ambient_series ) In\u00a0[3]: Copied! <pre>my_transformer_specifications = UserTransformerSpecifications(\n    load_loss=1000,  # Transformer load loss [W]\n    nom_load_sec_side=1500,  # Transformer nominal current secondary side [A]\n    no_load_loss=200,  # Transformer no-load loss [W]\n    amb_temp_surcharge=20,  # Ambient temperature surcharge [K]\n)\nmy_cooler_type = CoolerType.ONAN\nmy_transformer = PowerTransformer(user_specs=my_transformer_specifications, cooling_type=my_cooler_type)\n</pre> my_transformer_specifications = UserTransformerSpecifications(     load_loss=1000,  # Transformer load loss [W]     nom_load_sec_side=1500,  # Transformer nominal current secondary side [A]     no_load_loss=200,  # Transformer no-load loss [W]     amb_temp_surcharge=20,  # Ambient temperature surcharge [K] ) my_cooler_type = CoolerType.ONAN my_transformer = PowerTransformer(user_specs=my_transformer_specifications, cooling_type=my_cooler_type) <p>The default specifications of a power transformer can be consulted with the <code>default</code> property:</p> In\u00a0[4]: Copied! <pre>my_transformer.defaults\n</pre> my_transformer.defaults Out[4]: <pre>DefaultTransformerSpecifications(time_const_oil=210.0, time_const_windings=10.0, top_oil_temp_rise=60.0, winding_oil_gradient=17.0, hot_spot_fac=1.3, oil_const_k11=0.5, winding_const_k21=2, winding_const_k22=2, oil_exp_x=0.8, winding_exp_y=1.3, end_temp_reduction=0.0)</pre> <p>The specifications that are used in the thermal model can be consulted in the <code>specs</code> property. Note that the <code>defaults</code> and the <code>specs</code> can differ and the specification that are used in the model are <code>my_transformer.specs</code>.</p> In\u00a0[5]: Copied! <pre>my_transformer.specs\n</pre> my_transformer.specs Out[5]: <pre>TransformerSpecifications(load_loss=1000.0, nom_load_sec_side=1500.0, no_load_loss=200.0, amb_temp_surcharge=20.0, time_const_oil=210.0, time_const_windings=10.0, top_oil_temp_rise=60.0, winding_oil_gradient=17.0, hot_spot_fac=1.3, oil_const_k11=0.5, winding_const_k21=2, winding_const_k22=2, oil_exp_x=0.8, winding_exp_y=1.3, end_temp_reduction=0.0)</pre> In\u00a0[6]: Copied! <pre>my_model = Model(temperature_profile=my_profile_input, transformer=my_transformer)\n\nresults = my_model.run()\n</pre> my_model = Model(temperature_profile=my_profile_input, transformer=my_transformer)  results = my_model.run() <p>The output, <code>results</code>, contains to output profiles: the top-oil temperature profile and the hot-spot temperature profile.</p> <p>Because we did not define an initial temperature, the model sets the initial temperature to the ambient plus the temperature surcharge. In reality, the transformer might have been warmer than ambient temperature due e.g. to previous loads. To compensate this, a warm-up period should be cut off. Typically a period of 5 times the oil time constant in minutes is used: <code>my_transformer.specs.time_const_oil * 5</code>.  In this period the transformer had enough time to warm up or cool down to match the applied load and ambient temperature</p> In\u00a0[7]: Copied! <pre>start_time = datetime_index[0] + pd.Timedelta(my_transformer.specs.time_const_oil * 5, \"m\")\n</pre> start_time = datetime_index[0] + pd.Timedelta(my_transformer.specs.time_const_oil * 5, \"m\") <p>Now we calculated the correct starting-time, we use this to plot the top-oil and hotspot temperature to see how warm our transformer is under this constant load.</p> In\u00a0[8]: Copied! <pre>fig = plt.figure()\nax = results.top_oil_temp_profile.loc[start_time::].plot(label=\"Top-oil temperature\")\nresults.hot_spot_temp_profile.loc[start_time::].plot(label=\"Hot-spot temperature\")\nambient_series.loc[start_time::].plot(label=\"Ambient temperature\")\nax.set_ylabel(\"Temperature [C]\")\n\nax.legend();\n</pre> fig = plt.figure() ax = results.top_oil_temp_profile.loc[start_time::].plot(label=\"Top-oil temperature\") results.hot_spot_temp_profile.loc[start_time::].plot(label=\"Hot-spot temperature\") ambient_series.loc[start_time::].plot(label=\"Ambient temperature\") ax.set_ylabel(\"Temperature [C]\")  ax.legend();"},{"location":"examples/quickstart/#quick-start","title":"Quick start\u00b6","text":""},{"location":"examples/quickstart/#introduction","title":"Introduction\u00b6","text":""},{"location":"examples/quickstart/#create-input-data","title":"Create input data\u00b6","text":"<p>First we will create data to simulate the ambient temperature during this summer week together with a constant load.</p> <p>Both profiles will have a duration of a week with a sampling time of 15 minutes.</p> <p>Note that other sampling times can be used, but preferably 15 minutes or lower.</p>"},{"location":"examples/quickstart/#a-transformer-object","title":"A transformer object\u00b6","text":"<p>The next step is to create a power transformer object. We will use the default specifications of the power transformer. Additionally, there are five mandatory specifications to be set:</p> <ul> <li>The nominal current at the secondary side [A]</li> <li>The load loss [W]</li> <li>The no-load loss [W]</li> <li>The ambient temperature surcharge [K]</li> <li>The cooling type (ONAN or ONAF)</li> </ul> <p>The first four specifications are set using the <code>UserTransformerSpecifications</code> object and the cooler type is selected using the CoolerType enumerator. Note that the values are chosen randomly.</p>"},{"location":"examples/quickstart/#running-the-thermal-model","title":"Running the thermal model\u00b6","text":"<p>Now it is time to create a <code>my_model</code> object from the <code>Model</code> class. This object is initiated with the my_transformer and the my_profiles object. Then we run the model to create a temperature profile of the top-oil and the hot-spot.</p>"},{"location":"examples/quickstart/#summary","title":"Summary\u00b6","text":"<p>In this quick start the basic principles of the Transformer Thermal Model are shown. You learned to model the top-oil and hot-spot temperature based on an <code>InputProfile</code> instance and a <code>Transformer</code> instance.</p> <p>For more detailed information and modelling with dynamic profiles you can go through the other examples.</p>"},{"location":"examples/simple_thermal_profile_example_distribution/","title":"Thermal modelling based on a dynamic profile and a distribution transformer","text":"<p>In this example the following concepts are shown:</p> <ul> <li>Modelling of a distribution transformer;</li> <li>Setting the minimal required transformer specifications;</li> <li>Modelling with a dynamic load and ambient profile.</li> </ul> <p>Before we start modelling the transformer, we will first import all the required functions and classes.</p> In\u00a0[1]: Copied! <pre>import matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\n\nfrom transformer_thermal_model.model import Model\nfrom transformer_thermal_model.schemas import InputProfile, UserTransformerSpecifications\nfrom transformer_thermal_model.transformer import DistributionTransformer\n</pre> import matplotlib.pyplot as plt import numpy as np import pandas as pd  from transformer_thermal_model.model import Model from transformer_thermal_model.schemas import InputProfile, UserTransformerSpecifications from transformer_thermal_model.transformer import DistributionTransformer <p>The data, a load profile and an ambient temperature profile, are generated for this example and cover three days. The load is a simple sine with a wavelength of half a day. The ambient temperature is constant over the given period. The data can be combined into an <code>InputProfile</code> object.</p> In\u00a0[2]: Copied! <pre>datetime_index = [pd.to_datetime(\"2025-07-01 00:00:00\") + pd.Timedelta(minutes=15 * i) for i in np.arange(0, 288)]\n\nload_series = pd.Series(data=np.sin(np.arange(0, 288) * 900 * 2 * np.pi * 1 / 43200) * 500 + 500, index=datetime_index)\nambient_series = pd.Series(data=20, index=datetime_index)\n\n# Create an input object with the profiles\nprofile_input = InputProfile.create(\n    datetime_index=datetime_index, load_profile=load_series, ambient_temperature_profile=ambient_series\n)\n</pre> datetime_index = [pd.to_datetime(\"2025-07-01 00:00:00\") + pd.Timedelta(minutes=15 * i) for i in np.arange(0, 288)]  load_series = pd.Series(data=np.sin(np.arange(0, 288) * 900 * 2 * np.pi * 1 / 43200) * 500 + 500, index=datetime_index) ambient_series = pd.Series(data=20, index=datetime_index)  # Create an input object with the profiles profile_input = InputProfile.create(     datetime_index=datetime_index, load_profile=load_series, ambient_temperature_profile=ambient_series ) <p>The next step is to create a distribution transformer object. We will use the default specifications of the distribution transformer. Additionally, there are four mandatory specifications to be set:</p> <ul> <li>The nominal current at the secondary side [A]</li> <li>The load loss [W]</li> <li>The no-load loss [W]</li> <li>The ambient temperature surcharge [K]</li> </ul> <p>The four specifications are set using the <code>UserTransformerSpecifications</code> object.</p> <p>Note that the cooling type is ONAN by default for distribution transformers.</p> In\u00a0[3]: Copied! <pre>transformer_specifications = UserTransformerSpecifications(\n    load_loss=5200,  # Transformer load loss [W]\n    nom_load_sec_side=900,  # Transformer nominal current secondary side [A]\n    no_load_loss=800,  # Transformer no-load loss [W]\n    amb_temp_surcharge=10,  # Ambient temperature surcharge [K]\n)\ntransformer = DistributionTransformer(user_specs=transformer_specifications)\n</pre> transformer_specifications = UserTransformerSpecifications(     load_loss=5200,  # Transformer load loss [W]     nom_load_sec_side=900,  # Transformer nominal current secondary side [A]     no_load_loss=800,  # Transformer no-load loss [W]     amb_temp_surcharge=10,  # Ambient temperature surcharge [K] ) transformer = DistributionTransformer(user_specs=transformer_specifications) <p>The default specifications of a transformer can be consulted with the <code>default</code> property:</p> In\u00a0[4]: Copied! <pre>transformer.defaults\n</pre> transformer.defaults Out[4]: <pre>DefaultTransformerSpecifications(time_const_oil=180.0, time_const_windings=4.0, top_oil_temp_rise=60.0, winding_oil_gradient=23.0, hot_spot_fac=1.2, oil_const_k11=1.0, winding_const_k21=1, winding_const_k22=2, oil_exp_x=0.8, winding_exp_y=1.6, end_temp_reduction=0.0)</pre> <p>The specifications that are used in the thermal model can consulted in the <code>specs</code> property. Note that the <code>defaults</code> and the <code>specs</code> can differ.</p> In\u00a0[5]: Copied! <pre>transformer.specs\n</pre> transformer.specs Out[5]: <pre>TransformerSpecifications(no_load_loss=800.0, amb_temp_surcharge=10.0, time_const_oil=180.0, time_const_windings=4.0, top_oil_temp_rise=60.0, winding_oil_gradient=23.0, hot_spot_fac=1.2, oil_const_k11=1.0, winding_const_k21=1, winding_const_k22=2, oil_exp_x=0.8, winding_exp_y=1.6, end_temp_reduction=0.0, load_loss=5200.0, nom_load_sec_side=900.0)</pre> <p>Now it is time to create a model based on the transformer and the profiles and run the model to create a temperature profile of the top-oil and the hot-spot.</p> In\u00a0[6]: Copied! <pre>model = Model(temperature_profile=profile_input, transformer=transformer)\n\nresults = model.run()\n</pre> model = Model(temperature_profile=profile_input, transformer=transformer)  results = model.run() <p>The output, <code>results</code>, contains to output profiles: the top-oil temperature profile and the hot-spot temperature profile. Lets plot them to see how warm our transformer became in this summer week.</p> In\u00a0[7]: Copied! <pre>fig = plt.figure()\nax = results.top_oil_temp_profile.plot(label=\"Top-oil temperature\")\nresults.hot_spot_temp_profile.plot(label=\"Hot-spot temperature\")\nambient_series.plot(label=\"Ambient temperature\")\nax.set_ylabel(\"Temperature [C]\")\n\nax.legend();\n</pre> fig = plt.figure() ax = results.top_oil_temp_profile.plot(label=\"Top-oil temperature\") results.hot_spot_temp_profile.plot(label=\"Hot-spot temperature\") ambient_series.plot(label=\"Ambient temperature\") ax.set_ylabel(\"Temperature [C]\")  ax.legend(); In\u00a0[\u00a0]: Copied! <pre>\n</pre>"},{"location":"examples/simple_thermal_profile_example_distribution/#thermal-modelling-based-on-a-dynamic-profile-and-a-distribution-transformer","title":"Thermal modelling based on a dynamic profile and a distribution transformer\u00b6","text":""},{"location":"examples/three-winding-calculation/","title":"Thermal modelling of a three winding transformer","text":"<p>In this example the following concepts are shown:</p> <ul> <li>Creating a ThreeWindingTransformer, and setting its parameters</li> <li>Creating a ThreeWindingInputProfile, that holds the profiles for a three winding transformer</li> <li>The the thermal modelling of a three winding transformer</li> </ul> In\u00a0[2]: Copied! <pre>import matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\n\nfrom transformer_thermal_model.cooler import CoolerType\nfrom transformer_thermal_model.model import Model\nfrom transformer_thermal_model.schemas import (\n    ThreeWindingInputProfile,\n    UserThreeWindingTransformerSpecifications,\n    WindingSpecifications,\n)\nfrom transformer_thermal_model.transformer import ThreeWindingTransformer\n</pre> import matplotlib.pyplot as plt import numpy as np import pandas as pd  from transformer_thermal_model.cooler import CoolerType from transformer_thermal_model.model import Model from transformer_thermal_model.schemas import (     ThreeWindingInputProfile,     UserThreeWindingTransformerSpecifications,     WindingSpecifications, ) from transformer_thermal_model.transformer import ThreeWindingTransformer <p>The creation of a ThreeWindingInputProfile is similar to the creation of a normal InputProfile, except that the load_profile is now replaced with a seperate profile for the low, medium and high voltage side of the transformer. These profiles should all have the same length.</p> In\u00a0[\u00a0]: Copied! <pre>\n</pre> In\u00a0[3]: Copied! <pre># Define the time range for your simulation\ndatetime_index = [pd.to_datetime(\"2025-07-01 00:00:00\") + pd.Timedelta(minutes=15 * i) for i in np.arange(0, 288)]\n\nload_series_high = pd.Series(\n    data=np.sin(np.arange(0, 288) * 900 * 2 * np.pi * 1 / 43200) * 500 + 500, index=datetime_index\n)\nload_series_middle = pd.Series(\n    data=np.sin(np.arange(0, 288) * 900 * 2 * np.pi * 1 / 43200) * 500 + 500, index=datetime_index\n)\nload_series_low = pd.Series(\n    data=np.sin(np.arange(0, 288) * 900 * 2 * np.pi * 1 / 43200) * 500 + 500, index=datetime_index\n)\n\nambient_series = pd.Series(data=20, index=datetime_index)\n\n# Create the input profile for the three-winding transformer\nprofile_input = ThreeWindingInputProfile.create(\n    datetime_index=datetime_index,\n    ambient_temperature_profile=ambient_series,\n    load_profile_high_voltage_side=load_series_high,\n    load_profile_middle_voltage_side=load_series_middle,\n    load_profile_low_voltage_side=load_series_low,\n)\n</pre> # Define the time range for your simulation datetime_index = [pd.to_datetime(\"2025-07-01 00:00:00\") + pd.Timedelta(minutes=15 * i) for i in np.arange(0, 288)]  load_series_high = pd.Series(     data=np.sin(np.arange(0, 288) * 900 * 2 * np.pi * 1 / 43200) * 500 + 500, index=datetime_index ) load_series_middle = pd.Series(     data=np.sin(np.arange(0, 288) * 900 * 2 * np.pi * 1 / 43200) * 500 + 500, index=datetime_index ) load_series_low = pd.Series(     data=np.sin(np.arange(0, 288) * 900 * 2 * np.pi * 1 / 43200) * 500 + 500, index=datetime_index )  ambient_series = pd.Series(data=20, index=datetime_index)  # Create the input profile for the three-winding transformer profile_input = ThreeWindingInputProfile.create(     datetime_index=datetime_index,     ambient_temperature_profile=ambient_series,     load_profile_high_voltage_side=load_series_high,     load_profile_middle_voltage_side=load_series_middle,     load_profile_low_voltage_side=load_series_low, ) <p>Next, we create an <code>ThreeWindingTransformer</code> object, this is a Child class of the Transformer object. To create this, a user needs to pass specifications in the <code>UserThreeWindingTransformerSpecifications</code> class, in this class the following inputs are mandatory:</p> <ul> <li>The no-load loss [W]</li> <li>The ambient temperature surcharge [K]</li> <li>Specifications of the low voltage winding, these are set with a <code>WindingSpecifications</code> containing:<ul> <li>the nominal load [A]</li> <li>temperature difference between the average winding and average oil temperature under nominal conditions [K]</li> </ul> </li> <li>mv_winding (again with a <code>WindingSpecifications</code> class)</li> <li>hv_winding (again with a <code>WindingSpecifications</code> class)</li> <li>The load loss between high-voltage and low-voltage winding [W]</li> <li>The load loss between high-voltage and middle-voltage winding [W]</li> <li>The load loss between middle-voltage and low-voltage winding [W]</li> </ul> <p>Similar to <code>UserTransformerSpecifications</code>, you can also specify a lot off other optional parameters, if these are not set, the default values are used.</p> In\u00a0[4]: Copied! <pre># Define the transformer specifications for each winding\nuser_specs = UserThreeWindingTransformerSpecifications(\n    no_load_loss=20,\n    amb_temp_surcharge=10,\n    lv_winding=WindingSpecifications(\n        nom_load=1000, winding_oil_gradient=20, hot_spot_fac=1.2, time_const_winding=1, nom_power=1000\n    ),\n    mv_winding=WindingSpecifications(\n        nom_load=1000, winding_oil_gradient=20, hot_spot_fac=1.2, time_const_winding=1, nom_power=1000\n    ),\n    hv_winding=WindingSpecifications(\n        nom_load=2000, winding_oil_gradient=20, hot_spot_fac=1.2, time_const_winding=1, nom_power=2000\n    ),\n    load_loss_hv_lv=100,\n    load_loss_hv_mv=100,\n    load_loss_mv_lv=100,\n)\n\n# Create the transformer object\ntransformer = ThreeWindingTransformer(user_specs=user_specs, cooling_type=CoolerType.ONAN)\n</pre> # Define the transformer specifications for each winding user_specs = UserThreeWindingTransformerSpecifications(     no_load_loss=20,     amb_temp_surcharge=10,     lv_winding=WindingSpecifications(         nom_load=1000, winding_oil_gradient=20, hot_spot_fac=1.2, time_const_winding=1, nom_power=1000     ),     mv_winding=WindingSpecifications(         nom_load=1000, winding_oil_gradient=20, hot_spot_fac=1.2, time_const_winding=1, nom_power=1000     ),     hv_winding=WindingSpecifications(         nom_load=2000, winding_oil_gradient=20, hot_spot_fac=1.2, time_const_winding=1, nom_power=2000     ),     load_loss_hv_lv=100,     load_loss_hv_mv=100,     load_loss_mv_lv=100, )  # Create the transformer object transformer = ThreeWindingTransformer(user_specs=user_specs, cooling_type=CoolerType.ONAN) <p>The specifications that are used in the thermal model can consulted in the <code>specs</code> property.</p> In\u00a0[5]: Copied! <pre>transformer.specs\n</pre> transformer.specs Out[5]: <pre>ThreeWindingTransformerSpecifications(no_load_loss=20.0, amb_temp_surcharge=10.0, time_const_oil=210.0, top_oil_temp_rise=60.0, oil_const_k11=0.5, winding_const_k21=2, winding_const_k22=2, oil_exp_x=0.8, winding_exp_y=1.3, end_temp_reduction=0.0, lv_winding=WindingSpecifications(nom_load=1000.0, winding_oil_gradient=20.0, time_const_winding=1.0, hot_spot_fac=1.2, nom_power=1000.0), mv_winding=WindingSpecifications(nom_load=1000.0, winding_oil_gradient=20.0, time_const_winding=1.0, hot_spot_fac=1.2, nom_power=1000.0), hv_winding=WindingSpecifications(nom_load=2000.0, winding_oil_gradient=20.0, time_const_winding=1.0, hot_spot_fac=1.2, nom_power=2000.0), load_loss_hv_lv=100.0, load_loss_hv_mv=100.0, load_loss_mv_lv=100.0, load_loss_total_user=None)</pre> <p>Now we can create a model based on the transformer and the profiles and run the model to create a temperature profile of the top-oil and the hot-spot. This is exactly the same as for Power- and Distribution transformers.</p> In\u00a0[6]: Copied! <pre>model = Model(temperature_profile=profile_input, transformer=transformer)\nresults = model.run()\ntop_oil_temp_profile = results.top_oil_temp_profile\nhot_spot_temp_profile = results.hot_spot_temp_profile\n</pre> model = Model(temperature_profile=profile_input, transformer=transformer) results = model.run() top_oil_temp_profile = results.top_oil_temp_profile hot_spot_temp_profile = results.hot_spot_temp_profile <p>A three winding transformers has three hotspot temperature profiles, one for each winding. The return profile of <code>results.hot_spot_temp_profile</code> is therefor a pandas Dataframe with 3 columns:</p> In\u00a0[7]: Copied! <pre>hot_spot_temp_profile\n</pre> hot_spot_temp_profile Out[7]: low_voltage_side middle_voltage_side high_voltage_side 2025-07-01 00:00:00 30.000000 30.000000 30.000000 2025-07-01 00:15:00 53.641883 53.641883 40.974417 2025-07-01 00:30:00 57.846068 57.846068 44.054824 2025-07-01 00:45:00 62.012581 62.012581 47.126624 2025-07-01 01:00:00 66.084285 66.084285 50.166824 ... ... ... ... 2025-07-03 22:45:00 41.734443 41.734443 39.717655 2025-07-03 23:00:00 43.754966 43.754966 40.581056 2025-07-03 23:15:00 46.117911 46.117911 41.670329 2025-07-03 23:30:00 48.804771 48.804771 42.988857 2025-07-03 23:45:00 51.784651 51.784651 44.532525 <p>288 rows \u00d7 3 columns</p> <p>It only has one top oil temperature, so <code>results.top_oil_temp_profile</code> is still a pandas series</p> In\u00a0[8]: Copied! <pre>top_oil_temp_profile\n</pre> top_oil_temp_profile Out[8]: <pre>2025-07-01 00:00:00    30.000000\n2025-07-01 00:15:00    32.311651\n2025-07-01 00:30:00    34.623552\n2025-07-01 00:45:00    36.946722\n2025-07-01 01:00:00    39.281517\n                         ...    \n2025-07-03 22:45:00    38.338455\n2025-07-03 23:00:00    38.410548\n2025-07-03 23:15:00    38.628808\n2025-07-03 23:30:00    39.011589\n2025-07-03 23:45:00    39.573090\nLength: 288, dtype: float64</pre> In\u00a0[9]: Copied! <pre># Plot the top-oil temperature profile\nfig1, ax1 = plt.subplots()\nresults.top_oil_temp_profile.plot(ax=ax1, label=\"Top-oil temperature\")\nax1.set_title(\"Top-oil Temperature\")\nax1.set_ylabel(\"Temperature [C]\")\nax1.legend()\nplt.show()\n\n# Plot the hot-spot temperature profiles\nfig2, ax2 = plt.subplots()\nresults.hot_spot_temp_profile.plot(ax=ax2)\nax2.set_title(\"Hot-spot Temperatures\")\nax2.set_ylabel(\"Temperature [C]\")\nax2.legend()\nplt.show()\n</pre> # Plot the top-oil temperature profile fig1, ax1 = plt.subplots() results.top_oil_temp_profile.plot(ax=ax1, label=\"Top-oil temperature\") ax1.set_title(\"Top-oil Temperature\") ax1.set_ylabel(\"Temperature [C]\") ax1.legend() plt.show()  # Plot the hot-spot temperature profiles fig2, ax2 = plt.subplots() results.hot_spot_temp_profile.plot(ax=ax2) ax2.set_title(\"Hot-spot Temperatures\") ax2.set_ylabel(\"Temperature [C]\") ax2.legend() plt.show()"},{"location":"examples/three-winding-calculation/#thermal-modelling-of-a-three-winding-transformer","title":"Thermal modelling of a three winding transformer\u00b6","text":""},{"location":"get_started/about/","title":"Installation and overview","text":""},{"location":"get_started/about/#transformer-thermal-model","title":"Transformer thermal model","text":"<p><code>transformer-thermal-model</code> is a library for modelling the transformer top-oil and hot-spot temperature based on the transformer specifications, a load profile and an ambient temperature profile. The model is an implementation according to the standard IEC 60076-7, also known as de Loading Guide.</p>"},{"location":"get_started/about/#installation","title":"Installation","text":""},{"location":"get_started/about/#install-from-pypi","title":"Install from PyPI","text":"<p>You can directly install the package from PyPI.</p> <pre><code>pip install transformer-thermal-model\n</code></pre>"},{"location":"get_started/about/#structure-of-the-code","title":"Structure of the code","text":"<p>This package contains the following modules to work with:</p> <ul> <li><code>transformer_thermal_model.model</code>: the core of the package to calculate a temperature profile of a transformer using the thermal model;</li> <li><code>transformer_thermal_model.transformer</code>: a module containing multiple   transformer classes to be used to define a transformer;</li> <li><code>transformer_thermal_model.cooler</code>: a module containing the enumerators to define the cooler type of the transformer;</li> <li><code>transformer_thermal_model.schemas</code>: in schemas one can find a.o. the definition of the model interfaces and how the transformer specificitations should be specified;</li> <li><code>transformer_thermal_model.hot_spot_calibration</code>: a module that is used to determine the transformer hot-spot factor to be used in the thermal model.</li> </ul> <p>The following modules contain elements that are not required for thermal modelling but are used to get more insight in aging and load capacity:</p> <ul> <li><code>transformer_thermal_model.aging</code>: a module to calculate the aging of a transformer according to IEC 60076-7 paragraph 6.3;</li> <li><code>transformer_thermal_model.components</code>: a module containing enumerators to define components of a power transformer if one wants to calculate the relative load capacity of each component in the transformer.</li> </ul>"},{"location":"get_started/about/#how-to-create-a-transformer","title":"How to create a transformer","text":"<p>Before performing a calculation, a transformer object must be created with all necessary details about the transformer.  Default values will be used for any attribute not specified by the user.</p> <p><code>transformer_thermal_model.transformer</code>: This module has multiple <code>Transformer</code> children, which will be elements used for the temperature calculation inside <code>Model</code>.</p> <ul> <li><code>PowerTransformer</code>: A power transformer class, child of the <code>Transformer</code>   class.</li> <li><code>DistributionTransformer</code>: A distribution transformer class, also child of   the <code>Transformer</code> class.</li> <li><code>ThreeWindingTransformer</code>: A three winding transformer, also child of   the <code>Transformer</code> class.</li> <li><code>TransformerType</code> (<code>Enum</code>): For easily checking all available types. Does not    have any use in our code, but might be useful for your use-case.</li> </ul>"},{"location":"get_started/about/#transformer-specifications","title":"Transformer specifications","text":"<p>A <code>Transformer</code> needs a couple of specifications (<code>user_specs</code>) and a cooling type (in <code>cooling_type</code>). The specifications are defined in <code>transformer_thermal_model.schemas.UserTransformerSpecifications</code>, and are a composition of some mandatory specifications and some optionals. When the optionals are left unchanged, the default values per class will be used. These can be found by <code>defaults</code>, e.g. <code>PowerTransformer.defaults</code> will show you the default specifications.</p> <p>An example on how to initialise a <code>PowerTransformer</code>:</p> <pre><code>from transformer_thermal_model.cooler import CoolerType\nfrom transformer_thermal_model.transformer import PowerTransformer\nfrom transformer_thermal_model.schemas import UserTransformerSpecifications\n\ntr_specs = UserTransformerSpecifications(\n   load_loss=1000,  # Transformer load loss [W]\n   nom_load_sec_side=1500,  # Transformer nominal current secondary side [A]\n   no_load_loss=200,  # Transformer no-load loss [W]\n   amb_temp_surcharge=20,  # Ambient temperature surcharge [K]\n)\ntransformer = PowerTransformer(user_specs=tr_specs, cooling_type=CoolerType.ONAF)\n</code></pre> <p>It is recommended to adjust the following parameters when modelling a specific transformer as these influence the thermal modelling and are transformer-specifically defined (the ones with a '*' are mandatory):</p> <ul> <li><code>load_loss</code>*: load loss of the transformer.</li> <li><code>no_load_loss</code>*: no load loss of the transformer.</li> <li><code>nom_load_sec_side</code>*: nominal current of the secondary side of   the transformer.</li> <li><code>amb_temp_surcharge</code>*:</li> <li><code>PowerTransformer</code>: temperature surcharge on ambient temperature due to     installation conditions.</li> <li><code>DistributionTransformer</code>: Building or placement thermal classification.</li> <li><code>top_oil_temp_rise</code>: top-oil temperature increase under   nominal conditions.</li> <li><code>winding_oil_gradient</code>: temperature difference between the average winding and average oil temperature under nominal conditions</li> <li><code>hot_spot_fac</code>: factor determining the temperature difference between top-oil and hot-spot. Only specify when known, otherwise see hot-spot factor calibration.</li> </ul>"},{"location":"get_started/about/#cooler","title":"Cooler","text":"<p><code>transformer_thermal_model.cooler</code>: Similarly, you must provide the type of cooling of your transformer. This is only for a <code>PowerTransformer</code>, since a <code>DistributionTransformer</code> is always ONAN. To adjust the cooler type for a <code>PowerTransformer</code>, you can do the following:</p> <pre><code>from transformer_thermal_model.transformer import PowerTransformer\nfrom transformer_thermal_model.cooler import CoolerType\nfrom transformer_thermal_model.schemas import UserTransformerSpecifications\n\ntr_specs = UserTransformerSpecifications(\n                load_loss=10000,\n                nom_load_sec_side=1000,\n                no_load_loss=1000,\n                amb_temp_surcharge=0,\n            )\n\n# You can create a power transformer with ONAF cooling.\nonaf_trafo = PowerTransformer(user_specs = tr_specs, cooling_type = CoolerType.ONAF)\n# Or you can create a power transformer with ONAN cooling\nonan_trafo = PowerTransformer(user_specs = tr_specs, cooling_type = CoolerType.ONAN)\n</code></pre>"},{"location":"get_started/about/#hot-spot-factor-calibration-for-power-transformers","title":"Hot-spot factor calibration for power transformers","text":"<p>When the hot-spot factor of a transformer is known, it can be given as a specification as <code>hot_spot_fact</code> in a <code>UserTransformerSpecifications</code> object.</p> <p>It often occurs, however, that a transformer hot-spot factor is not known. If this is the case, a hot-spot factor calibration can be performed to determine the hot-spot factor of a given <code>PowerTransformer</code> object. Note that for <code>DistributionTransformer</code> objects, hot-spot calibrations should not be performed and the default value can be used. For both the <code>PowerTransformer</code> and the <code>DistributionTransformer</code> the <code>hot_spot_fac</code> in the specification is set to the default value of no hot-spot factor is provided via the <code>UserTransformerSpecifications</code>.</p> <p>The following example shows how to calibrate a <code>PowerTransformer</code> object.</p> <pre><code>from transformer_thermal_model.cooler import CoolerType\nfrom transformer_thermal_model.schemas import UserTransformerSpecifications\nfrom transformer_thermal_model.transformer import PowerTransformer\nfrom transformer_thermal_model.hot_spot_calibration import calibrate_hotspot_factor\n\ntr_specs = UserTransformerSpecifications(\n   load_loss=1000,  # Transformer load loss [W]\n   nom_load_sec_side=1500,  # Transformer nominal current secondary side [A]\n   no_load_loss=200,  # Transformer no-load loss [W]\n   amb_temp_surcharge=20,  # Ambient temperature surcharge [K]\n)\nuncalibrated_transformer = PowerTransformer(user_specs=tr_specs, cooling_type=CoolerType.ONAF)\ncalibrated_trafo = calibrate_hotspot_factor(\n   uncalibrated_transformer=uncalibrated_transformer,\n   ambient_temp=20.0,\n   hot_spot_limit=98, # in most cases a hot-spot temperature limit of 98 can be used\n   hot_spot_factor_min=1.1,\n   hot_spot_factor_max=1.3,\n)\n</code></pre> <p>The new hot-spot factor is available via <code>calibrated_trafo.specs.hot_spot_fac</code>, and from now on used in the thermal model.</p> <pre><code>&gt;&gt;&gt; print(calibrated_trafo.specs.hot_spot_fac)\n1.1\n</code></pre>"},{"location":"get_started/about/#component-capacities-of-a-power-transformer","title":"Component capacities of a power transformer","text":"<p>For load capacity calculations it can be required to take into account the capacity of the different components of a power transformers. Therefore a functionality is available to calculate the relative capacity of the tap changers, the bushings (primary and secondary) and the internal current transformer. The capacity is defined as the ratio of the component capacity and the nominal load of the transformer.</p> <p>The capacities are properties of the <code>PowerTransformer</code> and require the <code>TransformerComponentSpecifications</code> to be given during initiating a PowerTransformer object.</p> <p>In the following example for all components the required information is provided.</p> <pre><code>from transformer_thermal_model.components import BushingConfig, TransformerSide, VectorConfig\nfrom transformer_thermal_model.cooler import CoolerType\nfrom transformer_thermal_model.schemas import (\n    TransformerComponentSpecifications,\n    UserTransformerSpecifications,\n)\nfrom transformer_thermal_model.transformer import PowerTransformer\n\ncomp_specs = TransformerComponentSpecifications(\n        tap_chang_capacity=600,  # Tap changer nominal current [A]\n        nom_load_prim_side=550,  # Transformer nominal current primary side [A]\n        tap_chang_conf=VectorConfig.TRIANGLE_OUTSIDE,  # Tap Changer configuration\n        tap_chang_side=TransformerSide.SECONDARY,  # Tap changer side\n        prim_bush_capacity=600,  # Primary bushing nominal current [A]\n        prim_bush_conf=BushingConfig.SINGLE_BUSHING,  # Primary bushing configuration\n        sec_bush_capacity=1800,  # Secondary bushing nominal current [A]\n        sec_bush_conf=BushingConfig.SINGLE_BUSHING,  # Secondary bushing configuration\n        cur_trans_capacity=1300,  # Current transformer nominal current [A]\n        cur_trans_conf=VectorConfig.STAR,  # Current transformer configuration\n        cur_trans_side=TransformerSide.PRIMARY,  # Current transformer side\n    )\nuser_specs = UserTransformerSpecifications(\n        load_loss=1000,  # Transformer load loss [W]\n        nom_load_sec_side=1500,  # Transformer nominal current secondary side [A]\n        no_load_loss=200,  # Transformer no-load loss [W]\n        amb_temp_surcharge=20,\n    )\npower_transformer = PowerTransformer(\n        user_specs=user_specs, cooling_type=CoolerType.ONAF, internal_component_specs=comp_specs\n    )\n</code></pre> <p>The resulting component capacities are available in <code>power_transformer.component_capacities</code>:</p> <pre><code>&gt;&gt;&gt; print(power_transformer.component_capacities)\n{'tap_changer': 0.4, 'primary_bushings': 1.0909090909090908, 'secondary_bushings': 1.2, 'current_transformer': 2.3636363636363638}\n</code></pre> <p>Note that it is also possible to only define a subset of the components if not all components are present. Then only the component capacities of the provided components are available:</p> <pre><code>comp_specs = TransformerComponentSpecifications(\n    tap_chang_capacity=600,  # Tap changer nominal current [A]\n    nom_load_prim_side=550,  # Transformer nominal current primary side [A]\n    tap_chang_conf=VectorConfig.TRIANGLE_OUTSIDE,  # Tap Changer configuration\n    tap_chang_side=TransformerSide.SECONDARY,  # Tap changer side\n)\npower_transformer = PowerTransformer(\n        user_specs=user_specs, cooling_type=CoolerType.ONAF, internal_component_specs=comp_specs\n    )\n</code></pre> <p>This will generate the following result:</p> <pre><code>&gt;&gt;&gt; print(power_transformer.component_capacities)\n{'tap_changer': 0.4, 'primary_bushings': None, 'secondary_bushings': None, 'current_transformer': None}\n</code></pre>"},{"location":"get_started/about/#thermal-modelling","title":"Thermal modelling","text":"<p>When a <code>Transformer</code> object is completely defined, the temperatures can be calculated using <code>transformer_thermal_model.model</code>: the core of the package. The <code>Model</code> is built as follows:</p> <pre><code>import pandas as pd\n\nfrom transformer_thermal_model.model import Model\nfrom transformer_thermal_model.cooler import CoolerType\nfrom transformer_thermal_model.schemas import UserTransformerSpecifications, InputProfile\nfrom transformer_thermal_model.transformer import PowerTransformer\n\n# In this example the model is used to calculate the transformer temperature based on a load and ambient\n# profile with a period of one week. Any duration can be chosen preferably with timestamps with an interval of\n# 15 minute or lower. Larger timesteps will result in incorrect results but it *is* possible to calculate with them.\none_week = 4*24*7\ndatetime_index = pd.date_range(\"2020-01-01\", periods=one_week, freq=\"15min\")\n\n# For the load (in A) and ambient temperature (in C) arbitrary constants profiles are chosen.\n# It is also possible to use a realistic profile.\nnominal_load = 100\nload_points = pd.Series([nominal_load] * one_week, index=datetime_index)\nambient_temp = 21\ntemperature_points = pd.Series([ambient_temp] * one_week, index=datetime_index)\n\n# Create an input object with the profiles\nprofile_input = InputProfile.create(\n   datetime_index = datetime_index,\n   load_profile = load_points,\n   ambient_temperature_profile = temperature_points\n)\n\n# Initialise a power transformer with cooling type ONAF and, besides the mandatory user specifications, default values.\ntr_specs = UserTransformerSpecifications(\n   load_loss=1000,  # Transformer load loss [W]\n   nom_load_sec_side=1500,  # Transformer nominal current secondary side [A]\n   no_load_loss=200,  # Transformer no-load loss [W]\n   amb_temp_surcharge=20,  # Ambient temperature surcharge [K]\n)\ntransformer = PowerTransformer(user_specs=tr_specs, cooling_type=CoolerType.ONAF)\nmodel = Model(\n   temperature_profile = profile_input,\n   transformer = transformer\n)\n\nresults = model.run()\n\n# Get the results as pd.Series, with the same datetime_index as your input.\ntop_oil_temp_profile = results.top_oil_temp_profile\nhot_spot_temp_profile = results.hot_spot_temp_profile\n</code></pre> <pre><code>&gt;&gt;&gt; top_oil_temp_profile.head(3)\n2020-01-01 00:00:00    41.000000\n2020-01-01 00:15:00    43.639919\n2020-01-01 00:30:00    45.801302\n\n&gt;&gt;&gt; hot_spot_temp_profile.head(3)\n2020-01-01 00:00:00    41.000000\n2020-01-01 00:15:00    44.381177\n2020-01-01 00:30:00    46.740013\n</code></pre> <p>You can use the <code>Model</code> to run a calculation with either a <code>PowerTransformer</code> or a <code>DistributionTransformer</code>. The model will return <code>results</code> with the <code>top_oil_temperature</code> and <code>hot_spot_temperature</code> as <code>pd.Series</code>. More specifically, the output will be in the form of <code>OutputProfile</code>, as defined in <code>transformer_thermal_model.schemas</code>. The reason for using pd.Series as output, is that the model uses the <code>index</code> of the series that you have provided to run the calculation, which also creates the benefit for you that you can relate the result to your provided input for eventual cross-validation or analysis.</p>"},{"location":"get_started/about/#three-winding-transformer-modelling","title":"Three winding Transformer modelling","text":"<p>The model also supports thermal modeling of three-winding transformers. To use this feature, provide both a <code>ThreeWindingTransformer</code> and a <code>ThreeWindingInputProfile</code> as input to the <code>Model</code>. The <code>ThreeWindingInputProfile</code> requires a separate load profile for each winding (high, medium, and low voltage sides), all sharing the same length and datetime index.</p> <p>With <code>UserThreeWindingTransformerSpecifications</code>, you can specify the nominal load and winding oil gradient for each winding, as well as the load losses between windings. The resulting hot-spot temperature profile is returned as a DataFrame with columns for each winding, making it easy to analyze the results for each part of the transformer.</p> <pre><code>import pandas as pd\n\nfrom transformer_thermal_model.cooler import CoolerType\nfrom transformer_thermal_model.model import Model\nfrom transformer_thermal_model.schemas import (\n    ThreeWindingInputProfile,\n    UserThreeWindingTransformerSpecifications,\n    WindingSpecifications,\n)\nfrom transformer_thermal_model.transformer import ThreeWindingTransformer\n\n# Define the time range for your simulation\none_week = 4 * 24 * 7\ndatetime_index = pd.date_range(\"2020-01-01\", periods=one_week, freq=\"15min\")\n\n# Create ambient temperature profile (can be a constant or a realistic profile)\nambient_temp = 21\ntemperature_points = pd.Series([ambient_temp] * one_week, index=datetime_index)\n\n# Create load profiles for each winding (high, medium, low voltage sides)\nload_profile_high_voltage_side = pd.Series([2000] * one_week, index=datetime_index)\nload_profile_middle_voltage_side = pd.Series([1500] * one_week, index=datetime_index)\nload_profile_low_voltage_side = pd.Series([1000] * one_week, index=datetime_index)\n\n# Create the input profile for the three-winding transformer\nprofile_input = ThreeWindingInputProfile.create(\n    datetime_index=datetime_index,\n    ambient_temperature_profile=temperature_points,\n    load_profile_high_voltage_side=load_profile_high_voltage_side,\n    load_profile_middle_voltage_side=load_profile_middle_voltage_side,\n    load_profile_low_voltage_side=load_profile_low_voltage_side,\n)\n\n# Define the transformer specifications for each winding\nuser_specs = UserThreeWindingTransformerSpecifications(\n    no_load_loss=20,\n    amb_temp_surcharge=10,\n    lv_winding=WindingSpecifications(\n        nom_load=1000, winding_oil_gradient=20, hot_spot_fac=1.2, time_const_winding=1, nom_power=1000\n    ),\n    mv_winding=WindingSpecifications(\n        nom_load=1000, winding_oil_gradient=20, hot_spot_fac=1.2, time_const_winding=1, nom_power=1000\n    ),\n    hv_winding=WindingSpecifications(\n        nom_load=2000, winding_oil_gradient=20, hot_spot_fac=1.2, time_const_winding=1, nom_power=2000\n    ),\n    load_loss_hv_lv=100,\n    load_loss_hv_mv=100,\n    load_loss_mv_lv=100,\n)\n\n# Create the transformer object\ntransformer = ThreeWindingTransformer(user_specs=user_specs, cooling_type=CoolerType.ONAN)\n\n# Run the thermal model\nmodel = Model(\n    temperature_profile=profile_input,\n    transformer=transformer\n)\nresults = model.run()\n\n# The results are returned as pandas Series/DataFrame, indexed by your datetime_index\ntop_oil_temp_profile = results.top_oil_temp_profile\nhot_spot_temp_profile = results.hot_spot_temp_profile\n\ntop_oil_temp_profile = results.top_oil_temp_profile\nhot_spot_temp_profile = results.hot_spot_temp_profile\n</code></pre> <pre><code>&gt;&gt;&gt; top_oil_temp_profile.head()\n2020-01-01 00:00:00    31.000000\n2020-01-01 00:15:00    40.212693\n2020-01-01 00:30:00    48.198972\n2020-01-01 00:45:00    55.122101\n2020-01-01 01:00:00    61.123609\n\n```text\n&gt;&gt;&gt; hot_spot_temp_profile.head()\n                          low_voltage_side   middle_voltage_side   high_voltage_side\n2020-01-01 00:00:00           31.000000           31.000000           31.000000\n2020-01-01 00:15:00           84.991214          116.068422           84.991214\n2020-01-01 00:30:00           90.234413          119.407866           90.234413\n2020-01-01 00:45:00           94.756639          122.263816           94.756639\n2020-01-01 01:00:00           98.676844          124.739555           98.676844\n</code></pre>"},{"location":"get_started/about/#using-the-top-oil-temperature-as-an-input-to-the-model","title":"Using the top oil temperature as an input to the model","text":"<p>Optionally, you can provide the top oil temperature as an input parameter to the <code>InputProfile</code> to use it in place of the ambient temperature as an input to the model:</p> <pre><code>import pandas as pd\n\nfrom transformer_thermal_model.model import Model\nfrom transformer_thermal_model.cooler import CoolerType\nfrom transformer_thermal_model.schemas import UserTransformerSpecifications, InputProfile\nfrom transformer_thermal_model.transformer import PowerTransformer\n\none_week = 4*24*7\ndatetime_index = pd.date_range(\"2020-01-01\", periods=one_week, freq=\"15min\")\n\nnominal_load = 100\nload_points = pd.Series([nominal_load] * one_week, index=datetime_index)\nambient_temp = 21\ntemperature_points = pd.Series([ambient_temp] * one_week, index=datetime_index)\ntop_oil_temp = 42\ntop_oil_points = pd.Series([top_oil_temp] * one_week, index=datetime_index)\n\nprofile_input = InputProfile.create(\n   datetime_index = datetime_index,\n   load_profile = load_points,\n   ambient_temperature_profile = temperature_points,\n   # Here is where we add the top oil temperature as an input. It has the same shape as the ambient temperature.\n   top_oil_temperature_profile = top_oil_points\n)\n\ntr_specs = UserTransformerSpecifications(\n   load_loss=1000,  # Transformer load loss [W]\n   nom_load_sec_side=1500,  # Transformer nominal current secondary side [A]\n   no_load_loss=200,  # Transformer no-load loss [W]\n   amb_temp_surcharge=20,  # Ambient temperature surcharge [K]\n)\ntransformer = PowerTransformer(user_specs=tr_specs, cooling_type=CoolerType.ONAF)\nmodel = Model(\n   temperature_profile = profile_input,\n   transformer = transformer\n)\n\n# As we have provided the top oil temperature as an input, this is now being used in place of the ambient temperature.\n# If you still want to use the top oil temperature you can do so using model.run(force_use_ambient_temperature=True)\nresults = model.run()\n\ntop_oil_temp_profile = results.top_oil_temp_profile\nhot_spot_temp_profile = results.hot_spot_temp_profile\n</code></pre> <pre><code>&gt;&gt;&gt; top_oil_temp_profile.head(3)\n2020-01-01 00:00:00    42.0\n2020-01-01 00:15:00    42.0\n2020-01-01 00:30:00    42.0\n\n&gt;&gt;&gt; hot_spot_temp_profile.head(3)\n2020-01-01 00:00:00    42.000000\n2020-01-01 00:15:00    42.741258\n2020-01-01 00:30:00    42.938711\n</code></pre> <p>Note, how the top oil temperature we receive as the output <code>results.top_oil_temp_profile</code> exactly matches the top oil temperature we provided as the input.</p>"},{"location":"get_started/about/#model-a-transformer-that-switches-between-onan-and-onaf","title":"Model a transformer that switches between ONAN and ONAF","text":"<p>Some transformers operate with forced cooling (ONAF) only when needed. When the cooling fans are OFF, the transformer is in ONAN mode. When the fans are ON, the transformer is in ONAF mode. The library supports modelling a transformer that dynamically switches between these modes using the <code>CoolingSwitchController</code> and an <code>CoolingSwitchSettings</code> configuration object.</p> <p>You can configure switching in two mutually exclusive ways:</p> <ol> <li>Fan status schedule (historical or planned operation): provide a list of booleans (<code>fan_on</code>) indicating   for each time step whether the fans are ON (<code>True</code>) or OFF (<code>False</code>).</li> <li>Temperature threshold control: provide activation and deactivation temperatures. The fans turn ON when the   top\u2011oil temperature reaches the activation temperature and turn OFF when it falls below the deactivation temperature.</li> </ol> <p>In both cases, you must also supply a set of ONAN parameters (<code>onan_parameters</code>) describing the specification values that differ when the fans are OFF (such as nominal load, winding oil gradient, hot\u2011spot factor, losses, and time constants).</p> <p>The <code>CoolingSwitchController</code> keeps a deep copy of the original ONAF specifications and, whenever a switch event occurs, applies either the ONAN parameters or restores the original ONAF specifications. Switching is evaluated at each time step during the thermal model run, so temperature profiles reflect the current cooling mode immediately.</p>"},{"location":"get_started/about/#1-switching-using-a-fan-status-schedule","title":"1. Switching using a fan status schedule","text":"<pre><code>import pandas as pd\n\nfrom transformer_thermal_model.cooler import CoolerType\nfrom transformer_thermal_model.model import Model\nfrom transformer_thermal_model.schemas import InputProfile, UserTransformerSpecifications\nfrom transformer_thermal_model.schemas.thermal_model import CoolingSwitchSettings, ONANParameters\nfrom transformer_thermal_model.transformer import PowerTransformer\n\n# User (ONAF) specifications\nuser_specs = UserTransformerSpecifications(\n  load_loss=1000,\n  nom_load_sec_side=1500,\n  no_load_loss=200,\n  amb_temp_surcharge=20,\n  time_const_windings=10,\n)\n\n# ONAN specifications used when fans are OFF (values that differ from ONAF mode)\nonan_params = ONANParameters(\n  top_oil_temp_rise=65,            # Different top\u2011oil rise\n  time_const_oil=8,                # Different oil time constant\n  time_const_windings=10,\n  load_loss=1000,\n  nom_load_sec_side=1200,          # Lower nominal current in ONAN mode\n  winding_oil_gradient=20,\n  hot_spot_fac=1.3,\n)\n\n# Create a schedule: first half OFF (ONAN), second half ON (ONAF)\nfan_on = [False]*2*24*7 + [True]*2*24*7  # Example for a week with 15-min intervals\n\nonaf_switch = CoolingSwitchSettings(\n  fan_on=fan_on,\n  onan_parameters=onan_params,\n)\n\ntransformer = PowerTransformer(\n  user_specs=user_specs,\n  cooling_type=CoolerType.ONAF,   # Overall transformer supports ONAF\n  cooling_switch_settings=onaf_switch,\n)\none_week = 4*24*7\ndatetime_index = pd.date_range(\"2020-01-01\", periods=one_week, freq=\"15min\")\n\nnominal_load = 100\nload_points = pd.Series([nominal_load] * one_week, index=datetime_index)\nambient_temp = 21\ntemperature_points = pd.Series([ambient_temp] * one_week, index=datetime_index)\n\nprofile_input = InputProfile.create(\n   datetime_index = datetime_index,\n   load_profile = load_points,\n   ambient_temperature_profile = temperature_points,\n)\n\nmodel = Model(transformer=transformer, temperature_profile=profile_input)\nresults = model.run()\n</code></pre> <p>During the run the model applies ONAN parameters for the initial OFF section, then switches to the original ONAF specs when <code>fan_on</code> becomes <code>True</code>.</p>"},{"location":"get_started/about/#2-switching-using-temperature-thresholds","title":"2. Switching using temperature thresholds","text":"<pre><code>import pandas as pd\n\nfrom transformer_thermal_model.cooler import CoolerType\nfrom transformer_thermal_model.model import Model\nfrom transformer_thermal_model.schemas import InputProfile, UserTransformerSpecifications\nfrom transformer_thermal_model.schemas.thermal_model import CoolingSwitchConfig, CoolingSwitchSettings, ONANParameters\nfrom transformer_thermal_model.transformer import PowerTransformer\n\n# User (ONAF) specifications\nuser_specs = UserTransformerSpecifications(\n  load_loss=1000,\n  nom_load_sec_side=1500,\n  no_load_loss=200,\n  amb_temp_surcharge=20,\n  time_const_windings=10,\n)\n\nonan_params = ONANParameters(\n  top_oil_temp_rise=65,            \n  time_const_oil=8,                \n  time_const_windings=10,\n  load_loss=1000,\n  nom_load_sec_side=1200,\n  winding_oil_gradient=20,\n  hot_spot_fac=1.3,\n)\n\n# Fans turn ON at 70 \u00b0C and OFF again at 60 \u00b0C\nthreshold = CoolingSwitchConfig(activation_temp=70, deactivation_temp=60)\n\nonaf_switch = CoolingSwitchSettings(\n  temperature_threshold=threshold,\n  onan_parameters=onan_params,\n)\n\ntransformer = PowerTransformer(\n  user_specs=user_specs,\n  cooling_type=CoolerType.ONAF\n  ,\n  cooling_switch_settings=onaf_switch,\n)\none_week = 4*24*7\ndatetime_index = pd.date_range(\"2020-01-01\", periods=one_week, freq=\"15min\")\n\nnominal_load = 100\nload_points = pd.Series([nominal_load] * one_week, index=datetime_index)\nambient_temp = 21\ntemperature_points = pd.Series([ambient_temp] * one_week, index=datetime_index)\n\n\nprofile_input = InputProfile.create(\n   datetime_index = datetime_index,\n   load_profile = load_points,\n   ambient_temperature_profile = temperature_points,\n)\n\nresults = Model(transformer=transformer, temperature_profile=profile_input).run()\n</code></pre> <p>Each time step the controller compares the previous and current top\u2011oil temperature to the activation / deactivation thresholds and switches mode accordingly.</p>"},{"location":"get_started/about/#threewinding-transformers","title":"Three\u2011winding transformers","text":"<p>For three\u2011winding transformers a dedicated <code>ThreeWindingCoolingSwitchSettings</code> and <code>ThreeWindingONANParameters</code> are available, allowing you to specify ONAN parameters per winding (LV, MV, HV) and the separate load losses. Usage is analogous:</p> <pre><code>import pandas as pd\n\nfrom transformer_thermal_model.cooler import CoolerType\nfrom transformer_thermal_model.model import Model\nfrom transformer_thermal_model.schemas import (\n  ThreeWindingInputProfile,\n  UserThreeWindingTransformerSpecifications,\n  WindingSpecifications,\n)\nfrom transformer_thermal_model.schemas.thermal_model.onaf_switch import (\n  ThreeWindingCoolingSwitchSettings,\n  ThreeWindingONANParameters,\n)\nfrom transformer_thermal_model.transformer import ThreeWindingTransformer\n\nonan_parameters = ThreeWindingONANParameters(\n  lv_winding=WindingSpecifications(\n    nom_load=900, winding_oil_gradient=20, hot_spot_fac=1.2, \n    time_const_winding=1, nom_power=1000),\n  mv_winding=WindingSpecifications(\n    nom_load=900, winding_oil_gradient=20, hot_spot_fac=1.2, \n    time_const_winding=1, nom_power=1000),\n  hv_winding=WindingSpecifications(\n    nom_load=1800, winding_oil_gradient=20, hot_spot_fac=1.2,\n     time_const_winding=1, nom_power=2000),\n  top_oil_temp_rise=60,\n  time_const_oil=150,\n  load_loss_mv_lv=100,\n  load_loss_hv_lv=100,\n  load_loss_hv_mv=100,\n)\n\nswitch_cfg = ThreeWindingCoolingSwitchSettings(\n  fan_on=[False]*144 + [True]*144,\n  onan_parameters=onan_parameters,\n)\n\nuser_specs = UserThreeWindingTransformerSpecifications(\n  no_load_loss=20,\n  amb_temp_surcharge=10,\n  lv_winding=WindingSpecifications(\n    nom_load=1000, winding_oil_gradient=20, hot_spot_fac=1.2, \n    time_const_winding=1, nom_power=1000),\n  mv_winding=WindingSpecifications(\n    nom_load=1000, winding_oil_gradient=20, hot_spot_fac=1.2, \n    time_const_winding=1, nom_power=1000),\n  hv_winding=WindingSpecifications(\n    nom_load=2000, winding_oil_gradient=20, hot_spot_fac=1.2, \n    time_const_winding=1, nom_power=2000),\n  load_loss_hv_lv=100,\n  load_loss_hv_mv=100,\n  load_loss_mv_lv=100,\n)\n\ntransformer = ThreeWindingTransformer(\n  user_specs=user_specs,\n  cooling_type=CoolerType.ONAF,\n  cooling_switch_settings=switch_cfg,\n)\n\n# Create the input profile for the three-winding transformer\ndatetime_index = [pd.to_datetime(\"2025-07-01 00:00:00\") + pd.Timedelta(minutes=15 * i) for i in range(0, 288)]\nprofile_input = ThreeWindingInputProfile.create(\n    datetime_index=datetime_index,\n    ambient_temperature_profile=pd.Series(data=900, index=datetime_index),\n    load_profile_high_voltage_side=pd.Series(data=500, index=datetime_index),\n    load_profile_middle_voltage_side=pd.Series(data=500, index=datetime_index),\n    load_profile_low_voltage_side=pd.Series(data=300, index=datetime_index),\n)\n\nresults = Model(transformer=transformer, temperature_profile=profile_input).run()\n</code></pre>"},{"location":"get_started/about/#when-should-you-use-switching","title":"When should you use switching?","text":"<p>Use dynamic switching when:</p> <ul> <li>You want more realistic temperature profiles under partial cooling operation.</li> <li>You need to assess thermal limits or aging for both fan operating states.</li> <li>You are performing what\u2011if analyses on fan activation strategy.</li> </ul> <p>If your transformer always runs with fans engaged (forced cooling), simply use <code>CoolerType.ONAF</code> without a switch configuration.</p> <p>See the example notebook <code>examples/example_ONAN_ONAF_switch.ipynb</code> for a full demonstration with plots.</p>"},{"location":"get_started/about/#license","title":"License","text":"<p>This project is licensed under the Mozilla Public License, version 2.0 - see LICENSE for details.</p>"},{"location":"get_started/about/#licenses-third-party-libraries","title":"Licenses third-party libraries","text":"<p>This project includes third-party libraries, which are licensed under their own respective Open-Source licenses. SPDX-License-Identifier headers are used to show which license is applicable.</p> <p>The concerning license files can be found in the LICENSES directory.</p>"},{"location":"get_started/about/#contributing","title":"Contributing","text":"<p>Please read CODE_OF_CONDUCT, CONTRIBUTING and PROJECT GOVERNANCE for details on the process for submitting pull requests to us.</p>"},{"location":"get_started/about/#contact","title":"Contact","text":"<p>Please read SUPPORT for how to connect and get into contact with the Transformer Thermal Model project.</p>"},{"location":"get_started/model_input/","title":"Model input","text":""},{"location":"get_started/model_input/#model-input","title":"Model input","text":"<p>The thermal model requires four inputs:</p> <ol> <li>Relevant transformer specifications</li> <li>Load profile</li> <li>Ambient temperature profile</li> <li>Initial value hot-spot and top-oil temperature</li> </ol>"},{"location":"get_started/model_input/#relevant-transformer-specifications","title":"Relevant transformer specifications","text":"<p>Below are all transformer-specific properties that influence the thermal behavior of the transformer:</p>"},{"location":"get_started/model_input/#nominal-secondary-current","title":"Nominal secondary current","text":"<ul> <li> <p>Unit: Amp\u00e8re.</p> </li> <li> <p>Description: The nominal current on the secondary side of the transformer. When the transformer carries this current on the secondary side, we refer to it as 100% loading of the transformer.</p> </li> <li> <p>Source: Nameplate on the transformer or Factory Acceptance Test (FAT) report.</p> </li> <li> <p>Fallback/guarantee value: n/a (always known)</p> </li> </ul>"},{"location":"get_started/model_input/#no-load-loss","title":"No-load loss","text":"<ul> <li>Unit: Watt.</li> <li>Description: The no-load loss refers to the losses within a transformer that are always present when the transformer is energized, even when there is no load connected to the transformer. These losses occur in the core of the transformer, which is magnetized by the alternating current. For this reason, they are also called iron losses or core losses. These losses mostly translate into heat, making this parameter an important thermal property.</li> <li>Source:  Factory Acceptance Test (FAT) report: during these tests, a no-load test is performed to determine these losses. This test is conducted individually for each transformer.</li> <li>Fallback/guarantee value: This value is usually known.</li> </ul>"},{"location":"get_started/model_input/#short-circuit-loss","title":"Short-circuit loss","text":"<ul> <li>Unit: Watt.</li> <li>Description: The short-circuit loss is the counterpart of the no-load loss. This type of loss is load-dependent and represents the losses in the windings due to resistance. For this reason, they are also called copper losses. These losses are quadratically dependent on the current.</li> <li>Source: Factory Acceptance Test (FAT) report: during these tests, a short-circuit test is performed to determine the short-circuit losses at a nominal short-circuit current. This test is conducted individually for each transformer.</li> <li>Fallback/guarantee value: This value is usually known.</li> </ul>"},{"location":"get_started/model_input/#top-oil-temperature-rise","title":"Top-oil temperature rise","text":"<ul> <li>Unit: Kelvin.</li> <li>Description: The top-oil temperature is the temperature at the top of the transformer. During a heating test of the transformer, this temperature is measured under nominal and constant load. The top-oil temperature rise indicates how much the temperature of the top-oil rises above the ambient temperature when it stabilizes under these nominal conditions.</li> <li> <p>Source: Factory Acceptance Test (FAT) report: during these tests, a temperature-rise test is performed on the transformer. Often, this test is only performed for one transformer per series. If the information is not available for a specific transformer, a temperature-rise test of a comparable transformer can be used.</p> </li> <li> <p>Fallback/guarantee value: If no temperature-rise test is available for any transformer in the series, the guaranteed value of the top-oil temperature rise can be used. For all modern transformers, this is 60 Kelvin. For very old transformers, this can sometimes fall back to 55 or 50 Kelvin. These guaranteed values can always by found on the type plate.</p> </li> </ul>"},{"location":"get_started/model_input/#winding-oil-gradient","title":"Winding-oil gradient","text":"<ul> <li>Unit: Kelvin.</li> <li>Description: To determine the temperature drop between the winding and the oil, the winding-oil gradient is an important thermal property of a transformer. This can also be determined during a temperature-rise test by taking the difference between the average oil temperature rise and the average winding temperature rise.</li> <li>Source: Factory Acceptance Test (FAT) report: during these tests, a temperature-rise test is performed on the transformer. Often, this test is only performed for one transformer per series. If the information is not available for a specific transformer, a comparable transformer can be used.</li> <li>Fallback/guarantee value: The average oil temperature rise is not always known from a heating test. In that case, the average oil temperature rise can be estimated at 80% of the top-oil temperature rise. If the average winding temperature rise is not known, the guarantee value can be used. For all modern transformers, this is 65 Kelvin. For very old transformers, this can sometimes fall back to 60 or 55 Kelvin. Assuming a 60 Kelvin top-oil temperature rise and a 65 Kelvin average winding temperature rise, a gradient of 17 Kelvin can be assumed (gradient = (average winding temperature) - 0.8*(top-oil temperature)).</li> </ul>"},{"location":"get_started/model_input/#hot-spot-factor","title":"Hot-spot factor","text":"<ul> <li>Unit: unitless.</li> <li> <p>Description: The hot-spot factor, together with the gradient, indicates the difference between the hot-spot temperature and the top-oil temperature.</p> </li> <li> <p>Source: Factory Acceptance Test (FAT) report: during these tests, a temperature-rise test is performed on the transformer. Often, this test is only performed for one transformer per series. If the information is not available for a specific transformer, a comparable transformer can be used.</p> </li> <li> <p>Fallback/guarantee value: The hot-spot factor is often not known from the temperature-rise test. In that case, the worst-case hot-spot factor of 1.3 can be used. It is generally expected that the hot-spot factor ranges between 1.1 and 1.3. Whether these are indeed the most extreme limits is not certain. It should be noted that for older transformers, the hot-spot factor can be much higher. This is due to the use of solid wire, where eddy current losses in the upper regions of the windings are higher than with modern CTC wire (= continuously transposed conductor).</p> </li> <li> <p>Hot-spot factor calibration: The hot-spot factor can be calibrated using the model. For more information, see Hot-spot factor calibration.</p> </li> </ul>"},{"location":"get_started/model_input/#cooling-type","title":"Cooling type","text":"<ul> <li>Unit: n/a</li> <li> <p>Description: The transformer can generally be cooled in two ways:</p> </li> <li> <p>ONAN: Oil Natural, Air Natural. In this type of transformer, both the flow of the oil and the flow of the   air along the radiators are natural. The oil is heated, rises, and is pushed into the radiators without actively   forcing this flow to appear. The oil then cools in the radiators, sinks down, and is pushed into the oil tank. The air   between the radiators is heated and rises. This creates a natural airflow along the radiators.</p> </li> <li> <p>ONAF: Oil Natural, Air Forced. The difference with ONAN is that fans are placed under the radiators. These   force an active airflow between the radiators. This allows the oil to more easily transfer its heat to the   environment.</p> </li> <li> <p>Source: Nameplate on the transformer.</p> </li> <li> <p>Fallback/guarantee value: n/a</p> </li> </ul>"},{"location":"get_started/model_input/#ambient-temperature-surcharge","title":"Ambient temperature surcharge","text":"<ul> <li>Unit: Kelvin.</li> <li>Description: This parameter is used differently for distribution and power transformers:</li> <li>Power transformers: For this type of transformer it is expected to be placed outside. In that case, this     parameter should be set to 0 and does nothing. In some cases, however, power transformers are placed inside. In that     situation, it is more difficult for the heat to escape the surroundings of the transformer. Therefore, a 10 Kelvin     temperature surcharge can be filled in here, which will be added to the ambient temperature to compensate for this     phenomenon. Other values can of course also be chosen.</li> <li>Distribution transformers: Distribution transformers are (in the Netherlands) always placed inside. Still, a     distinction can be made between compact and normal stations. As the name suggests, compact stations have a lot less     free space, which means the surroundings heat up a lot quicker. To take this phenomenon into account a temperature     surcharge can be added to the rated top-oil temperature rise, which is also a transformer specification.</li> <li>Source:: n/a</li> <li>Fallback/guarantee value: n/a</li> </ul>"},{"location":"get_started/model_input/#relevant-constants-for-winding-and-oil","title":"Relevant constants for winding and oil","text":"<p>The transformer model uses several constants that characterize the thermal behavior of the windings and the oil in the transformer. Values for these constants can be experimentally determined. The loading guide also recommends some conservative values for these constants (IEC 60076-7, Table 4):</p> <ul> <li> <p>Oil exponent x: Determines how the top-oil temperature depends on the load level and the losses of the transformer.</p> </li> <li> <p>Winding exponent y: Determines how the gradient depends on the load level of the transformer.</p> </li> <li> <p>Oil constant \\(k_{11}\\): Empirical model parameter.</p> </li> <li> <p>Winding constant \\(k_{21}\\): Empirical model parameter.</p> </li> <li> <p>Winding constant \\(k_{22}\\): Empirical model parameter.</p> </li> <li> <p>Oil time constant \\(\u03c4_o\\):  the tau time in minutes for the oil. This number governs the rate at which the oil reaches its final temperature.</p> </li> <li> <p>Winding time constant \\(\u03c4_w\\): the tau time in minutes for the winding. This number governs the rate at with which the windings reach their final temperature.</p> </li> </ul>"},{"location":"theoretical_documentation/ONAN_ONAF_modelling/","title":"ONAN ONAF switch modelling","text":""},{"location":"theoretical_documentation/ONAN_ONAF_modelling/#overview","title":"Overview","text":"<p>Power transformers commonly operate in different cooling configurations depending on their thermal loading. Two widely used modes are:</p> <ul> <li> <p>ONAN (Oil Natural Air Natural): Cooling is provided by natural convection of oil and air</p> </li> <li> <p>ONAF (Oil Natural Air Forced): Cooling fans are activated to increase the heat transfer from the radiator surfaces, allowing higher loading before reaching thermal limits.</p> </li> </ul> <p>Switching between these modes is typically based on temperature thresholds.</p>"},{"location":"theoretical_documentation/ONAN_ONAF_modelling/#cooling-mode-switch-feature","title":"Cooling Mode Switch Feature","text":"<p>Within the transformer model, a switch between ONAN and ONAF situation can be simulated based on either:</p> <ul> <li> <p>deactivation/activation temperature</p> </li> <li> <p>fan-operation schedule, allowing the user to force ONAF operation independently of temperature.</p> </li> </ul> <p>When the switch is triggered, the model updates the cooling parameters to reflect the increased heat-transfer capability in ONAF. This results in a lower thermal resistance and a faster removal of heat compared to the ONAN state.</p>"},{"location":"theoretical_documentation/ONAN_ONAF_modelling/#validation-and-limitations","title":"Validation and limitations","text":"<p>The feature was validated using one measurement dataset of a power transformer, with the fan (de)activation temperatures estimated from the data. From this validation, we concluded that the switch works well on a high level, keeping the top-oil temperature mostly within the (de)activation temperatures. Some modelled temperature peaks still occurred, but the measured temperature never exceeded the modelled temperature. On a timestep level, some \u201cping-pong\u201d behaviour showed up in the modelled temperatures, which does not appear in the measurements. See the plot below.</p> <p></p> <p>So based on our validation, the switch works well to model temperature on a high level, but timestep-level results should be used with some caution. Also, the switch has not been validated with an inputted fan schedule.</p>"},{"location":"theoretical_documentation/hotspot_calibration/","title":"Hot-spot factor calibration","text":""},{"location":"theoretical_documentation/hotspot_calibration/#hot-spot-factor-calibration","title":"Hot-spot factor calibration","text":"<p>When the hot-spot factor is uncertain or unknown, a calibration can be performed to determine it. Note that this method for finding the hot-spot factor is designed for power transformers, and should therefore not be used for distribution transformers. This calibration is based on the static limits that are described in the IEC 60076-1 paragraph 4.2 and IEC 60076-2 Table 1 (see also Thermal limits). For normal paper, it is assumed that the hot-spot temperature reaches 98\u00b0C when the load is 100% and the ambient temperature is 20\u00b0C.</p> <p>During the calibration, a constant load profile of 100% and a constant ambient temperature profile of 20\u00b0C is inserted into the model until a stable end temperature is reached for the transformer hot-spot. Next, the hot-spot factor is adjusted until this end temperature is 98\u00b0C.</p> <p>The resulting hot-spot factor is then clipped between the values 1.1 and 1.3 as these are considered realistic values for the hot-spot factor. Note that it is also possible to choose other values for the end temperature and the hot-spot factor bounds.</p>"},{"location":"theoretical_documentation/model_description/","title":"Model description","text":""},{"location":"theoretical_documentation/model_description/#model-description","title":"Model description","text":""},{"location":"theoretical_documentation/model_description/#relevant-temperatures","title":"Relevant temperatures","text":"<p>Inside a transformer, there are many different components, each with its own thermal behavior. This makes a transformer thermally a very complex system. To say something about the thermal behavior of a transformer, it can be simplified by only looking at the oil temperature and the winding temperature. With this simplifications there are a few specific temperatures and parameters that are important to consider:</p> <ul> <li> <p>Top-oil temperature - temperature of the oil at the very top of the transformer. As this is generally also the highest oil temperature in the transformer, it is one of the two temperatures that is modelled with this package.</p> </li> <li> <p>Oil temperature outflow windings - temperature of the oil at the top of   the windings.</p> </li> <li> <p>Average oil temperature - temperature of the oil in the middle of the   tank. It is assumed that there is a linear relationship between the height in   the tank and the oil temperature. For this reason, the temperature of the oil in the middle of the tank is equated to   the average oil temperature in the tank.</p> </li> <li> <p>Oil temperature inflow windings - temperature of the oil at the bottom   of the windings.</p> </li> <li> <p>Average winding temperature - winding temperature in the middle (in   terms of height) of the transformer. This temperature is often determined by a   resistance measurement.</p> </li> <li> <p>Gradient - temperature difference between the average oil temperature and the average winding temperature.</p> </li> <li> <p>Hot-spot temperature - Temperature of the windings at the hottest point.   This point is usually just below the top of the windings. Together with the top-oil temperature, this is one of the   two temperatures that is modelled with this package.</p> </li> <li> <p>Hot-spot factor - It is assumed that the difference between the top-oil   temperature and the hot-spot temperature is greater than the difference   between the average oil temperature and the average winding temperature   (i.e., the gradient). This is quantified with the Hot-spot factor. This   factor, multiplied by the gradient, indicates the difference between the Hot-spot temperature and   the top-oil temperature.</p> </li> </ul> <p>The thermal model can model the top-oil temperature and the hot-spot temperature based on the thermal properties of the transformer. These are the most indicative temperatures because they indicate the highest temperatures for the oil and the windings. Additionally, the standard (IEC 60076-7) also prescribes temperature limits for these two quantities.</p>"},{"location":"theoretical_documentation/model_description/#model-equations","title":"Model equations","text":"<p>As discussed in the previous section, there are different specific locations in the transformer where the temperature can be determined. This package focuses on modelling the top-oil and hot-spot temperature as these indicate the highest oil and winding temperatures, respectively. The equations below describe how these two temperatures are modelled. In essence, package uses a recursive method where the temperature at the next time step is calculated using the current temperature. This means an initial value has to be set (or the package initializes the transformer at ambient temperatures).</p>"},{"location":"theoretical_documentation/model_description/#top-oil-temperature","title":"Top-oil temperature","text":"<p>The model calculates the top-oil temperature at time \\(t\\) as follows:</p> \\[ \\theta_\\text{o}[t] =     \\theta_\\text{o}[t-1] +     \\left[         \\theta_\\text{a}[t] + \\Delta\\theta_\\text{or} \\cdot         \\left[             \\frac{1+R \\cdot {K[t]}^2}{1 + R}         \\right]^x -         \\theta_\\text{o}[t-1]     \\right] \\cdot     \\left[         1 - \\exp(- \\frac{\\rm d t}{\\tau_\\text{o}k_{11}})     \\right], \\] <p>where:</p> <ul> <li>\\(\\theta_{\\rm o}[t]\\): top-oil temperature at time step t;</li> <li>\\(\\theta_{\\rm o}[t-1]\\): top-oil temperature at the previous timestep;</li> <li>\\(\\theta_{a}[t]\\): ambient temperature at time step t;</li> <li>\\(\u0394\u03b8_{or}\\): top-oil temperature rise (from the temperature-rise-test);</li> <li>\\(R\\): ratio of short-circuit and no-load loss;</li> <li>\\(K[t]\\): load level as a percentage of nominal at time step t;</li> <li>\\(x\\): oil exponent;</li> <li>\\(dt\\): time step size in minutes;</li> <li>\\(\u03c4_{\\rm o}\\): oil time constant;</li> <li>\\(k_{11}\\): oil constant.</li> </ul> <p>The equation for the top-oil temperature consists of several parts. First, the top-oil temperature from the previous time step is taken as the starting point. Then, it is determined what the temperature of the oil would converge to under the current load level and ambient temperature. The difference between this final temperature and the top-oil temperature at the previous time step is calculated in the middle section of the formula (between the large square brackets). Because the transformer does not immediately reach the final temperature but reacts with a certain inertia (according to Newton's heating/cooling law), a delaying part is added to the equation in the rightmost square brackets. This inertia is dependent on the oil time constant.</p>"},{"location":"theoretical_documentation/model_description/#hot-spot-temperature","title":"Hot-spot temperature","text":"<p>Based on formula (12), (15) and  (16) from IEC-60076-7-2018, the hot-spot temperature rise above the top-oil temperature at time t can be calculated as follows:</p> \\[ \\Delta\\theta_{\\text{h}}[t] = \\Delta\\theta_{\\text{h1}}[t] + \\Delta\\theta_{\\text{h2}}[t] \\] <p>where</p> \\[ \\Delta \\theta_{h1}[t] =k_{21}Hg_rK[t]^y + \\{\\Delta \\theta_{h1}[t-1] - k_{21}Hg_rK[t]^y\\}\\times e^{(-\\Delta t)/(k_{22}\\times\\tau_w)} \\] <p>and</p> \\[ \\Delta \\theta_{h2} [t] = (k_{21} -1)Hg_rK[t]^y + \\{\\Delta \\theta_{h2}[t-1] - (k_{21} -1)Hg_rK[t]^y\\}\\times e^ {(-\\Delta t)/(\\tau_0 / k_{22})} \\] <p>where:</p> <ul> <li>\\(\\Delta\\theta_{\\text{h}}[t]\\): hot-spot temperature rise at time step t;</li> <li>\\(\\Delta\\theta_{\\text{h}}[t-1]\\): hot-spot temperature rise at the previous time step;</li> <li>\\(H\\): hot-spot factor;</li> <li>\\(gr\\): winding-oil gradient (from the temperature-rise-test);</li> <li>\\(K[t]\\): load level as a percentage of nominal at time step t;</li> <li>\\(y\\): winding exponent;</li> <li>\\(k_{21}\\): winding constant;</li> <li>\\(k_{22}\\): winding constant;</li> <li>\\(\\Delta t\\): time step size in minutes;</li> <li>\\(\\tau_{\\text{w}}\\): winding time constant;</li> <li>\\(\\tau_{\\text{\\rm o}}\\): oil time constant.</li> </ul> <p>When the hot-spot temperature rise and the top-oil temperature at time t are known, the hot-spot temperature can simply be determined as:</p> \\[ \\theta_{\\text{h}}[t] = \\theta_{\\text{\\rm o}}[t] + \\Delta\\theta_{\\text{h}}[t] \\] <p>The mentioned equations have a memory up to 1 time step back in time. This means that for a given load profile and ambient temperature profile, the temperature profile of the top-oil and hot-spot are calculated sequentially.</p>"},{"location":"theoretical_documentation/model_improvements/","title":"Potential model improvements","text":""},{"location":"theoretical_documentation/model_improvements/#potential-model-improvements","title":"Potential model improvements","text":"<p>Our team is continuously working on improving the model. Below some potential model improvements are described.</p>"},{"location":"theoretical_documentation/model_improvements/#model-accuracy-at-larger-timestep-sizes","title":"Model accuracy at larger timestep sizes","text":"<p>Currently, we trust the accuracy of the model, as long as a time step size of 15 minutes or smaller are used for the input profiles. Larger time step sizes could potentially cause issues with the hotspot temperature modelling. Note that this model is designed to work specifically for a constantly varying load profile, as is expected to appear in real-life situations. When modelling different scenario's, such as step profiles, it is known that this model might not perform accurately. We are currently looking into a solution for these accuracy and stability issues.</p>"},{"location":"theoretical_documentation/model_improvements/#variable-cooling-stage-for-onaf-transformers","title":"Variable cooling stage for ONAF transformers","text":"<p>Currently, our model is only able to model an ONAF transformer as if the fans are always on. In reality the fans can be turned on only at a certain temperature, even in multiple stages. To take this into account, it is proposed to allow parameters that are dependent on ONAN/ONAF cooling dependent on top-oil temperature. When this temperature reaches a certain threshold, the parameters will gradually shift to the ONAF values.</p>"},{"location":"theoretical_documentation/model_improvements/#tap-dependent-load-losses","title":"Tap-dependent load-losses","text":"<p>Only a single value for load losses is used in the thermal model. It is possible, however, to make this dependent on the tap position that the transformer is in at that moment. This will make the loss calculation slightly more accurate, which also means a more accurate thermal model.</p>"},{"location":"theoretical_documentation/model_improvements/#influence-of-the-installation-condition-outdoor-vs-indoor-temperature","title":"Influence of the installation condition; outdoor vs. indoor temperature","text":"<p>The loadability of an asset is largely determined by the environmental condition. Currently there is no accurate method to deal with the influence of the installation condition on the temperature of the transformer. Some research could prove useful for modelling for example indoor transformers more accurately.</p>"},{"location":"theoretical_documentation/overview/","title":"Overview","text":""},{"location":"theoretical_documentation/overview/#overview","title":"Overview","text":"<p>The theoretical documentation provides a slightly more in-depth review of the workings of the thermal transformer model. On the following pages more information can be found:</p> <ul> <li>Transformer definition: General introduction to transformers.</li> <li>Model description: introduction to the thermal modelling of transformers and the equations used in the package.</li> <li>Thermal limits: definitions of thermal limits as prescribed by the loading guide.</li> <li>Model input: Detailed descriptions of all the transformer specifications needed for thermal modelling.</li> <li>Hot-spot factor calibration: method for determining the hot-spot factor when unknown.</li> <li>Potential model improvements: Ideas for increasing model accuracy that have not yet been implemented.</li> </ul> <p>Relevant standards:</p> <ul> <li>IEC 60076-1: Power transformers - General;</li> <li>IEC 60076-2: Power transformers - Temperature rise for liquid-immersed transformers;</li> <li>IEC 60076-7: Power transformers - Loading guide for mineral-oil-immersed power transformers;</li> <li>IEC 60214: On-load tap-changers;</li> <li>IEC 60137: Insulated bushings for alternating voltages above 1000 V.</li> </ul>"},{"location":"theoretical_documentation/temperature_limits/","title":"Thermal limits","text":""},{"location":"theoretical_documentation/temperature_limits/#thermal-limits","title":"Thermal limits","text":"<p>When modelling the hot-spot and top-oil temperature, it is also important to know what temperatures are considered acceptable. Below, a brief description can be found of different temperatures prescribed by the loading guide.</p>"},{"location":"theoretical_documentation/temperature_limits/#static-loadability","title":"Static loadability","text":"<p>In the standards (IEC 60076-1 paragraph 4.2 &amp; IEC 60076-2 Table 1), temperature limits are described for the environment, oil, and windings that must not be exceeded under continuous load with the assigned power.</p> <ul> <li>Ambient temperature:</li> <li>Always between -25\u00b0C and +40\u00b0C;</li> <li>The average temperature in the hottest month is less than +30\u00b0C;</li> <li>The annual average does not exceed +20\u00b0C.</li> <li>Transformer temperature:</li> <li>The top-oil temperature rise is less than 60 Kelvin;</li> <li>The average winding temperature rise is less than 65 Kelvin;</li> <li>The hot-spot temperature is less than:<ul> <li>Normal paper: 98\u00b0C (78 Kelvin temperature rise);</li> <li>Thermally Upgraded Paper (TUP): 110\u00b0C (90 Kelvin temperature rise).</li> </ul> </li> </ul>"},{"location":"theoretical_documentation/temperature_limits/#cyclic-loadability","title":"Cyclic loadability","text":"<p>In the loading guide, guidelines are given regarding cyclic loadability (IEC 60076-7, chapter 7, table 2). A distinction is made between:</p> <ul> <li> <p>Normal cyclic loadability: a loadability that can always be maintained   with a cyclic profile.</p> </li> <li> <p>Limit top-oil temperature: 105 \u00b0C</p> </li> <li>Limit hot-spot temperature: 120 \u00b0C</li> <li> <p>Limit current load: 150% (&lt; 100MVA), 130% (&gt; 100 MVA)</p> </li> <li> <p>Long-term emergency load: a loadability that can be maintained for   several days with a cyclic profile.</p> </li> <li>Limit top-oil temperature: 115 \u00b0C</li> <li>Limit hot-spot temperature: 140 \u00b0C</li> <li> <p>Limit current load: 180% (&lt; 10MVA), 150% (10 - 100 MVA) and 130% (&gt; 100 MVA)</p> </li> <li> <p>Short-term emergency load: a loadability that can be maintained for   several hours with a cyclic profile.</p> </li> <li>Limit top-oil temperature: 115 \u00b0C</li> <li>Limit hot-spot temperature: 160 \u00b0C</li> <li>Limit current load: 200% (&lt; 10MVA), 180% (10 - 100 MVA) and 150% (&gt; 100 MVA)</li> </ul>"},{"location":"theoretical_documentation/transformer_definition/","title":"Transformer definition","text":""},{"location":"theoretical_documentation/transformer_definition/#transformer-definition","title":"Transformer definition","text":"<p>Transformers connect the grids of different voltage levels and vector groups with each other. This is achieved by magnetically coupling the windings of different voltage levels. These windings are housed within the transformer casing, along with a magnetic core, and are shielded with oil and paper mass. This provides both electrical insulation and thermal conduction for the windings.</p> <p></p> <p>A power transformer surrounded by a concrete blasting wall.</p> <p>Within the term \"Transformer,\" a distinction can be made between power transformers and distribution transformers. Power transformers form the link between high voltage networks (typically 50 kV and higher) and medium voltage networks (typically around 10 to 20 kV). The Loading Guide distinguishes between small, medium, and large transformers (IEC 60076-7, chapter 3). Small (distribution) transformers have a nominal power up to 10 MVA, medium (power) transformers up to 100 MVA, and large (power) transformers of more than 100 MVA.</p> <p>Distribution transformers form the link between medium voltage networks and low voltage networks. This type of transformer is much smaller than power transformers.</p> <p>Power transformers can be found at substations, where the conversion from high to medium voltage takes place. Typically, there are around three power transformers per substation that collectively form the link between high voltage and medium voltage.</p>"}]}